"use strict";(self.webpackChunkcheapflightclient=self.webpackChunkcheapflightclient||[]).push([[9285],{89285:(Y,v,n)=>{n.r(v),n.d(v,{TicketNumberDetailPageComponent:()=>O});var p=n(36895),r=n(24006),x=n(10908),C=n(83700),_=n(72506),m=n(44143),E=n(74713),T=n(76978),d=n(88001),b=n(28746),e=n(94650),D=n(344),w=n(82761),F=n(40899);function N(i,c){if(1&i){const t=e.EpF();e.TgZ(0,"cf-select",21),e.NdJ("selectedChange",function(o){e.CHM(t);const s=e.oxw();return e.KtG(s.onProviderChange(o))}),e.qZA()}if(2&i){const t=e.oxw();e.Q6J("formControl",t.searchForm.controls.provider)("data",t.providerSelectOption)("allowSearch",!1)}}const k=function(i){return{"opacity-50 pointer-events-none cursor-default":i}};function A(i,c){if(1&i&&e._UZ(0,"cf-select",22),2&i){const t=e.oxw();e.Q6J("formControl",t.searchForm.controls.supplier)("data",t.supplierSelectOption)("allowSearch",!1)("ngClass",e.VKq(4,k,t.isDisableSupplier))}}function Z(i,c){if(1&i&&e._UZ(0,"cf-select",23),2&i){const t=e.oxw();e.Q6J("formControl",t.searchForm.controls.ticketType)("data",t.ticketTypeSelectOption)("allowSearch",!1)}}function S(i,c){if(1&i){const t=e.EpF();e.TgZ(0,"div",24)(1,"button",25),e.NdJ("click",function(){e.CHM(t);const o=e.oxw();return e.KtG(o.onMobileOpenBookingCode())}),e._UZ(2,"cf-icon",26),e._uU(3," M\u1edf booking "),e.qZA()()}}function I(i,c){if(1&i){const t=e.EpF();e.TgZ(0,"cf-select",34),e.NdJ("selectedChange",function(o){e.CHM(t);const s=e.oxw(2);return e.KtG(s.onProviderChange(o))}),e.qZA()}if(2&i){const t=e.oxw(2);e.Q6J("formControl",t.searchForm.controls.provider)("data",t.providerSelectOption)("allowSearch",!1)}}function y(i,c){if(1&i&&e._UZ(0,"cf-select",35),2&i){const t=e.oxw(2);e.Q6J("formControl",t.searchForm.controls.supplier)("data",t.supplierSelectOption)("allowSearch",!1)("ngClass",e.VKq(4,k,t.isDisableSupplier))}}function P(i,c){if(1&i&&e._UZ(0,"cf-select",36),2&i){const t=e.oxw(2);e.Q6J("formControl",t.searchForm.controls.ticketType)("data",t.ticketTypeSelectOption)("allowSearch",!1)}}function U(i,c){if(1&i){const t=e.EpF();e.TgZ(0,"div",27)(1,"div",28),e.YNc(2,I,1,3,"cf-select",29),e.YNc(3,y,1,6,"cf-select",30),e.YNc(4,P,1,3,"cf-select",31),e.TgZ(5,"cf-input-group",7),e._UZ(6,"cf-icon",8)(7,"input",9),e.qZA()(),e.TgZ(8,"div")(9,"button",32),e.NdJ("click",function(){e.CHM(t);const o=e.oxw();return e.KtG(o.onMobileSearch())}),e._UZ(10,"cf-icon",33),e.TgZ(11,"div"),e._uU(12,"T\xecm ki\u1ebfm"),e.qZA()()()()}if(2&i){const t=e.oxw();e.xp6(2),e.Q6J("ngIf",t.isShowProvider),e.xp6(1),e.Q6J("ngIf",t.isShowProvider),e.xp6(1),e.Q6J("ngIf",t.isShowProvider),e.xp6(1),e.Q6J("status","default"),e.xp6(2),e.Q6J("formControl",t.searchForm.controls.ticketNumber)}}function J(i,c){1&i&&(e.TgZ(0,"div",37)(1,"div",38)(2,"div",39)(3,"div",40)(4,"div",41),e._UZ(5,"img",42),e.qZA(),e.TgZ(6,"div",43),e._uU(7," Nh\u1eadp s\u1ed1 v\xe9 "),e.qZA(),e.TgZ(8,"div",44),e._uU(9," Vui l\xf2ng nh\u1eadp s\u1ed1 v\xe9 c\u1ee7a b\u1ea1n v\xe0o \xf4 b\xean tr\xean v\xe0 ch\u1ecdn n\xfat "),e.TgZ(10,"span",45),e._uU(11,"T\xecm ki\u1ebfm"),e.qZA(),e._uU(12," \u0111\u1ec3 b\u1eaft \u0111\u1ea7u "),e.qZA()()()()())}function B(i,c){1&i&&(e.TgZ(0,"div",37)(1,"div",38)(2,"div",39)(3,"div",40)(4,"div",41),e._UZ(5,"img",46),e.qZA(),e.TgZ(6,"div",43),e._uU(7," Kh\xf4ng c\xf3 k\u1ebft qu\u1ea3 "),e.qZA(),e.TgZ(8,"div",47)(9,"div"),e._uU(10,"Kh\xf4ng c\xf3 k\u1ebft qu\u1ea3 \u0111\u1ec3 hi\u1ec3n th\u1ecb"),e.qZA(),e.TgZ(11,"div"),e._uU(12,"Vui l\xf2ng th\u1eed l\u1ea1i sau ho\u1eb7c ki\u1ec3m tra l\u1ea1i th\xf4ng tin s\u1ed1 v\xe9"),e.qZA()()()()()())}function Q(i,c){1&i&&(e.TgZ(0,"div",48),e._UZ(1,"ticket-item-skeleton")(2,"ticket-item-skeleton")(3,"ticket-item-skeleton")(4,"ticket-item-skeleton"),e.qZA())}function z(i,c){if(1&i&&(e.TgZ(0,"div",49),e._UZ(1,"div",50),e.qZA()),2&i){const t=e.oxw();e.xp6(1),e.Q6J("innerHTML",t.ticketDetail.ticketImage,e.oJD)}}let O=(()=>{class i{constructor(t,l,o,s,u){this._fb=t,this._manageBookingService=l,this._bottomSheetService=o,this._router=s,this._permissionService=u,this.airline="VN",this.isLoading=!1,this.state="SEARCH",this.isShowProvider=this._permissionService.isAgent1()||this._permissionService.isBooker(),this.isDisableSupplier=!1,this.providerSelectOption=[],this.supplierSelectOption=[],this.ticketTypeSelectOption=[]}ngOnInit(){this.searchForm=this._fb.group({provider:["",this.isShowProvider?r.kI.required:null],supplier:[""],ticketNumber:["",this.isShowProvider?r.kI.required:null],ticketType:["",this.isShowProvider?r.kI.required:null]}),this.providerSelectOption=[{text:"Vietnam Airlines",value:d.QK.VN},{text:"Bamboo Airways",value:d.QK.QH}],this.supplierSelectOption=[...Object.entries(d.f$).map(([t,l])=>({text:t,value:l}))],this.ticketTypeSelectOption=[{text:"V\xe9",value:"FARE"},{text:"H\xe0nh l\xfd",value:"BAG"},{text:"Ch\u1ed7 ng\u1ed3i",value:"SEAT"}]}getTicketDetail(){if(this.searchForm.invalid)return;const t=this.searchForm.value,l={provider:t.provider||"",supplier:t.supplier?t.supplier:null,ticketNumber:t.ticketNumber,ticketType:t.ticketType};this.state="LOADING",this._manageBookingService.getTicketDetail(l).pipe((0,b.x)(()=>this.isLoading=!1)).subscribe({next:o=>{o.success?(this.state="SUCCESS",this.ticketDetail=this.proccessTicketDetail(o.data)):this.state="EMPTY"},error:()=>{this.state="EMPTY"}})}proccessTicketDetail(t){var l,o,s,u,f,h,g;return{ticketNumber:"",ticketImage:t.ticketImage,passengerName:t.ticketInfo.passengerName,ticketInfo:{numCoupons:t.ticketInfo.numCoupons,issueDate:t.ticketInfo.issueDate,createDate:t.ticketInfo.createDate,bookingCode:t.ticketInfo.prn},segments:t.segment.map(a=>({number:a.number,airline:a.marketingAirline,flightNumber:a.flightNumber,classCode:a.bookingClassCode,date:a.departureDate,brdoff:a.originLocation+a.destinationLocation,time:a.departureTime,status:a.segmentStatus,fareBasis:a.fareBasis,statusCode:a.ticketStatus,baggageAllowance:a.baggageAllowance})),pricingInfo:{baseFare:t.pricingInfo.baseFare.currencyCode.concat(" ",t.pricingInfo.baseFare.amount),taxes:t.pricingInfo.taxes.map(a=>a.amount.concat(a.taxCode)).join(" "),totalFare:t.pricingInfo.totalFare.currencyCode.concat(" ",t.pricingInfo.totalFare.amount)},fareCalc:t.pricingInfo.fareCalculation,paymentInfo:{paymentCardNumber:null===(l=t.paymentInfo)||void 0===l?void 0:l.paymentCardNumber,authorizationCode:null===(o=t.paymentInfo)||void 0===o?void 0:o.authorizationCode},ticketData:{issueDate:(null===(s=t.ticketData)||void 0===s?void 0:s.issueDate)||"",printStation:(null===(u=t.ticketData)||void 0===u?void 0:u.printStation)||"",issuingAgent:(null===(f=t.ticketData)||void 0===f?void 0:f.issuingAgent)||"",remarks:(null===(h=t.ticketData)||void 0===h?void 0:h.remarks)||"",endorsements:(null===(g=t.ticketData)||void 0===g?void 0:g.endorsements.join(""))||""}}}_getCurrentUrl(){return`${window.location.origin}/admin/booking-detail/${this.airline}/${this.ticketDetail.ticketInfo.bookingCode}`}onOpenBookingCode(){console.log(this.ticketDetail),window.open(this._getCurrentUrl())}onMobileOpenBookingCode(){this._router.navigate([`/admin/booking-detail/${this.airline}/${this.ticketDetail.ticketInfo.bookingCode}`])}onMobileSearch(){this._bottomSheetService.dismiss(),this.getTicketDetail()}openSearchBts(t){const l=this._bottomSheetService.open(t,{headerTitle:"T\xecm ki\u1ebfm",rightButtonIcon:"",leftButtonIcon:"close",containerFullHeigh:!0,leftButtonIconClass:"text-neutral-gray-4",restoreFocus:!1});l.containerInstance._leftButtonClick.subscribe(()=>l.dismiss())}onProviderChange(t){this.isDisableSupplier="VN"!==t.value}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(r.qu),e.Y36(D.fB),e.Y36(x.a2),e.Y36(w.F0),e.Y36(F.$A))},i.\u0275cmp=e.Xpm({type:i,selectors:[["ticket-number-detail-page"]],standalone:!0,features:[e.jDz],decls:28,vars:11,consts:[[1,"flex-auto","flex","flex-col","w-full"],[1,"bg-white","p-[30px]","w-full","shadow-sm","flex","flex-col","gap-y-[30px]","md:hidden"],[1,"text-heading-lg"],[1,"flex","items-stretch","gap-x-4"],["class","w-[260px]","textField","text","valueField","value","size","medium","placeholder","Ch\u1ecdn provider",3,"formControl","data","allowSearch","selectedChange",4,"ngIf"],["class","w-[260px]","textField","text","valueField","value","size","medium","placeholder","Ch\u1ecdn nh\xe0 cung c\u1ea5p",3,"formControl","data","allowSearch","ngClass",4,"ngIf"],["class","w-[260px]","placeholder","Ch\u1ecdn lo\u1ea1i s\u1ed1 v\xe9","textField","text","valueField","value","size","medium",3,"formControl","data","allowSearch",4,"ngIf"],[1,"!w-full",3,"status"],["cfHeadIcon","","icon","search","size","small"],["size","medium","cf-input","","placeholder","T\xecm ki\u1ebfm t\xecm ki\u1ebfm theo s\u1ed1 v\xe9",3,"formControl"],["cf-button","","size","medium","type","secondary",1,"w-[260px]","justify-center",3,"disabled","click"],["icon","search","size","small",1,"pr-3"],[1,"hidden","md:flex","flex-col","py-3","px-4","gap-y-3","pr-0","bg-neutral-white"],[1,"text-heading-sm","text-neutral-gray-6"],[1,"hidden","!w-full","md:pr-4","md:block"],["size","medium","cf-input","","placeholder","T\xecm ki\u1ebfm",3,"focus"],["class","md:block hidden fixed bottom-0 w-screen p-4 bg-neutral-white shadow-lg",4,"ngIf"],["searchBts",""],["class","flex-auto w-full max-h-[calc(100vh-152px)] py-4 px-[30px]",4,"ngIf"],["class","p-6",4,"ngIf"],["class","px-6 py-4 md:p-4 md:pb-[90px]",4,"ngIf"],["textField","text","valueField","value","size","medium","placeholder","Ch\u1ecdn provider",1,"w-[260px]",3,"formControl","data","allowSearch","selectedChange"],["textField","text","valueField","value","size","medium","placeholder","Ch\u1ecdn nh\xe0 cung c\u1ea5p",1,"w-[260px]",3,"formControl","data","allowSearch","ngClass"],["placeholder","Ch\u1ecdn lo\u1ea1i s\u1ed1 v\xe9","textField","text","valueField","value","size","medium",1,"w-[260px]",3,"formControl","data","allowSearch"],[1,"md:block","hidden","fixed","bottom-0","w-screen","p-4","bg-neutral-white","shadow-lg"],["cf-button","",1,"w-full","justify-center",3,"click"],["icon","external_link","size","small"],[1,"p-4","w-full","flex","flex-col","justify-between"],[1,"flex","flex-col","gap-y-4"],["class","w-full max-w-full","textField","text","valueField","value","size","medium","placeholder","Ch\u1ecdn provider",3,"formControl","data","allowSearch","selectedChange",4,"ngIf"],["class","w-full max-w-full","textField","text","valueField","value","size","medium","placeholder","Ch\u1ecdn nh\xe0 cung c\u1ea5p",3,"formControl","data","allowSearch","ngClass",4,"ngIf"],["class","w-full max-w-full","placeholder","Ch\u1ecdn lo\u1ea1i s\u1ed1 v\xe9","textField","text","valueField","value","size","medium",3,"formControl","data","allowSearch",4,"ngIf"],["cf-button","",1,"w-full","justify-center","gap-x-2",3,"click"],["icon","search","size","small"],["textField","text","valueField","value","size","medium","placeholder","Ch\u1ecdn provider",1,"w-full","max-w-full",3,"formControl","data","allowSearch","selectedChange"],["textField","text","valueField","value","size","medium","placeholder","Ch\u1ecdn nh\xe0 cung c\u1ea5p",1,"w-full","max-w-full",3,"formControl","data","allowSearch","ngClass"],["placeholder","Ch\u1ecdn lo\u1ea1i s\u1ed1 v\xe9","textField","text","valueField","value","size","medium",1,"w-full","max-w-full",3,"formControl","data","allowSearch"],[1,"flex-auto","w-full","max-h-[calc(100vh-152px)]","py-4","px-[30px]"],[1,"bg-white","w-full","h-full","rounded-lg","md:bg-transparent"],[1,"h-[500px]","flex","flex-col","justify-center","items-center"],[1,"flex","flex-col","justify-center","items-center"],[1,"mb-8"],["src","assets/images/web-page.svg","alt",""],[1,"text-heading-md","text-neutral-black","mb-2"],[1,"text-espressive-md","text-neutral-gray-5","md:text-center"],[1,"text-espressive-md"],["src","assets/images/empty-result.svg","alt",""],[1,"text-body-md-short","text-neutral-gray-5","text-center"],[1,"p-6"],[1,"px-6","py-4","md:p-4","md:pb-[90px]"],[1,"p-6","bg-neutral-white","rounded-lg","text-body-md","whitespace-pre-wrap",3,"innerHTML"]],template:function(t,l){if(1&t){const o=e.EpF();e.TgZ(0,"div",0)(1,"div",1)(2,"div",2),e._uU(3,"M\u1edf s\u1ed1 v\xe9"),e.qZA(),e.TgZ(4,"div",3),e.YNc(5,N,1,3,"cf-select",4),e.YNc(6,A,1,6,"cf-select",5),e.YNc(7,Z,1,3,"cf-select",6),e.TgZ(8,"cf-input-group",7),e._UZ(9,"cf-icon",8)(10,"input",9),e.qZA(),e.TgZ(11,"button",10),e.NdJ("click",function(){return l.getTicketDetail()}),e._UZ(12,"cf-icon",11),e._uU(13," T\xecm ki\u1ebfm "),e.qZA()()(),e.TgZ(14,"div",12)(15,"div",13),e._uU(16,"M\u1edf s\u1ed1 v\xe9"),e.qZA(),e.TgZ(17,"cf-input-group",14),e._UZ(18,"cf-icon",8),e.TgZ(19,"input",15),e.NdJ("focus",function(){e.CHM(o);const u=e.MAs(22);return e.KtG(l.openSearchBts(u))}),e.qZA()()(),e.YNc(20,S,4,0,"div",16),e.YNc(21,U,13,5,"ng-template",null,17,e.W1O),e.TgZ(23,"div"),e.YNc(24,J,13,0,"div",18),e.YNc(25,B,13,0,"div",18),e.YNc(26,Q,5,0,"div",19),e.YNc(27,z,2,1,"div",20),e.qZA()()}2&t&&(e.xp6(5),e.Q6J("ngIf",l.isShowProvider),e.xp6(1),e.Q6J("ngIf",l.isShowProvider),e.xp6(1),e.Q6J("ngIf",l.isShowProvider),e.xp6(1),e.Q6J("status","default"),e.xp6(2),e.Q6J("formControl",l.searchForm.controls.ticketNumber),e.xp6(1),e.Q6J("disabled",l.searchForm.invalid||"LOADING"===l.state),e.xp6(9),e.Q6J("ngIf","SUCCESS"===l.state),e.xp6(4),e.Q6J("ngIf","SEARCH"===l.state),e.xp6(1),e.Q6J("ngIf","EMPTY"===l.state),e.xp6(1),e.Q6J("ngIf","LOADING"===l.state),e.xp6(1),e.Q6J("ngIf","SUCCESS"===l.state))},dependencies:[p.ez,p.mk,p.O5,r.u5,r.Fj,r.JJ,m.j$,m.ND,m.BN,_.AxE,_.Sm8,C.N8,C.Xq,T.IA,r.UX,r.oH,x.DW,E.q],encapsulation:2}),i})()}}]);