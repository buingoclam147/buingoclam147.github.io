"use strict";(self.webpackChunkcheapflightclient=self.webpackChunkcheapflightclient||[]).push([[7598],{57598:($e,H,g)=>{g.r(H),g.d(H,{QuotationModalComponent:()=>me,SearchFlightResultPageComponent:()=>Wa});var v=g(36895),y=g(24006),E=g(83700),m=g(72506),w=g(19010),L=g(39840),_e=g(56322),b=g(48042),Ke=g(65441),S=g(34120),k=g(40899),Q=g(77296),Te=g(61135),Ve=g(77579),ve=g(82722),U=g(28746),D=g(15861),Z=g(37094),be=g(27898),e=g(94650);let ze=(()=>{class r{constructor(){this.percent=0,this.text="",this.circumference=60*Math.PI}ngOnInit(){}}return r.\u0275fac=function(t){return new(t||r)},r.\u0275cmp=e.Xpm({type:r,selectors:[["cf-progress"]],inputs:{percent:"percent",text:"text"},standalone:!0,features:[e.jDz],decls:15,vars:4,consts:[[1,"flex","justify-center","flex-col","items-center"],[1,"flex","items-center","justify-center","overflow-hidden","rounded-full"],[1,"w-20","h-20"],["stroke-width","5","stroke","currentColor","fill","transparent","r","30","cx","40","cy","40",1,"text-neutral-gray-1"],["stroke-width","5","stroke-linecap","round","stroke","currentColor","fill","transparent","r","30","cx","40","cy","40",1,"text-secondary-5-4"],[1,"absolute","text-body-md","text-secondary-5-4"],[1,"text-body-md","text-secondary-5-4"],[1,"dot-one"],[1,"dot-two"],[1,"dot-three"]],template:function(t,a){1&t&&(e.TgZ(0,"div",0)(1,"div",1),e.O4$(),e.TgZ(2,"svg",2),e._UZ(3,"circle",3)(4,"circle",4),e.qZA(),e.kcU(),e.TgZ(5,"span",5),e._uU(6),e.qZA()(),e.TgZ(7,"div",6),e._uU(8),e.TgZ(9,"span",7),e._uU(10," ."),e.qZA(),e.TgZ(11,"span",8),e._uU(12," ."),e.qZA(),e.TgZ(13,"span",9),e._uU(14," ."),e.qZA()()()),2&t&&(e.xp6(4),e.uIk("stroke-dasharray",a.circumference)("stroke-dashoffset",a.circumference-a.percent/100*a.circumference),e.xp6(2),e.hij("",a.percent,"%"),e.xp6(2),e.hij("",a.text," "))},styles:["span[class^=dot-][_ngcontent-%COMP%]{opacity:0}.dot-one[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_dot-one 2s infinite linear}.dot-two[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_dot-two 2s infinite linear}.dot-three[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_dot-three 2s infinite linear}@keyframes _ngcontent-%COMP%_dot-one{0%{opacity:0}15%{opacity:0}25%{opacity:1}to{opacity:1}}@keyframes _ngcontent-%COMP%_dot-two{0%{opacity:0}25%{opacity:0}50%{opacity:1}to{opacity:1}}@keyframes _ngcontent-%COMP%_dot-three{0%{opacity:0}50%{opacity:0}75%{opacity:1}to{opacity:1}}"]}),r})();var Y,Ce=g(19123),q=g(48373),G=g(62331);const R=typeof window<"u"?null===(Y=window.navigator)||void 0===Y?void 0:Y.userAgent:void 0,We=(null==R?void 0:R.includes("AppleWebKit"))&&!(null!=R&&R.includes("Chrome"));function j(r){const o=[];for(let t=0,a=r.length;t<a;t++)o.push(r[t]);return o}function xe(r,o){return`data:${o};base64,${r}`}function ye(r,o,t){return V.apply(this,arguments)}function V(){return(V=(0,D.Z)(function*(r,o,t){const a=yield fetch(r,o);if(404===a.status)throw new Error(`Resource "${a.url}" not found`);const i=yield a.blob();return new Promise((n,s)=>{const c=new FileReader;c.onerror=s,c.onloadend=()=>{try{n(t({res:a,result:c.result}))}catch(l){s(l)}},c.readAsDataURL(i)})})).apply(this,arguments)}const z={};function Se(r,o,t){return W.apply(this,arguments)}function W(){return(W=(0,D.Z)(function*(r,o,t){const a=function ot(r,o,t){let a=r.replace(/\?.*/,"");return t&&(a=r),/ttf|otf|eot|woff2?/i.test(a)&&(a=a.replace(/.*\//,"")),o?`[${o}]${a}`:a}(r,o,t.includeQueryParams);if(null!=z[a])return z[a];let i;t.cacheBust&&(r+=(/\?/.test(r)?"&":"?")+(new Date).getTime());try{const n=yield ye(r,t.fetchRequestInit,({res:s,result:c})=>(o||(o=s.headers.get("Content-Type")||""),function rt(r){return r.split(/,/)[1]}(c)));i=xe(n,o)}catch(n){i=t.imagePlaceholder||"";let s=`Failed to fetch resource: ${r}`;n&&(s="string"==typeof n?n:n.message),s&&console.warn(s)}return z[a]=i,i})).apply(this,arguments)}const ke="application/font-woff",De="image/jpeg",st={woff:ke,woff2:ke,ttf:"application/font-truetype",eot:"application/vnd.ms-fontobject",png:"image/png",jpg:De,jpeg:De,gif:"image/gif",tiff:"image/tiff",svg:"image/svg+xml",webp:"image/webp"};function Fe(r){const o=function lt(r){const o=/\.([^./]*?)$/g.exec(r);return o?o[1]:""}(r).toLowerCase();return st[o]||""}const Ee=/url\((['"]?)([^'"]+?)\1\)/g,ct=/url\([^)]+\)\s*format\((["']?)([^"']+)\1\)/g,ut=/src:\s*(?:url\([^)]+\)\s*format\([^)]+\)[,;]\s*)+/g;function X(){return(X=(0,D.Z)(function*(r,o,t,a,i){try{const n=t?function Xe(r,o){if(r.match(/^[a-z]+:\/\//i))return r;if(r.match(/^\/\//))return window.location.protocol+r;if(r.match(/^[a-z]+:/i))return r;const t=document.implementation.createHTMLDocument(),a=t.createElement("base"),i=t.createElement("a");return t.head.appendChild(a),t.body.appendChild(i),o&&(a.href=o),i.href=r,i.href}(o,t):o,s=Fe(o);let c;return c=i?xe(yield i(n),s):yield Se(n,s,a),r.replace(function dt(r){const o=r.replace(/([.*+?^${}()|\[\]\/\\])/g,"\\$1");return new RegExp(`(url\\(['"]?)(${o})(['"]?\\))`,"g")}(o),`$1${c}$3`)}catch{}return r})).apply(this,arguments)}function Pe(r){return-1!==r.search(Ee)}function ee(){return ee=(0,D.Z)(function*(r,o,t){if(!Pe(r))return r;const a=function pt(r,{preferredFontFormat:o}){return o?r.replace(ut,t=>{for(;;){const[a,,i]=ct.exec(t)||[];if(!i)return"";if(i===o)return`src: ${a};`}}):r}(r,t);return function ht(r){const o=[];return r.replace(Ee,(t,a,i)=>(o.push(i),t)),o.filter(t=>!function nt(r){return-1!==r.search(/^(data:)/)}(t))}(a).reduce((n,s)=>n.then(c=>function gt(r,o,t,a,i){return X.apply(this,arguments)}(c,s,o,t)),Promise.resolve(a))}),ee.apply(this,arguments)}const Ne={};function Ae(r){return te.apply(this,arguments)}function te(){return(te=(0,D.Z)(function*(r){let o=Ne[r];return null!=o||(o={url:r,cssText:yield(yield fetch(r)).text()},Ne[r]=o),o})).apply(this,arguments)}function Ie(r,o){return ie.apply(this,arguments)}function ie(){return ie=(0,D.Z)(function*(r,o){let t=r.cssText;const a=/url\(["']?([^"')]+)["']?\)/g,n=(t.match(/url\([^)]+\)/g)||[]).map(function(){var s=(0,D.Z)(function*(c){let l=c.replace(a,"$1");return l.startsWith("https://")||(l=new URL(l,r.url).href),ye(l,o.fetchRequestInit,({result:d})=>(t=t.replace(c,`url(${d})`),[c,d]))});return function(c){return s.apply(this,arguments)}}());return Promise.all(n).then(()=>t)}),ie.apply(this,arguments)}function we(r){if(null==r)return[];const o=[];let a=r.replace(/(\/\*[\s\S]*?\*\/)/gi,"");const i=new RegExp("((@.*?keyframes [\\s\\S]*?){([\\s\\S]*?}\\s*?)})","gi");for(;;){const l=i.exec(a);if(null===l)break;o.push(l[0])}a=a.replace(i,"");const n=/@import[\s\S]*?url\([^)]*\)[\s\S]*?;/gi,c=new RegExp("((\\s*?(?:\\/\\*[\\s\\S]*?\\*\\/)?\\s*?@media[\\s\\S]*?){([\\s\\S]*?)}\\s*?})|(([\\s\\S]*?){([\\s\\S]*?)})","gi");for(;;){let l=n.exec(a);if(null===l){if(l=c.exec(a),null===l)break;n.lastIndex=c.lastIndex}else c.lastIndex=n.lastIndex;o.push(l[0])}return o}function ae(){return(ae=(0,D.Z)(function*(r,o){const t=[],a=[];return r.forEach(i=>{if("cssRules"in i)try{j(i.cssRules||[]).forEach((n,s)=>{if(n.type===CSSRule.IMPORT_RULE){let c=s+1;const d=Ae(n.href).then(u=>Ie(u,o)).then(u=>we(u).forEach(h=>{try{i.insertRule(h,h.startsWith("@import")?c+=1:i.cssRules.length)}catch(f){console.error("Error inserting rule from remote css",{rule:h,error:f})}})).catch(u=>{console.error("Error loading remote css",u.toString())});a.push(d)}})}catch(n){const s=r.find(c=>null==c.href)||document.styleSheets[0];null!=i.href&&a.push(Ae(i.href).then(c=>Ie(c,o)).then(c=>we(c).forEach(l=>{s.insertRule(l,i.cssRules.length)})).catch(c=>{console.error("Error loading remote stylesheet",c)})),console.error("Error inlining remote css file",n)}}),Promise.all(a).then(()=>(r.forEach(i=>{if("cssRules"in i)try{j(i.cssRules||[]).forEach(n=>{t.push(n)})}catch(n){console.error(`Error while reading CSS rules from ${i.href}`,n)}}),t))})).apply(this,arguments)}function re(){return re=(0,D.Z)(function*(r,o){if(null==r.ownerDocument)throw new Error("Provided element is not within a Document");const t=j(r.ownerDocument.styleSheets),a=yield function ft(r,o){return ae.apply(this,arguments)}(t,o);return function _t(r){return r.filter(o=>o.type===CSSRule.FONT_FACE_RULE).filter(o=>Pe(o.style.getPropertyValue("src")))}(a)}),re.apply(this,arguments)}function ne(){return ne=(0,D.Z)(function*(r,o){let t=yield function Tt(r,o){return re.apply(this,arguments)}(r,o);return o.includeFontSrc&&(t=t.filter(i=>{var n;return null===(n=o.includeFontSrc)||void 0===n?void 0:n.some(s=>i.cssText.includes(s))})),(yield Promise.all(t.map(i=>function mt(r,o,t){return ee.apply(this,arguments)}(i.cssText,i.parentStyleSheet?i.parentStyleSheet.href:null,o)))).join("\n")}),ne.apply(this,arguments)}function Re(r){return ge.apply(this,arguments)}function ge(){return(ge=(0,D.Z)(function*(r,o={}){return function Ze(r,o){return ne.apply(this,arguments)}(r,o)})).apply(this,arguments)}var Me=g(51948),He=g(94327),bt=g(96166),Ct=g(25650),Le=g(74710),pe=g(4128),O=g(88996),Qe=g(49770),Be=g(44143),M=g(97579),Je=g(82761),Oe=g(61027);function xt(r,o){if(1&r&&(e.ynx(0),e.TgZ(1,"div",16)(2,"div",17),e._UZ(3,"img",18),e.TgZ(4,"span",19),e._uU(5),e.qZA()(),e._UZ(6,"cf-input-number",20),e.TgZ(7,"span",21),e._uU(8,"\u0111"),e.qZA()(),e.BQk()),2&r){const t=o.$implicit,a=e.oxw();let i,n;e.xp6(3),e.Q6J("src",null==(i=a.getSurchargeItem(t))?null:i.logo,e.LSH),e.xp6(2),e.Oqu(null==(n=a.getSurchargeItem(t))?null:n.airline),e.xp6(1),e.Q6J("placeholder","0")("negative",!1)("formControl",a.getFormControlInSurcharges(t))}}function yt(r,o){if(1&r){const t=e.EpF();e.TgZ(0,"div")(1,"cf-checkbox",22),e.NdJ("checkChange",function(i){e.CHM(t);const n=e.oxw();return e.KtG(n.checkChange(i))}),e._uU(2," \u0110\u1eb7t l\xe0m m\u1ee9c ph\xed ph\u1ee5 thu m\u1eb7c \u0111\u1ecbnh "),e.qZA()()}if(2&r){const t=e.oxw();e.xp6(1),e.Q6J("checked",t.hasDefaultConfig)}}function St(r,o){if(1&r){const t=e.EpF();e.TgZ(0,"button",10),e.NdJ("click",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.gotoSettings())}),e._UZ(1,"cf-icon",11),e.qZA()}}function kt(r,o){1&r&&e._UZ(0,"cf-spinner")}let Ue=(()=>{class r{constructor(t,a,i,n,s,c,l,d,u,h,f){this.ref=a,this.fb=i,this.bottomSheetRefDialog=n,this.bottomSheetData=s,this.bottomSheetRef=c,this._modal=l,this._route=d,this._generalService=u,this._toastService=h,this._permissionService=f,this.hasDefaultConfig=!1,this.isUpdateSurchargeFee=this._permissionService.hasPermission(k.or.CreateOrUpdateSurchargeFeeConfig)&&this._permissionService.hasPermission(k.or.ViewSurchargeFeeConfig),this.surchargeConfigs=[],this.isLoading=!1,this.isChangeConfig=!1,t.registerIcons([m.UNF,m.Xzk]),this.surcharges=a?a.data.surcharges:s.surcharges,this.surchargeConfigs=a?a.data.surchargeConfigs:s.surchargeConfigs}ngOnInit(){this.initFormGroup(),this.formGroup.valueChanges.subscribe(()=>{this.isChangeConfig=!0})}initFormGroup(){this.formGroup=this.fb.group({surcharges:this.fb.array(this.surcharges.map(t=>this.fb.group({airline:[t.airline],surchargePrice:[t.surchargePrice]})))})}onSubmit(){let a={};this.formGroup.value.surcharges.forEach(i=>{a[i.airline]=i.surchargePrice}),this.surcharges=this.surcharges.map(i=>(i.surchargePrice=a[i.airline],i)),this.saveConfig(()=>this.ref.close(this.surcharges))}onMobileSubmit(){let a={};this.formGroup.value.surcharges.forEach(i=>{a[i.airline]=i.surchargePrice}),this.surcharges=this.surcharges.map(i=>(i.surchargePrice=a[i.airline],i)),this.saveConfig(()=>this.bottomSheetRef.dismiss(this.surcharges))}saveConfig(t){var a;if(this.hasDefaultConfig){const i=(null===(a=this.surchargeConfigs)||void 0===a?void 0:a.map(n=>{const s=this.surcharges.find(c=>c.airline===n.airline);return Object.assign(Object.assign({},n),{amount:s?s.surchargePrice:n.amount})}))||[];this.isLoading=!0,this._generalService.updateSurchargeFeeConfig(i).pipe((0,U.x)(()=>{this.isLoading=!1,t()})).subscribe({next:n=>{var s,c;if(n.success)this._toastService.add({severity:"success",summary:"C\u1eadp nh\u1eadt th\xe0nh c\xf4ng",detail:"C\u1eadp nh\u1eadt th\xf4ng tin c\u1ea5u h\xecnh th\xe0nh c\xf4ng!",sticky:!1});else{const l=null===(c=null===(s=n.objectError)||void 0===s?void 0:s.errorDescription)||void 0===c?void 0:c.vi;this._toastService.add({severity:"error",summary:"C\xf3 l\u1ed7i x\u1ea3y ra",detail:l||"Kh\xf4ng th\u1ec3 c\u1eadp nh\u1eadt c\u1ea5u h\xecnh m\u1edbi. Vui l\xf2ng th\u1eed l\u1ea1i!",sticky:!1})}},error:()=>{this._toastService.add({severity:"error",summary:"C\xf3 l\u1ed7i x\u1ea3y ra",detail:"Kh\xf4ng th\u1ec3 c\u1eadp nh\u1eadt c\u1ea5u h\xecnh m\u1edbi. Vui l\xf2ng th\u1eed l\u1ea1i!",sticky:!1})}})}else t()}onClose(){this.ref.close(!1)}getSurchargesForms(){return this.formGroup.controls.surcharges}getSurchargeItem(t){return this.surcharges.find(a=>a.airline===t.value.airline)}getFormControlInSurcharges(t){return t.controls.surchargePrice}checkChange(t){this.hasDefaultConfig=t}gotoSettings(){const t=()=>{this.bottomSheetRefDialog&&this.bottomSheetRefDialog.closeAll(),this._modal.closeAllModals(),this._route.navigate(["admin/general"])};this.isChangeConfig?this._modal.open(L.V0,{title:"H\u1ee7y b\u1ecf thay \u0111\u1ed5i?",body:"B\u1ea1n c\xf3 ch\u1eafc ch\u1eafn mu\u1ed1n h\u1ee7y b\u1ecf thay \u0111\u1ed5i v\xe0 d\u1eebng vi\u1ec7c ch\u1ec9nh s\u1eeda? H\xe0nh \u0111\u1ed9ng n\xe0y kh\xf4ng th\u1ec3 ho\xe0n t\xe1c.",okText:"C\xf3, h\u1ee7y b\u1ecf",cancelText:"Kh\xf4ng, ti\u1ebfp t\u1ee5c",isSecondary:!0}).afterClosed$.subscribe({next:i=>{i.data&&t()}}):t()}}return r.\u0275fac=function(t){return new(t||r)(e.Y36(m.KNP),e.Y36(M.gb,8),e.Y36(y.qu),e.Y36(Z.a2,8),e.Y36(Z.Rr,8),e.Y36(Z.Zu,8),e.Y36(M.oE),e.Y36(Je.F0),e.Y36(Oe.m),e.Y36(G.BX),e.Y36(k.$A))},r.\u0275cmp=e.Xpm({type:r,selectors:[["cf-surcharge-modal"]],hostAttrs:[1,"md:w-full"],standalone:!0,features:[e.jDz],decls:21,vars:5,consts:[[1,"w-[400px]","bg-white","rounded-lg","md:w-full"],[1,"flex","justify-between","items-center","px-6","py-[13px]","md:hidden"],[1,"text-heading-sm","text-neutral-black"],["size","medium","icon","close",1,"text-neutral-gray-4","cursor-pointer",3,"click"],[1,"px-6","py-4","md:w-full","md:p-4","md:pt-5"],[1,"max-h-[500px]","overflow-y-auto",3,"formGroup"],[1,"flex","flex-col","gap-y-3"],[4,"ngFor","ngForOf"],[4,"ngIf"],[1,"items-center","hidden","md:flex","mt-6","gap-x-4"],["cf-button","","size","medium","type","secondary",1,"bg-white",3,"click"],["size","small","icon","settings"],["cf-button","","size","medium",1,"hidden","justify-center","items-center","md:flex","w-full",3,"click"],[1,"flex","justify-between","items-center","py-4","px-6","md:hidden"],["cf-button","","size","medium","type","secondary","class","bg-white",3,"click",4,"ngIf"],["cf-button","","size","medium",3,"click"],[1,"w-full","h-10","flex","justify-between","border","border-neutral-gray-1","rounded"],[1,"w-[120px]","shrink-0","flex","gap-x-2","border-r","border-neutral-gray-1","py-2.5","px-4"],[1,"h-5","w-10","object-contain",3,"src"],[1,"text-body-md"],["size","medium",1,"pl-4",3,"placeholder","negative","formControl"],[1,"text-body-md-short","px-3","py-2"],["size","medium",3,"checked","checkChange"]],template:function(t,a){1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2),e._uU(3,"Ch\u1ec9nh ph\xed ph\u1ee5 thu"),e.qZA(),e.TgZ(4,"cf-icon",3),e.NdJ("click",function(){return a.onClose()}),e.qZA()(),e.TgZ(5,"div",4)(6,"form",5)(7,"div",6),e.YNc(8,xt,9,5,"ng-container",7),e.YNc(9,yt,3,1,"div",8),e.qZA()(),e.TgZ(10,"div",9)(11,"button",10),e.NdJ("click",function(){return a.gotoSettings()}),e._UZ(12,"cf-icon",11),e.qZA(),e.TgZ(13,"button",12),e.NdJ("click",function(){return a.onMobileSubmit()}),e._uU(14,"X\xe1c nh\u1eadn"),e.qZA()()(),e.TgZ(15,"div",13)(16,"div"),e.YNc(17,St,2,0,"button",14),e.qZA(),e.TgZ(18,"button",15),e.NdJ("click",function(){return a.onSubmit()}),e._uU(19," C\u1eadp nh\u1eadt "),e.qZA()()(),e.YNc(20,kt,1,0,"cf-spinner",8)),2&t&&(e.xp6(6),e.Q6J("formGroup",a.formGroup),e.xp6(2),e.Q6J("ngForOf",a.getSurchargesForms().controls),e.xp6(1),e.Q6J("ngIf",a.isUpdateSurchargeFee),e.xp6(8),e.Q6J("ngIf",a.isUpdateSurchargeFee),e.xp6(3),e.Q6J("ngIf",a.isLoading))},dependencies:[v.ez,v.sg,v.O5,y.u5,y._Y,y.JJ,y.JL,m.AxE,m.Sm8,E.N8,E.Xq,Be.j$,Be.lt,y.UX,y.oH,y.sg,be.u,L.OR],encapsulation:2}),r})();const Dt=["quotationGraphic"],Ft=["quotationGraphicPDF"],qe=function(r,o,t){return{listTicket:r,paddingBottomHeight:o,isShowHeader:t}};function Et(r,o){if(1&r&&(e.TgZ(0,"div",null,2),e.GkF(2,3),e.qZA()),2&r){const t=o.$implicit;e.oxw();const a=e.MAs(5);e.xp6(2),e.Q6J("ngTemplateOutlet",a)("ngTemplateOutletContext",e.kEZ(2,qe,t.listTicket,t.paddingBottomHeight,t.isShowHeader))}}function Pt(r,o){if(1&r&&(e.TgZ(0,"div",null,4),e.GkF(2,3),e.qZA()),2&r){const t=o.$implicit;e.oxw();const a=e.MAs(5);e.xp6(2),e.Q6J("ngTemplateOutlet",a)("ngTemplateOutletContext",e.kEZ(2,qe,t.listTicket,t.paddingBottomHeight,t.isShowHeader))}}function Nt(r,o){if(1&r&&e._UZ(0,"img",20),2&r){const t=e.oxw(3);e.Q6J("src",t.agentInfo.logoUrl,e.LSH)}}function At(r,o){1&r&&(e.O4$(),e.TgZ(0,"svg",21),e._UZ(1,"path",22),e.TgZ(2,"defs")(3,"linearGradient",23),e._UZ(4,"stop",24)(5,"stop",25),e.qZA()()())}function It(r,o){if(1&r&&(e.TgZ(0,"div",26)(1,"div",27),e._uU(2,"\u0110\u1ecba ch\u1ec9:"),e.qZA(),e.TgZ(3,"div",28),e._uU(4),e.qZA()()),2&r){const t=e.oxw(3);e.xp6(4),e.Oqu(t.agentInfo.address)}}function wt(r,o){if(1&r&&(e.TgZ(0,"div",26)(1,"div",27),e._uU(2,"Email:"),e.qZA(),e.TgZ(3,"div",28),e._uU(4),e.qZA()()),2&r){const t=e.oxw(3);e.xp6(4),e.Oqu(t.agentInfo.email)}}function Zt(r,o){if(1&r&&(e.TgZ(0,"div",26)(1,"div",27),e._uU(2,"Website:"),e.qZA(),e.TgZ(3,"div",28),e._uU(4),e.qZA()()),2&r){const t=e.oxw(3);e.xp6(4),e.Oqu(t.agentInfo.website)}}function Rt(r,o){if(1&r&&(e.TgZ(0,"div",26)(1,"div",27),e._uU(2,"Hotline:"),e.qZA(),e.TgZ(3,"div",28),e._uU(4),e.qZA()()),2&r){const t=e.oxw(3);e.xp6(4),e.Oqu(t.agentInfo.phone)}}function Mt(r,o){if(1&r&&(e.TgZ(0,"div",11)(1,"div",12)(2,"div"),e.YNc(3,Nt,1,1,"img",13),e.YNc(4,At,6,0,"svg",14),e.qZA(),e.TgZ(5,"div",15)(6,"div",16),e._uU(7,"Ph\xf2ng v\xe9"),e.qZA(),e.TgZ(8,"div",17),e._uU(9),e.qZA()()(),e.TgZ(10,"div",18),e.YNc(11,It,5,1,"div",19),e.YNc(12,wt,5,1,"div",19),e.YNc(13,Zt,5,1,"div",19),e.YNc(14,Rt,5,1,"div",19),e.qZA()()),2&r){const t=e.oxw(2);e.xp6(3),e.Q6J("ngIf",t.agentInfo.logoUrl),e.xp6(1),e.Q6J("ngIf",!t.agentInfo.logoUrl),e.xp6(5),e.Oqu(t.agentInfo.displayName),e.xp6(2),e.Q6J("ngIf",t.agentInfo.address),e.xp6(1),e.Q6J("ngIf",t.agentInfo.email),e.xp6(1),e.Q6J("ngIf",t.agentInfo.website),e.xp6(1),e.Q6J("ngIf",t.agentInfo.phone)}}function Ht(r,o){if(1&r&&(e.TgZ(0,"div",29)(1,"div",30)(2,"div",31),e._uU(3),e.qZA()(),e.TgZ(4,"div",32),e._uU(5),e.ALo(6,"date"),e.qZA()()),2&r){const t=e.oxw(2);e.xp6(3),e.AsE(" C\xe1c chuy\u1ebfn bay ch\u1eb7ng ",t.journey.startPointName," - ",t.journey.endPointName," "),e.xp6(2),e.hij(" ",e.xi3(6,3,t.journey.departDateQuotation,"EEEE, d MMMM, yyyy")," ")}}function Lt(r,o){1&r&&(e.TgZ(0,"div",33)(1,"div",34),e._uU(2,"H\xe3ng bay"),e.qZA(),e.TgZ(3,"div",35),e._uU(4,"C\u1ea5t c\xe1nh"),e.qZA(),e.TgZ(5,"div",35),e._uU(6,"H\u1ea1 c\xe1nh"),e.qZA(),e.TgZ(7,"div",35),e._uU(8,"Chuy\u1ebfn bay"),e.qZA(),e.TgZ(9,"div",35),e._uU(10,"S\u1ed1 \u0111i\u1ec3m d\u1eebng"),e.qZA(),e.TgZ(11,"div",36),e._uU(12,"T\u1ed5ng chi ph\xed"),e.qZA()())}function Qt(r,o){1&r&&(e.TgZ(0,"div",50),e._uU(1,"Bay th\u1eb3ng"),e.qZA())}function Bt(r,o){if(1&r&&(e.TgZ(0,"div"),e._uU(1),e.TgZ(2,"span",51),e._uU(3,"\u0111i\u1ec3m d\u1eebng"),e.qZA()()),2&r){const t=e.oxw().$implicit;e.xp6(1),e.hij("",t.stopStatus," ")}}function Jt(r,o){if(1&r&&(e.TgZ(0,"div",52),e._uU(1),e.ALo(2,"number"),e.qZA()),2&r){const t=e.oxw().$implicit;e.xp6(1),e.hij(" ",e.lcZ(2,1,t.netPrice+t.surcharge)," \u0111 ")}}function Ot(r,o){if(1&r&&(e.TgZ(0,"div",52),e._uU(1),e.ALo(2,"number"),e.qZA()),2&r){const t=e.oxw().$implicit;e.xp6(1),e.hij(" ",e.lcZ(2,1,t.totalPrice+t.surcharge)," \u0111 ")}}function Ut(r,o){if(1&r&&(e.TgZ(0,"div",53),e._uU(1),e.qZA()),2&r){const t=e.oxw().$implicit;e.xp6(1),e.AsE("",t.cabin," (",t.fareClass,")")}}function qt(r,o){if(1&r&&(e.TgZ(0,"div",54),e._UZ(1,"cf-icon",55),e.TgZ(2,"span"),e._uU(3),e.qZA()()),2&r){const t=e.oxw().$implicit;e.xp6(3),e.hij("Li\xean danh (do ",t.operatingName," \u0111i\u1ec1u h\xe0nh)")}}function Gt(r,o){if(1&r&&(e.TgZ(0,"div",37)(1,"div",38)(2,"div",39)(3,"div",40),e._UZ(4,"img",41)(5,"img",42),e.qZA(),e.TgZ(6,"div",43),e._uU(7),e.ALo(8,"date"),e.qZA(),e.TgZ(9,"div",43),e._uU(10),e.ALo(11,"date"),e.qZA(),e.TgZ(12,"div",43),e._uU(13),e.qZA(),e.TgZ(14,"div",43),e.YNc(15,Qt,2,0,"div",44),e.YNc(16,Bt,4,1,"div",45),e.qZA(),e.TgZ(17,"div",46),e.YNc(18,Jt,3,3,"div",47),e.YNc(19,Ot,3,3,"div",47),e.YNc(20,Ut,2,2,"div",48),e.qZA()(),e.YNc(21,qt,4,1,"div",49),e.qZA()()),2&r){const t=o.$implicit,a=e.oxw(2);e.ekj("h-[64px]",!t.isJointBenture)("h-[88px]",t.isJointBenture),e.xp6(5),e.Q6J("src",t.airlineLogo,e.LSH),e.xp6(2),e.hij(" ",e.xi3(8,14,t.departure.localTime,"HH:mm")," "),e.xp6(3),e.hij(" ",e.xi3(11,17,t.arrival.localTime,"HH:mm")," "),e.xp6(3),e.hij(" ",t.flightNumber," "),e.xp6(2),e.Q6J("ngIf",0===t.stopStatus),e.xp6(1),e.Q6J("ngIf",0!==t.stopStatus),e.xp6(2),e.Q6J("ngIf",t.showNetPrice),e.xp6(1),e.Q6J("ngIf",!t.showNetPrice),e.xp6(1),e.Q6J("ngIf",!a.isHiddenCabin),e.xp6(1),e.Q6J("ngIf",t.isJointBenture)}}function Yt(r,o){if(1&r&&(e.TgZ(0,"div",5),e.YNc(1,Mt,15,7,"div",6),e.YNc(2,Ht,7,6,"div",7),e.YNc(3,Lt,13,0,"div",8),e.YNc(4,Gt,22,20,"div",9),e._UZ(5,"div",10),e.qZA()),2&r){const t=o.listTicket,a=o.paddingBottomHeight,i=o.isShowHeader;e.xp6(1),e.Q6J("ngIf",i),e.xp6(1),e.Q6J("ngIf",i),e.xp6(1),e.Q6J("ngIf",i),e.xp6(1),e.Q6J("ngForOf",t),e.xp6(1),e.Udp("padding-bottom",a,"px")}}let jt=(()=>{class r{get listTicket(){return this._listTicket}set listTicket(t){this._listTicket=t,this.initImageListTicketGroup(),this.initPdfListTicketGroup()}constructor(t){this.listTicketGroup=[],this.listPdfTicketGroup=[],this.A4_HEIGHT=1063,this.A4_PADDING_BOTTOM=16,this.HEADER_HEIGHT=285,this.CONTENT_HEIGHT=this.A4_HEIGHT-this.HEADER_HEIGHT-this.A4_PADDING_BOTTOM,this.PDF_CONTENT_HEIGHT=this.A4_HEIGHT-2*this.A4_PADDING_BOTTOM,this.ONE_BASIC_TICKET_HEIGHT=64,this.ONE_BENTURE_TICKET_HEIGHT=88,t.registerIcons([m.B2I])}initImageListTicketGroup(){this.listTicketGroup=[];let t=0,a=[];this.listTicket.forEach(i=>{let n=0;n=i.isJointBenture?this.ONE_BENTURE_TICKET_HEIGHT:this.ONE_BASIC_TICKET_HEIGHT,t+n<=this.CONTENT_HEIGHT?(a.push(i),t+=n):(this.listTicketGroup.push({listTicket:a.map(s=>s),paddingBottomHeight:this.CONTENT_HEIGHT-t,isShowHeader:!0}),a=[],t=n,a.push(i))}),a.length>0&&this.listTicketGroup.push({listTicket:a.map(i=>i),paddingBottomHeight:this.CONTENT_HEIGHT-t,isShowHeader:!0}),this.listTicketGroup.forEach(i=>{let n=301;i.listTicket.forEach(s=>{n+=s.isJointBenture?this.ONE_BENTURE_TICKET_HEIGHT:this.ONE_BASIC_TICKET_HEIGHT})})}initPdfListTicketGroup(){this.listPdfTicketGroup=[];let t=0,a=[];this.listTicket.forEach(i=>{let n=0;n=i.isJointBenture?this.ONE_BENTURE_TICKET_HEIGHT:this.ONE_BASIC_TICKET_HEIGHT,t+n<=(0==this.listPdfTicketGroup.length?this.CONTENT_HEIGHT:this.PDF_CONTENT_HEIGHT)?(a.push(i),t+=n):(this.listPdfTicketGroup.push({listTicket:a.map(s=>s),paddingBottomHeight:(0==this.listPdfTicketGroup.length?this.CONTENT_HEIGHT:this.PDF_CONTENT_HEIGHT)-t,isShowHeader:0==this.listPdfTicketGroup.length}),a=[],t=n,a.push(i))}),a.length>0&&this.listPdfTicketGroup.push({listTicket:a.map(i=>i),paddingBottomHeight:(0==this.listPdfTicketGroup.length?this.CONTENT_HEIGHT:this.PDF_CONTENT_HEIGHT)-t,isShowHeader:0==this.listPdfTicketGroup.length}),this.listPdfTicketGroup.forEach((i,n)=>{let s=0===n?301:32;i.listTicket.forEach(c=>{s+=c.isJointBenture?this.ONE_BENTURE_TICKET_HEIGHT:this.ONE_BASIC_TICKET_HEIGHT})})}getChildNodes(){}getNativeElement(){return this.quotationGraphic}getPDFNativeElement(){return this.quotationGraphicPDF}}return r.\u0275fac=function(t){return new(t||r)(e.Y36(m.KNP))},r.\u0275cmp=e.Xpm({type:r,selectors:[["cf-quotation-graphic"]],viewQuery:function(t,a){if(1&t&&(e.Gf(Dt,5),e.Gf(Ft,5)),2&t){let i;e.iGM(i=e.CRH())&&(a.quotationGraphic=i),e.iGM(i=e.CRH())&&(a.quotationGraphicPDF=i)}},inputs:{listTicket:"listTicket",journey:"journey",agentInfo:"agentInfo",isHiddenCabin:"isHiddenCabin",cabinName:"cabinName"},standalone:!0,features:[e.jDz],decls:6,vars:2,consts:[[4,"ngFor","ngForOf"],["quotationTemplate",""],["quotationGraphic",""],[3,"ngTemplateOutlet","ngTemplateOutletContext"],["quotationGraphicPDF",""],[1,"w-[752px]","bg-neutral-white","p-4","!whitespace-nowrap"],["class","w-full p-4 rounded bg-gradient-to-r from-[#013f51] from-10% via-[#006885] via-30% to-[#006885] to-90% flex items-center gap-x-8 mb-6 h-[132px]",4,"ngIf"],["class","w-full rounded-tl-lg rounded-tr-lg border border-b-0 border-neutral-gray-1 p-4",4,"ngIf"],["class","flex gap-x-[1px]",4,"ngIf"],["class","w-full  last:rounded-bl-lg last:rounded-br-lg",3,"h-[64px]","h-[88px]",4,"ngFor","ngForOf"],[1,"w-full"],[1,"w-full","p-4","rounded","bg-gradient-to-r","from-[#013f51]","from-10%","via-[#006885]","via-30%","to-[#006885]","to-90%","flex","items-center","gap-x-8","mb-6","h-[132px]"],[1,"flex","items-center","gap-x-3"],["class","w-10 h-10 object-cover rounded-full",3,"src",4,"ngIf"],["width","32","height","20","viewBox","0 0 32 20","fill","none","xmlns","http://www.w3.org/2000/svg",4,"ngIf"],[1,"flex","flex-col","gap-y-1","text-white"],[1,"text-body-sm","opacity-80"],[1,"text-heading-xs"],[1,"flex","flex-col","gap-y-1"],["class","flex gap-x-3",4,"ngIf"],[1,"w-10","h-10","object-cover","rounded-full",3,"src"],["width","32","height","20","viewBox","0 0 32 20","fill","none","xmlns","http://www.w3.org/2000/svg"],["fill-rule","evenodd","clip-rule","evenodd","d","M19.7391 0H22.0007H31.3757C31.9958 0 32.1782 0.406859 31.8134 0.924681C31.8134 0.924681 30.3543 2.84802 29.0775 4.21654C27.6549 5.69603 25.5391 7.43443 25.5391 7.43443C25.0649 7.84129 24.153 8.17418 23.5328 8.17418H21.9643H19.7026H12.4069H10.1453H0.770366C0.150235 8.17418 -0.0321566 7.76732 0.332627 7.2495C0.332627 7.2495 1.79176 5.32616 3.0685 3.95763C4.49115 2.47814 6.60689 0.739744 6.60689 0.739744C7.08111 0.332885 7.99307 0 8.6132 0H10.1818H12.4434H19.7391ZM19.5931 11.8258H21.8548H31.2297C31.8498 11.8258 32.0322 12.2327 31.6674 12.7505C31.6674 12.7505 30.2083 14.6739 28.9316 16.0424C27.5089 17.5219 25.3932 19.2603 25.3932 19.2603C24.919 19.6671 24.007 20 23.3869 20H21.8183H19.5566H12.261H9.99933H0.624402C0.0042704 20 -0.178121 19.5932 0.186662 19.0753C0.186662 19.0753 1.64579 17.152 2.92254 15.7835C4.34519 14.304 6.46093 12.5656 6.46093 12.5656C6.93515 12.1587 7.84711 11.8258 8.46724 11.8258H10.0358H12.2975H19.5931Z","fill","url(#paint0_linear_1633_21678)"],["id","paint0_linear_1633_21678","x1","16","y1","-4.91341e-07","x2","26.3657","y2","20.0517","gradientUnits","userSpaceOnUse"],["stop-color","#E03C31"],["offset","1","stop-color","#F6C543"],[1,"flex","gap-x-3"],[1,"w-[55px]","text-neutral-gray-1","text-espressive-md"],[1,"text-white","text-body-md","whitespace-nowrap"],[1,"w-full","rounded-tl-lg","rounded-tr-lg","border","border-b-0","border-neutral-gray-1","p-4"],[1,"flex","items-center","gap-x-4"],[1,"text-heading-sm","text-neutral-gray-6"],[1,"text-body-sm","text-secondary-3-4"],[1,"flex","gap-x-[1px]"],[1,"w-[88px]","bg-neutral-gray-2","text-express-sm","text-center","py-3"],[1,"w-[104px]","bg-neutral-gray-2","text-express-sm","text-center","py-3"],[1,"flex-1","bg-neutral-gray-2","text-express-sm","text-right","py-3","pr-3"],[1,"w-full","last:rounded-bl-lg","last:rounded-br-lg"],[1,"border","border-neutral-gray-1","border-t-0"],[1,"flex"],[1,"w-[88px]","flex","justify-center","py-4"],["src","data:image/svg+xml",1,"hidden"],[1,"h-8","w-16","object-contain",3,"src"],[1,"w-[104px]","flex","justify-center","items-center","text-heading-sm","text-center","py-4"],["class","",4,"ngIf"],[4,"ngIf"],[1,"text-right","flex-1","flex","flex-col","justify-center","py-4","pr-3"],["class","text-heading-sm",4,"ngIf"],["class","text-express-sm text-neutral-gray-6",4,"ngIf"],["class","pb-2 px-3 text-body-sm text-neutral-gray-4 flex items-center gap-x-2",4,"ngIf"],[1,""],[1,"text-express-sm","text-neutral-gray-4"],[1,"text-heading-sm"],[1,"text-express-sm","text-neutral-gray-6"],[1,"pb-2","px-3","text-body-sm","text-neutral-gray-4","flex","items-center","gap-x-2"],["icon","circle_information","size","small"]],template:function(t,a){1&t&&(e.TgZ(0,"div"),e.YNc(1,Et,3,6,"div",0),e.qZA(),e.TgZ(2,"div"),e.YNc(3,Pt,3,6,"div",0),e.qZA(),e.YNc(4,Yt,6,6,"ng-template",null,1,e.W1O)),2&t&&(e.xp6(1),e.Q6J("ngForOf",a.listTicketGroup),e.xp6(2),e.Q6J("ngForOf",a.listPdfTicketGroup))},dependencies:[v.ez,v.sg,v.O5,v.tP,v.JJ,v.uU,m.AxE,m.Sm8],encapsulation:2,changeDetection:0}),r})();var p=g(15439),$t=g(64425),Kt=g(80529),Ge=g(9381),Vt=g(2225),zt=g(50223);const Wt=["quotationGraphicRef"];function Xt(r,o){if(1&r&&e._UZ(0,"img",81),2&r){const t=e.oxw();e.Q6J("src",t.agentInfo.logoUrl,e.LSH)}}function ei(r,o){1&r&&(e.O4$(),e.TgZ(0,"svg",82),e._UZ(1,"path",83),e.TgZ(2,"defs")(3,"linearGradient",84),e._UZ(4,"stop",85)(5,"stop",86),e.qZA()()())}function ti(r,o){if(1&r&&(e.TgZ(0,"div",87)(1,"div",88),e._uU(2,"\u0110\u1ecba ch\u1ec9:"),e.qZA(),e.TgZ(3,"div",89),e._uU(4),e.qZA()()),2&r){const t=e.oxw();e.xp6(4),e.Oqu(t.agentInfo.address)}}function ii(r,o){if(1&r&&(e.TgZ(0,"div",87)(1,"div",88),e._uU(2,"Email:"),e.qZA(),e.TgZ(3,"div",89),e._uU(4),e.qZA()()),2&r){const t=e.oxw();e.xp6(4),e.Oqu(t.agentInfo.email)}}function ai(r,o){if(1&r&&(e.TgZ(0,"div",87)(1,"div",88),e._uU(2,"Website:"),e.qZA(),e.TgZ(3,"div",89),e._uU(4),e.qZA()()),2&r){const t=e.oxw();e.xp6(4),e.Oqu(t.agentInfo.website)}}function ri(r,o){if(1&r&&(e.TgZ(0,"div",87)(1,"div",88),e._uU(2,"Hotline:"),e.qZA(),e.TgZ(3,"div",89),e._uU(4),e.qZA()()),2&r){const t=e.oxw();e.xp6(4),e.Oqu(t.agentInfo.phone)}}function ni(r,o){if(1&r){const t=e.EpF();e.TgZ(0,"button",90),e.NdJ("click",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.onEditHeader())}),e._UZ(1,"cf-icon",91),e._uU(2," Ch\u1ec9nh s\u1eeda "),e.qZA()}}function oi(r,o){1&r&&(e.TgZ(0,"div",103),e._uU(1,"Bay th\u1eb3ng"),e.qZA())}function si(r,o){if(1&r&&(e.TgZ(0,"div"),e._uU(1),e.TgZ(2,"span",104),e._uU(3,"\u0111i\u1ec3m d\u1eebng"),e.qZA()()),2&r){const t=e.oxw().$implicit;e.xp6(1),e.hij("",t.stopStatus," ")}}function li(r,o){if(1&r&&(e.TgZ(0,"div",105),e._uU(1),e.ALo(2,"number"),e.qZA()),2&r){const t=e.oxw().$implicit;e.xp6(1),e.hij(" ",e.lcZ(2,1,t.netPrice+(t.surcharge||0))," \u0111 ")}}function ci(r,o){if(1&r&&(e.TgZ(0,"div",105),e._uU(1),e.ALo(2,"number"),e.qZA()),2&r){const t=e.oxw().$implicit;e.xp6(1),e.hij(" ",e.lcZ(2,1,t.totalPrice+(t.surcharge||0))," \u0111 ")}}function ui(r,o){if(1&r&&(e.TgZ(0,"div",106),e._uU(1),e.qZA()),2&r){const t=e.oxw().$implicit;e.xp6(1),e.AsE(" ",t.cabin," (",t.fareClass,") ")}}function di(r,o){if(1&r&&(e.TgZ(0,"tr",107)(1,"td",108)(2,"div",109),e._UZ(3,"cf-icon",9),e._uU(4),e.qZA()()()),2&r){const t=e.oxw().$implicit;e.xp6(4),e.hij(" Li\xean danh (do ",t.operatingName," \u0111i\u1ec1u h\xe0nh) ")}}const hi=function(r){return{"border-b border-neutral-gray-1":r}};function gi(r,o){if(1&r){const t=e.EpF();e.TgZ(0,"tr",92)(1,"td",93)(2,"cf-checkbox",34),e.NdJ("checkChange",function(i){const s=e.CHM(t).$implicit,c=e.oxw();return e.KtG(c.onSelectedTicket(s,i))}),e.qZA()(),e.TgZ(3,"td",93),e._UZ(4,"img",94),e.qZA(),e.TgZ(5,"td",95)(6,"div",96),e._uU(7),e.ALo(8,"date"),e.qZA()(),e.TgZ(9,"td",95)(10,"div",96),e._uU(11),e.ALo(12,"date"),e.qZA()(),e.TgZ(13,"td",97),e._uU(14),e.qZA(),e.TgZ(15,"td",97),e.YNc(16,oi,2,0,"div",98),e.YNc(17,si,4,1,"div",44),e.qZA(),e.TgZ(18,"td",99)(19,"div",66),e.YNc(20,li,3,3,"div",100),e.YNc(21,ci,3,3,"div",100),e.YNc(22,ui,2,2,"div",101),e.qZA()()(),e.YNc(23,di,5,1,"tr",102)}if(2&r){const t=o.$implicit,a=e.oxw();e.Q6J("ngClass",e.VKq(18,hi,!t.isJointBenture)),e.xp6(2),e.Q6J("checked",t.selected),e.xp6(2),e.Q6J("src","assets/airline-logo/"+t.airline+".png",e.LSH),e.xp6(3),e.hij(" ",e.xi3(8,12,t.departure.localTime,"HH:mm")," "),e.xp6(4),e.hij(" ",e.xi3(12,15,t.arrival.localTime,"HH:mm")," "),e.xp6(3),e.hij(" ",t.flightNumber," "),e.xp6(2),e.Q6J("ngIf",0===t.stopStatus),e.xp6(1),e.Q6J("ngIf",0!==t.stopStatus),e.xp6(3),e.Q6J("ngIf",t.showNetPrice),e.xp6(1),e.Q6J("ngIf",!t.showNetPrice),e.xp6(1),e.Q6J("ngIf",!a.isHiddenCabin),e.xp6(1),e.Q6J("ngIf",t.isJointBenture)}}function pi(r,o){1&r&&e._UZ(0,"cf-spinner")}function mi(r,o){if(1&r&&e._UZ(0,"img",81),2&r){const t=e.oxw();e.Q6J("src",t.agentInfo.logoUrl,e.LSH)}}function fi(r,o){1&r&&(e.O4$(),e.TgZ(0,"svg",110),e._UZ(1,"path",111),e.TgZ(2,"defs")(3,"linearGradient",112),e._UZ(4,"stop",85)(5,"stop",86),e.qZA()()())}function _i(r,o){if(1&r){const t=e.EpF();e.TgZ(0,"div",113),e.NdJ("click",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.onEditHeaderMobile())}),e._UZ(1,"cf-icon",114),e.TgZ(2,"div",115),e._uU(3," Ch\u1ec9nh s\u1eeda "),e.qZA()()}}function Ti(r,o){1&r&&(e.TgZ(0,"div",116),e._uU(1," \u0110\u1ecba ch\u1ec9: "),e.qZA())}function vi(r,o){1&r&&(e.TgZ(0,"div",116),e._uU(1," Email: "),e.qZA())}function bi(r,o){1&r&&(e.TgZ(0,"div",116),e._uU(1," Website: "),e.qZA())}function Ci(r,o){1&r&&(e.TgZ(0,"div",116),e._uU(1," Hotline: "),e.qZA())}function xi(r,o){if(1&r&&(e.TgZ(0,"div",117),e._uU(1),e.qZA()),2&r){const t=e.oxw();e.xp6(1),e.hij(" ",t.agentInfo.address," ")}}function yi(r,o){if(1&r&&(e.TgZ(0,"div",118),e._uU(1),e.qZA()),2&r){const t=e.oxw();e.xp6(1),e.hij(" ",t.agentInfo.email," ")}}function Si(r,o){if(1&r&&(e.TgZ(0,"div",118),e._uU(1),e.qZA()),2&r){const t=e.oxw();e.xp6(1),e.hij(" ",t.agentInfo.website," ")}}function ki(r,o){if(1&r&&(e.TgZ(0,"div",118),e._uU(1),e.qZA()),2&r){const t=e.oxw();e.xp6(1),e.hij(" ",t.agentInfo.phone," ")}}function Di(r,o){1&r&&(e.TgZ(0,"div",128),e._uU(1,"Bay th\u1eb3ng"),e.qZA())}function Fi(r,o){if(1&r&&(e.TgZ(0,"div",128),e._uU(1),e.qZA()),2&r){const t=e.oxw(2).$implicit;e.xp6(1),e.hij(" ",t.stopStatus," \u0111i\u1ec3m d\u1eebng")}}function Ei(r,o){if(1&r&&(e.TgZ(0,"div",144),e._UZ(1,"cf-icon",145),e.TgZ(2,"div",146),e._uU(3),e.qZA()()),2&r){const t=e.oxw(2).$implicit;e.xp6(3),e.hij(" Li\xean danh (do ",t.operatingName," \u0111i\u1ec1u h\xe0nh) ")}}function Pi(r,o){if(1&r&&(e.TgZ(0,"div",147),e._uU(1),e.ALo(2,"replace"),e.ALo(3,"number"),e.qZA()),2&r){const t=e.oxw(2).$implicit;e.xp6(1),e.hij(" ",e.Dn7(2,1,e.lcZ(3,5,t.promotionalPrice),",",".")," \u0111")}}function Ni(r,o){if(1&r&&(e.TgZ(0,"div",148),e._uU(1),e.ALo(2,"number"),e.qZA()),2&r){const t=e.oxw(2).$implicit;e.xp6(1),e.hij(" ",e.lcZ(2,1,t.netPrice+(t.surcharge||0))," \u0111")}}function Ai(r,o){if(1&r&&(e.TgZ(0,"div",148),e._uU(1),e.ALo(2,"number"),e.qZA()),2&r){const t=e.oxw(2).$implicit;e.xp6(1),e.hij(" ",e.lcZ(2,1,t.totalPrice+(t.surcharge||0))," \u0111")}}function Ii(r,o){if(1&r){const t=e.EpF();e.TgZ(0,"div",120)(1,"div",121)(2,"div",122)(3,"div",123),e._UZ(4,"img",124),e.TgZ(5,"div",125)(6,"div",126)(7,"div",127),e._uU(8),e.ALo(9,"date"),e.qZA(),e.TgZ(10,"div",128),e._uU(11),e.qZA()(),e.TgZ(12,"div",129)(13,"div",128),e._uU(14),e.qZA(),e.TgZ(15,"div",130),e._UZ(16,"div",131)(17,"div",132),e.qZA(),e.YNc(18,Di,2,0,"div",133),e.YNc(19,Fi,2,1,"div",133),e.qZA(),e.TgZ(20,"div",126)(21,"div",127),e._uU(22),e.ALo(23,"date"),e.qZA(),e.TgZ(24,"div",128),e._uU(25),e.qZA()()()(),e.TgZ(26,"div",134)(27,"div",135),e._uU(28),e.qZA(),e._UZ(29,"div",136),e.TgZ(30,"div",137),e._uU(31),e.qZA()(),e.YNc(32,Ei,4,1,"div",138),e.qZA(),e.TgZ(33,"div",139)(34,"div",140)(35,"cf-checkbox",141),e.NdJ("checkChange",function(i){e.CHM(t);const n=e.oxw().$implicit,s=e.oxw();return e.KtG(s.onSelectedTicket(n,i))}),e.qZA(),e.YNc(36,Pi,4,7,"div",142),e.YNc(37,Ni,3,3,"div",143),e.YNc(38,Ai,3,3,"div",143),e.qZA()()()()}if(2&r){const t=e.oxw().$implicit;e.xp6(4),e.Q6J("src",t.mobileAirlineLogo,e.LSH),e.xp6(4),e.Oqu(e.xi3(9,16,t.startTime,"HH:mm")),e.xp6(3),e.Oqu(t.startPoint),e.xp6(3),e.Oqu(t.durationStr),e.xp6(4),e.Q6J("ngIf",0===t.stopStatus),e.xp6(1),e.Q6J("ngIf",t.stopStatus>0),e.xp6(3),e.Oqu(e.xi3(23,19,t.endTime,"HH:mm")),e.xp6(3),e.Oqu(t.endPoint),e.xp6(3),e.Oqu(t.operatingName),e.xp6(3),e.AsE("",t.cabinName," (",t.fareClass,") "),e.xp6(1),e.Q6J("ngIf",t.isJointBenture),e.xp6(3),e.Q6J("checked",t.selected),e.xp6(1),e.Q6J("ngIf",t.promotionalPrice),e.xp6(1),e.Q6J("ngIf",t.showNetPrice),e.xp6(1),e.Q6J("ngIf",!t.showNetPrice)}}function wi(r,o){if(1&r&&(e.ynx(0),e.YNc(1,Ii,39,22,"div",119),e.BQk()),2&r){const t=o.index,a=e.oxw();e.xp6(1),e.Q6J("ngIf",t<a.ticketInfiniteScrollCount)}}function Zi(r,o){if(1&r){const t=e.EpF();e.TgZ(0,"div",149)(1,"cf-radio-group",150),e.NdJ("ngModelChange",function(i){e.CHM(t);const n=e.oxw();return e.KtG(n.formatType=i)}),e.TgZ(2,"cf-radio",41),e._uU(3,"PDF"),e.qZA(),e.TgZ(4,"cf-radio",41),e._uU(5,"\u1ea2nh JPEG"),e.qZA(),e.TgZ(6,"cf-radio",41),e._uU(7,"SMS"),e.qZA()(),e.TgZ(8,"button",151),e.NdJ("click",function(){e.CHM(t);const i=e.oxw(),n=e.MAs(130),s=e.MAs(132);return e.KtG(i.onMobileShare(n,s))}),e._uU(9,"X\xe1c nh\u1eadn"),e.qZA()()}if(2&r){const t=e.oxw();e.xp6(1),e.Q6J("ngModel",t.formatType),e.xp6(1),e.Q6J("value","PDF"),e.xp6(2),e.Q6J("value","JPEG"),e.xp6(2),e.Q6J("value","SMS")}}function Ri(r,o){1&r&&(e.TgZ(0,"div",154),e._uU(1,"L\u01b0u \xfd: Gi\u1edbi h\u1ea1n xu\u1ea5t h\xecnh l\xe0 10 h\xecnh"),e.qZA())}function Mi(r,o){if(1&r){const t=e.EpF();e.TgZ(0,"div",149)(1,"div",152),e._uU(2,"\u0110\xe3 x\u1eed l\xfd b\xe1o gi\xe1 th\xe0nh c\xf4ng"),e.qZA(),e.YNc(3,Ri,2,0,"div",153),e.TgZ(4,"button",151),e.NdJ("click",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.webShareCall())}),e._uU(5,"Chia s\u1ebb"),e.qZA()()}if(2&r){const t=e.oxw();e.xp6(3),e.Q6J("ngIf",t.isLimitImage)}}function Hi(r,o){if(1&r){const t=e.EpF();e.TgZ(0,"div",149)(1,"div",152),e._uU(2,"\u0110\xe3 x\u1eed l\xfd b\xe1o gi\xe1 th\xe0nh c\xf4ng"),e.qZA(),e.TgZ(3,"button",151),e.NdJ("click",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.webSharePDFCall())}),e._uU(4,"Chia s\u1ebb"),e.qZA()()}}function Li(r,o){if(1&r&&(e.TgZ(0,"div",155),e._UZ(1,"cf-progress",156),e.qZA()),2&r){const t=e.oxw();e.xp6(1),e.Q6J("text","\u0110ang x\u1eed l\xfd")("percent",t.progressPercent)}}let me=(()=>{class r{constructor(t,a,i,n,s,c,l,d,u,h,f,_,T){var x;this.ref=a,this.bottomSheetData=i,this._bottomSheetService=n,this.clipboard=s,this.http=c,this._modal=l,this._toastService=d,this._mobileDetectService=u,this._generalService=h,this._permissionService=f,this._userService=_,this._urlToBase64=T,this.listTicket=[],this.listTicketSelected=[],this.listTicketSelectedLength=0,this.setOfChecked=new Set,this.formatType="JPEG",this.isDowloading=!1,this.isMobileDownloading=!1,this.isCopied=!1,this.pageSize=25,this.pageSizeList=[{num:25},{num:50},{num:70},{num:100}],this.checked=!0,this.agentInfo={address:"193/25 Nguy\u1ec5n \u0110\xecnh Ch\xednh, P.11, Q.Ph\xfa Nhu\u1eadn, TP.HCM",email:"giacmobayre@gmail.com",website:"https://giacmobayre.vn",phone:"0915522425",phoneArea:"+84",displayName:"Gi\u1ea5c m\u01a1 bay r\u1ebb",logoUrl:"",footerAttention:""},this.isHiddenCabin=!1,this.isHiddenNetPrice=!1,this.isLoadBookingFace=this._permissionService.hasPermission(k.or.ViewInfoBookingFaceConfig),this.isLoadSurchargeFee=this._permissionService.hasPermission(k.or.ViewSurchargeFeeConfig),this.surchargeConfigs=[],this.listTicketDisplay=[],this.images=[],this.canvas=[],this.isLimitImage=!We,this.progressImageMap=new Map,this.PROGRESS_DEFAULT=10,this.progressTotal=0,this.progressCurrent=0,this.progressPercent=this.PROGRESS_DEFAULT,this.sortChange=(C,A)=>this.listTicket,this.searchChange=(C,A)=>this.listTicket,this.TICKET_INFINITE_SCROLL_DEFAULT=10,this.TICKET_INFINITE_OFSET_INCREASE=10,this.ticketInfiniteScrollCount=this.TICKET_INFINITE_SCROLL_DEFAULT,t.registerIcons([m.UNF,m.B2I,m.oFb,m.Rcu,m.iYu]),this.listTicketDisplay=a?a.data.listTicketDisplay:i.listTicketDisplay,this.surcharges=[];let F=new Map;this.listTicketDisplay.forEach(C=>{F.set(C.provider,{airline:C.provider,logo:"GDS"===C.provider?"assets/icons/airline-default.svg":C.airlineLogo,operatingName:C.operatingName,surchargePrice:0})}),this.surcharges=[...F.values()];const N=localStorage.getItem("agentInfoConfig");N&&(this.agentInfo=JSON.parse(N));const I=localStorage.getItem("surchargeConfigs");I&&"undefined"!==I&&(this.surchargeConfigs=JSON.parse(I)),this.surcharges.forEach(C=>{const A=this.surchargeConfigs.find(fe=>fe.airline===C.airline);A&&(C.surchargePrice=A.amount)}),this.listTicket=this.listTicketDisplay.filter(C=>C.segments.length).map(C=>{const A=this.surchargeConfigs.find(fe=>fe.airline===C.provider);return Object.assign(Object.assign({},C),{surcharge:A?A.amount:0,isJointBenture:!["VN","QH","VJ","VU"].includes(C.operating),selected:!0})}),this.listTicketSelectedLength=this.listTicket.length,this.isLoadBookingFace&&this.getAgentInfo(),this.isLoadSurchargeFee&&this.getSurchargeFeeConfig(),this.journey=a?a.data.journey:i.journey,this.currentLeg=a?a.data.currentLeg:i.currentLeg,this.canEditHeader=a?a.data.canEditHeader:i.canEditHeader,this.isHiddenNetPrice=a?a.data.isHiddenNetPrice:i.isHiddenNetPrice,this.isHiddenCabin=a?a.data.isHiddenCabin:i.isHiddenCabin,this.currentUser=JSON.parse(null!==(x=localStorage.getItem("currentUser"))&&void 0!==x?x:"").data,this.updateListTicketSelected(),this.fileName=`baogia_${this.journey.startPoint}-${this.journey.endPoint}_${(0,v.p6)(this.journey.departDateQuotation,"ddMMyyyy","vi-VN")}`}optimizeAirlineLogo(){const t=new Map,a=this.listTicket.map(n=>({airline:n.airline,logo:`assets/airline-logo/${n.airline}_xsmall.png`})).filter((n,s,c)=>c.findIndex(l=>l.airline===n.airline)===s),i=a.map(n=>Se("/"+n.logo,Fe(n.logo),{}));(0,pe.D)(i).subscribe({next:n=>{for(let s=0;s<a.length;s++)t.set(a[s].airline,n[s]);this.listTicket.forEach(s=>{s.airlineLogoBase64=t.get(s.airline),s.airlineLogoBase64||(s.airlineLogoBase64=s.airlineLogo)})}})}getAgentInfo(){this._generalService.getBookingFaceConfig({sourceFlow:"SEARCH",bookingCode:""}).subscribe({next:a=>{a.success&&a.data&&(this.agentInfo=Object.assign({},a.data),(0,Me.t)(a.data,this.agentInfo)||localStorage.setItem("agentInfoConfig",JSON.stringify(this.agentInfo)),this.agentInfo.logoUrl&&this._urlToBase64.urlToBase64(`${this.agentInfo.logoUrl}?${(new Date).getTime()}`).subscribe(i=>{this.agentInfo.logoUrl=i},i=>{console.error("Error:",i)}))}})}getSurchargeFeeConfig(){this._generalService.getSurchargeFeeConfig().subscribe({next:t=>{t.success&&t.data&&((0,Me.t)(t.data,this.surchargeConfigs)||(localStorage.setItem("surchargeConfigs",JSON.stringify(t.data)),this.surchargeConfigs=t.data,this.surcharges.forEach(a=>{const i=this.surchargeConfigs.find(n=>n.airline===a.airline);i&&(a.surchargePrice=i.amount)}),this.listTicket.forEach(a=>{const i=this.surchargeConfigs.find(n=>n.airline===a.provider);a.surcharge=i?i.amount:0})))}})}allCheckSet(t){this.listTicket.forEach(a=>{a.selected=t}),this.updateListTicketSelected()}onClose(){this.ref.close(!1)}onSelectedTicket(t,a){t.selected=a,this.updateListTicketSelected()}updateListTicketSelected(){this.listTicketSelectedLength=this.listTicket.filter(t=>t.selected).length||0,this.checked=!this.listTicket.some(t=>!t.selected)}onFormatChange(t){this.formatType=t}onShare(t,a){if(this.listTicketSelected=this.listTicket.filter(i=>i.selected),this.listTicketSelected.length)switch(this.formatType){case"PDF":const i=this.quotationGraphicRef.getPDFNativeElement();this.exportPdf(i,a);break;case"JPEG":const n=this.quotationGraphicRef.getNativeElement();this.exportJpeg(n,t);break;case"SMS":this.exportSms()}else this._toastService.add({severity:"error",summary:"Th\u1ea5t b\u1ea1i",detail:"C\u1ea7n ch\u1ecdn \xedt nh\u1ea5t 1 chuy\u1ebfn bay \u0111\u1ec3 chia s\u1ebb.",sticky:!1})}onMobileOk(t){if(this.listTicketSelected=this.listTicket.filter(i=>i.selected),!this.listTicketSelected.length)return void this._toastService.add({severity:"error",summary:"Th\u1ea5t b\u1ea1i",detail:"C\u1ea7n ch\u1ecdn \xedt nh\u1ea5t 1 chuy\u1ebfn bay \u0111\u1ec3 chia s\u1ebb.",sticky:!1});const a=this._bottomSheetService.open(t,{headerTitle:"Ch\u1ecdn form chia s\u1ebb",rightButtonIcon:"close",rightButtonIconClass:"text-neutral-gray-4",leftButtonIcon:""});a.containerInstance._rightButtonClick.subscribe(i=>a.dismiss())}onMobileShare(t,a){this._bottomSheetService.dismiss(),this.onShare(t,a)}webShareCall(){(0,O.D)(navigator.share({files:this.isLimitImage?this.images.filter((t,a)=>a<=9):this.images})).subscribe({next:t=>console.log(t),error:t=>console.log(t)})}webSharePDFCall(){console.log(this.pdf.type),(0,O.D)(navigator.share({files:[this.pdf]})).subscribe({next:t=>console.log(t),error:t=>console.log(t)})}exportJpeg(t,a){var i=this;this._mobileDetectService.isMobile()?this.isMobileDownloading=!0:this.isDowloading=!0,setTimeout(()=>{const n=this._mobileDetectService.mobileSubject.value?.8:1,s=[];var c;(0,O.D)(Re(t.first.nativeElement,{includeFontSrc:["Roboto-Medium.ttf","Lexend.ttf","Roboto-Regular.ttf"]})).subscribe({next:(c=(0,D.Z)(function*(l){t.forEach((d,u)=>{s.push((0,Qe.P)(()=>(0,Le.C0)(d.nativeElement,{width:752,height:1063,scale:n,font:{cssText:l},progress:(h,f)=>{i.caculateProgress(u,h,f,t.length)}})))}),(0,pe.D)(s).subscribe({next:d=>{if(i.resetProgress(),i._mobileDetectService.mobileSubject.value)if(i.images=d.map((u,h)=>new File([u],`${i.fileName}${h}.png`,{type:u.type})),navigator.canShare)if(navigator.canShare({files:i.images})){const u=i._bottomSheetService.open(a,{headerTitle:"Chia s\u1ebb"});u.containerInstance._rightButtonClick.subscribe(h=>u.dismiss())}else i.saveZip(d);else i.saveZip(d);else 1===d.length?He.saveAs(d[0],`${i.fileName}.jpeg`):i.saveZip(d);i._toastService.add({severity:"success",summary:"Th\xe0nh c\xf4ng",detail:"T\u1ea1o file b\xe1o gi\xe1 th\xe0nh c\xf4ng. Vui l\xf2ng ki\u1ec3m tra k\u1ebft qu\u1ea3.",sticky:!1}),i._mobileDetectService.isMobile()?i.isMobileDownloading=!1:i.isDowloading=!1,i.ref&&i.onClose()},error:d=>{i.resetProgress(),i._mobileDetectService.isMobile()?i.isMobileDownloading=!1:i.isDowloading=!1,i._toastService.add({severity:"error",summary:"Th\u1ea5t b\u1ea1i",detail:"T\u1ea1o file b\xe1o gi\xe1 th\u1ea5t b\u1ea1i. Vui l\xf2ng th\u1eed l\u1ea1i.",sticky:!1}),i.ref&&i.onClose()}})}),function(d){return c.apply(this,arguments)})})})}caculateProgress(t,a,i,n){if(this.progressImageMap.set(t,{current:a,total:i}),this.progressImageMap.size===n){this.progressTotal=0,this.progressCurrent=0,this.progressImageMap.forEach(c=>this.progressCurrent+=c.current),this.progressImageMap.forEach(c=>this.progressTotal+=c.total);const s=Math.floor(this.progressCurrent/this.progressTotal*100);s>this.PROGRESS_DEFAULT&&(this.progressPercent=s)}}resetProgress(){this.progressTotal=0,this.progressCurrent=0,this.progressPercent=this.PROGRESS_DEFAULT,this.progressImageMap.clear()}exportPdf(t,a){var i=this;this._mobileDetectService.isMobile()?this.isMobileDownloading=!0:this.isDowloading=!0,setTimeout(()=>{const s=[];var c;(0,O.D)(Re(t.first.nativeElement,{includeFontSrc:["Roboto-Medium.ttf","Lexend.ttf","Roboto-Regular.ttf"]})).subscribe({next:(c=(0,D.Z)(function*(l){t.forEach((d,u)=>{s.push((0,Qe.P)(()=>(0,Le.E_)(d.nativeElement,{width:752,height:1063,scale:1,font:{cssText:l},progress:(h,f)=>{i.caculateProgress(u,h,f,t.length)}})))}),(0,pe.D)(s).subscribe({next:d=>{i.resetProgress();const u=new bt.ZP({orientation:"portrait",unit:"px",format:[752,1*i.quotationGraphicRef.A4_HEIGHT],compress:!0});if(d.forEach(function(){var h=(0,D.Z)(function*(f,_){u.addImage(f,"PNG",0,0,752,1*i.quotationGraphicRef.A4_HEIGHT,"","FAST"),_!==d.length-1&&u.addPage()});return function(f,_){return h.apply(this,arguments)}}()),i._mobileDetectService.mobileSubject.value){const h=u.output("blob");if(i.pdf=new File([h],`${i.fileName}.pdf`,{type:h.type}),navigator.canShare)if(navigator.canShare({files:[i.pdf]})){const f=i._bottomSheetService.open(a,{headerTitle:"Chia s\u1ebb"});f.containerInstance._rightButtonClick.subscribe(_=>f.dismiss())}else u.save(`${i.fileName}.pdf`);else u.save(`${i.fileName}.pdf`)}else u.save(`${i.fileName}.pdf`);i._toastService.add({severity:"success",summary:"Th\xe0nh c\xf4ng",detail:"T\u1ea1o file b\xe1o gi\xe1 th\xe0nh c\xf4ng. Vui l\xf2ng ki\u1ec3m tra k\u1ebft qu\u1ea3.",sticky:!1}),i._mobileDetectService.isMobile()?i.isMobileDownloading=!1:i.isDowloading=!1,i.ref&&i.onClose()},error:d=>{i.resetProgress(),i._mobileDetectService.isMobile()?i.isMobileDownloading=!1:i.isDowloading=!1,i._toastService.add({severity:"error",summary:"Th\u1ea5t b\u1ea1i",detail:"T\u1ea1o file b\xe1o gi\xe1 th\u1ea5t b\u1ea1i. Vui l\xf2ng th\u1eed l\u1ea1i.",sticky:!1})}})}),function(d){return c.apply(this,arguments)})})})}exportSms(){const t=this.proccessingSmsData();this.clipboard.copy(t),this._toastService.add({severity:"success",summary:"Th\xe0nh c\xf4ng",detail:"\u0110\xe3 copy th\xf4ng tin b\xe1o gi\xe1 th\xe0nh c\xf4ng.",sticky:!1})}proccessingSmsData(){const t={startPoint:this.journey.startPoint,startPointName:this.journey.startPointName,endPoint:this.journey.endPoint,endPointName:this.journey.endPointName,departDate:this.journey.departDate,flightOptions:this.listTicketSelected.map(i=>({flightNumber:i.segments.map(n=>n.airline+n.flightNumber).join(" -> "),departureTime:p(i.departure.localTime).format("HH:mm"),totalPrice:(i.showNetPrice?i.netPrice:i.totalPrice)+i.surcharge,checkedBag:i.checkedBag&&"Kh\xf4ng"!=i.checkedBag?`(${i.checkedBag})`:""}))};let a="";return a+=`C\xe1c chuy\u1ebfn bay t\u1eeb ${t.startPointName} (${t.startPoint}) -> ${t.endPointName} (${t.endPoint})\r\n`,a+=`${t.departDate}\r\n`,a+="(VJ: VietJet Air; QH: Bamboo Airways; VN: Vietnam Airlines; VU: Vietravel Airlines; VN6*: Pacific Airlines)\r\n",t.flightOptions.forEach(i=>{a+=`${i.flightNumber} \t${i.departureTime} \t${new Intl.NumberFormat("vi-VN").format(i.totalPrice)} ${i.checkedBag}\r\n`}),a}saveZip(t){if(!t)return;const a=new Ct,i=a.folder(this.fileName);t.forEach((n,s)=>{null==i||i.file(`${this.fileName}(${s+1}).jpeg`,n)}),a.generateAsync({type:"blob"}).then(n=>{He.saveAs(n,`${this.fileName}.zip`)})}addonSurcharge(){this._modal.open(Ue,{surcharges:this.surcharges,surchargeConfigs:this.surchargeConfigs}).afterClosed$.subscribe({next:a=>{if(a.data){this.surcharges=a.data;let i={};this.surcharges.forEach(n=>{i[n.airline]=n.surchargePrice}),this.listTicket=this.listTicket.map(n=>Object.assign(Object.assign({},n),{surcharge:i[n.provider]})),this.listTicketSelected=this.listTicketSelected.map(n=>Object.assign(Object.assign({},n),{surcharge:i[n.provider]}))}}})}addonSurchargeMobile(){const t=this._bottomSheetService.open(Ue,{headerTitle:"Ch\u1ec9nh ph\xed ph\u1ee5 thu",rightButtonIcon:"close",rightButtonIconClass:"text-neutral-gray-4",data:{surcharges:this.surcharges,surchargeConfigs:this.surchargeConfigs}});t.containerInstance._rightButtonClick.subscribe(a=>t.dismiss()),t.afterDismissed().subscribe({next:a=>{if(a){this.surcharges=a;let i={};this.surcharges.forEach(n=>{i[n.airline]=n.surchargePrice}),this.listTicket=this.listTicket.map(n=>Object.assign(Object.assign({},n),{surcharge:i[n.provider]})),this.listTicketSelected=this.listTicketSelected.map(n=>Object.assign(Object.assign({},n),{surcharge:i[n.provider]}))}}})}onShowNetPrice(){this.isHiddenNetPrice=!this.isHiddenNetPrice,this.listTicket=this.listTicket.map(t=>Object.assign(Object.assign({},t),{showNetPrice:!t.showNetPrice}))}onHiddenFare(){this.isHiddenCabin=!this.isHiddenCabin}onEditHeader(){this._modal.open(b.W3,{agentInfo:this.agentInfo}).afterClosed$.subscribe({next:a=>{a.data&&(this.agentInfo=Object.assign(Object.assign({},this.agentInfo),{address:a.data.address,email:a.data.email,website:a.data.website,phone:a.data.phone}))}})}onEditHeaderMobile(){const t=this._bottomSheetService.open(b.W3,{headerTitle:"Ch\u1ec9nh s\u1eeda th\xf4ng tin header",rightButtonIcon:"",leftButtonIcon:"close",leftButtonIconClass:"text-neutral-gray-4",containerFullHeigh:!0,data:{agentInfo:this.agentInfo}});t.containerInstance._leftButtonClick.subscribe(a=>t.dismiss()),t.afterDismissed().subscribe(a=>{a&&(this.agentInfo=Object.assign(Object.assign({},this.agentInfo),{address:a.address,email:a.email,website:a.website,phone:a.phone}))})}onMobileScrollDown(){this.ticketInfiniteScrollCount+=this.TICKET_INFINITE_OFSET_INCREASE}}return r.\u0275fac=function(t){return new(t||r)(e.Y36(m.KNP),e.Y36(M.gb,8),e.Y36(Z.Rr,8),e.Y36(Z.a2,8),e.Y36($t.TU),e.Y36(Kt.eN),e.Y36(M.oE),e.Y36(G.BX),e.Y36(Ge.L),e.Y36(Oe.m),e.Y36(k.$A),e.Y36(Vt.KD),e.Y36(zt.B))},r.\u0275cmp=e.Xpm({type:r,selectors:[["quotation-modal"]],viewQuery:function(t,a){if(1&t&&e.Gf(Wt,5),2&t){let i;e.iGM(i=e.CRH())&&(a.quotationGraphicRef=i.first)}},hostAttrs:[1,"md:w-full","relative"],standalone:!0,features:[e.jDz],decls:140,vars:64,consts:[[1,"w-[80vw]","h-[600px]","rounded-lg","bg-neutral-white","overflow-hidden","md:hidden"],[1,"w-full","h-full","flex","flex-col","max-h-[600px]"],[1,"flex","justify-between","items-center","px-6","py-[13px]","border-b","border-neutral-gray-1"],[1,"text-heading-sm","text-neutral-black"],["size","medium","icon","close",1,"text-neutral-gray-4","cursor-pointer",3,"click"],[1,"flex-auto","w-full","h-full","overflow-auto","py-4","px-6"],[1,"w-full","h-full","flex","flex-col","gap-y-6"],[1,"flex","justify-between"],[1,"text-heading-sm","text-neutral-gray-6","flex","items-center","gap-x-2"],["icon","circle_information","size","small"],[1,"flex","gap-x-4"],["size","medium",3,"checked","click"],[1,"w-full","p-4","rounded","bg-gradient-to-r","from-[#013f51]","from-10%","via-[#006885]","via-30%","to-[#006885]","to-90%","flex","justify-between","items-center","gap-x-8"],[1,"flex","items-center","gap-x-8"],[1,"flex","items-center","gap-x-3"],["class","w-10 h-10 object-cover rounded-full",3,"src",4,"ngIf"],["width","32","height","20","viewBox","0 0 32 20","fill","none","xmlns","http://www.w3.org/2000/svg",4,"ngIf"],[1,"flex","flex-col","gap-y-1","text-white"],[1,"text-body-sm","opacity-80"],[1,"text-heading-xs"],[1,"flex","flex-col","gap-y-1"],["class","flex gap-x-3",4,"ngIf"],["cf-button","","size","small","class","min-w-[114px] justify-center bg-white text-neutral-gray-6","type","secondary",3,"click",4,"ngIf"],[1,"bg-neutral-white","rounded-lg","shadow-cf-md"],[1,"p-4","flex","justify-between","items-center"],[1,"flex","items-center","gap-x-4"],[1,"text-neutral-gray-6","text-espressive-lg"],[1,"text-body-md","text-secondary-3-4","font-medium"],["cf-button","","type","secondary",3,"click"],["icon","add","size","small",1,"mr-2.5"],[1,"",3,"fnSort","fnSearch","pageSizeList","listData","pageSize"],["managerTable",""],["cf-thead",""],["cf-th",""],["size","medium",3,"checked","checkChange"],[1,"text-espressive-semibold-sm","p-3","text-right"],["ngFor","",3,"ngForOf"],[1,"p-6"],[1,"flex","justify-between","items-center"],[1,"text-body-lg"],[1,"flex","items-center","gap-x-8",3,"ngModel","ngModelChange"],["size","medium",3,"value"],["cf-button","","size","medium",3,"click"],["icon","export","size","small",1,"mr-2.5"],[4,"ngIf"],["infinite-scroll","",1,"hidden","md:flex","flex-col","p-4","w-full","gap-y-4","bg-neutral-gray-1","h-full","overflow-y-auto",3,"infiniteScrollDistance","infiniteScrollThrottle","scrollWindow","fromRoot","alwaysCallback","scrolled"],[1,"rounded","pt-3","pr-4","pb-3","pl-4","flex","flex-col","gap-4","items-start","justify-center","self-stretch","shrink-0","relative","w-full",2,"background","linear-gradient(90deg,rgba(0, 0, 0, 0.4) 0%,rgba(0, 0, 0, 0) 100%),linear-gradient(to left, #006885, #006885)"],[1,"flex","flex-row","gap-3","items-center","justify-start","self-stretch","shrink-0","relative"],[1,"flex","flex-row","gap-3.5","w-10","items-center","justify-start","shrink-0","h-5","relative"],["class","self-stretch flex-1 relative overflow-visible","width","32","height","20","viewBox","0 0 32 20","fill","none","xmlns","http://www.w3.org/2000/svg",4,"ngIf"],[1,"flex","flex-col","gap-1","items-start","justify-start","flex-1","relative"],[1,"text-neutral-white","opacity-80","text-left","relative","text-body-sm"],[1,"text-neutral-white","text-left","relative","text-heading-xs"],[1,"flex","flex-row","gap-0","items-start","justify-start","shrink-0","relative"],["class","bg-neutral-white rounded border-solid border-neutral-gray-3 border pt-2 pr-3 pb-2 pl-3 flex flex-row gap-2 items-center justify-center shrink-0 h-8 relative",3,"click",4,"ngIf"],[1,"flex","flex-row","gap-8","items-center","justify-start","self-stretch","shrink-0","relative"],[1,"flex","flex-row","gap-3","items-start","justify-start","shrink-0","relative","w-full"],[1,"flex","flex-col","gap-1","items-start","justify-start","shrink-0","relative"],["class","text-neutral-gray-2 text-left relative text-espressive-md-short",4,"ngIf"],[1,"flex","flex-col","gap-1","items-start","justify-start","shrink-0","relative","!flex-auto"],["class","text-neutral-white text-left relative text-body-md-short line-clamp-1",4,"ngIf"],["class","text-neutral-white text-left relative text-body-md-short",4,"ngIf"],[1,"flex","flex-col","gap-0","items-start","justify-start","self-stretch","shrink-0","relative"],[1,"flex","flex-row","gap-2","items-center","justify-start","self-stretch","shrink-0","relative"],[1,"text-neutral-gray-6","text-left","relative","text-heading-sm"],[1,"text-secondary-3-4","text-left","relative","self-stretch","text-espressive-md-short"],[1,"flex","flex-col"],[1,"flex","flex-row","gap-2","items-center","justify-start","shrink-0","w-full","relative"],[1,"text-neutral-gray-6-brandcolor","text-left","relative","flex-1","text-body-md-long"],["cf-button","","type","secondary","size","small",1,"bg-neutral-white",3,"click"],[1,"flex","justify-between","items-center","mt-3"],[1,"flex","flex-col","gap-y-3","mt-3","pb-16"],[4,"ngFor","ngForOf"],["formatSelectBottomSheet",""],["mobileConfirmShare",""],["mobilePdfConfirmShare",""],[1,"hidden","md:flex","justify-end","items-center","p-4","fixed","bottom-0","right-0","w-full","bg-neutral-white","shadow-cf-lg",2,"-webkit-transform","translateZ(0)"],["cf-button","","size","medium",1,"w-full","justify-center",3,"click"],[1,"absolute","bottom-[10000px]",3,"listTicket","cabinName","isHiddenCabin","journey","agentInfo"],["quotationGraphicRef",""],["class","fixed top-0 left-0 w-screen !w-[100svw] h-screen !h-[100svh] flex justify-center items-center bg-neutral-white opacity-95",4,"ngIf"],[1,"w-10","h-10","object-cover","rounded-full",3,"src"],["width","32","height","20","viewBox","0 0 32 20","fill","none","xmlns","http://www.w3.org/2000/svg"],["fill-rule","evenodd","clip-rule","evenodd","d","M19.7391 0H22.0007H31.3757C31.9958 0 32.1782 0.406859 31.8134 0.924681C31.8134 0.924681 30.3543 2.84802 29.0775 4.21654C27.6549 5.69603 25.5391 7.43443 25.5391 7.43443C25.0649 7.84129 24.153 8.17418 23.5328 8.17418H21.9643H19.7026H12.4069H10.1453H0.770366C0.150235 8.17418 -0.0321566 7.76732 0.332627 7.2495C0.332627 7.2495 1.79176 5.32616 3.0685 3.95763C4.49115 2.47814 6.60689 0.739744 6.60689 0.739744C7.08111 0.332885 7.99307 0 8.6132 0H10.1818H12.4434H19.7391ZM19.5931 11.8258H21.8548H31.2297C31.8498 11.8258 32.0322 12.2327 31.6674 12.7505C31.6674 12.7505 30.2083 14.6739 28.9316 16.0424C27.5089 17.5219 25.3932 19.2603 25.3932 19.2603C24.919 19.6671 24.007 20 23.3869 20H21.8183H19.5566H12.261H9.99933H0.624402C0.0042704 20 -0.178121 19.5932 0.186662 19.0753C0.186662 19.0753 1.64579 17.152 2.92254 15.7835C4.34519 14.304 6.46093 12.5656 6.46093 12.5656C6.93515 12.1587 7.84711 11.8258 8.46724 11.8258H10.0358H12.2975H19.5931Z","fill","url(#paint0_linear_1633_21678)"],["id","paint0_linear_1633_21678","x1","16","y1","-4.91341e-07","x2","26.3657","y2","20.0517","gradientUnits","userSpaceOnUse"],["stop-color","#E03C31"],["offset","1","stop-color","#F6C543"],[1,"flex","gap-x-3"],[1,"w-[55px]","text-neutral-gray-1","text-espressive-md"],[1,"text-white","text-body-md"],["cf-button","","size","small","type","secondary",1,"min-w-[114px]","justify-center","bg-white","text-neutral-gray-6",3,"click"],["icon","edit_alt","size","small",1,"mr-2.5"],[3,"ngClass"],[1,"py-2","px-3"],[1,"w-20","h-10","object-contain",3,"src"],[1,"py-2","px-3","text-body-sm"],[1,"text-heading-sm"],[1,"py-2","px-3","text-heading-sm"],["class","",4,"ngIf"],[1,"py-2","px-3","text-right"],["class","text-heading-md",4,"ngIf"],["class","text-express-sm text-neutral-gray-6",4,"ngIf"],["class","border-b border-neutral-gray-1",4,"ngIf"],[1,""],[1,"text-espressive-sm","text-neutral-gray-4"],[1,"text-heading-md"],[1,"text-express-sm","text-neutral-gray-6"],[1,"border-b","border-neutral-gray-1"],["colspan","7",1,"py-2","px-3.5"],[1,"text-body-sm","text-neutral-gray-4","flex","items-center","gap-x-3"],["width","32","height","20","viewBox","0 0 32 20","fill","none","xmlns","http://www.w3.org/2000/svg",1,"self-stretch","flex-1","relative","overflow-visible"],["fill-rule","evenodd","clip-rule","evenodd","d","M19.7391 0H22.0007H31.3757C31.9958 0 32.1782 0.406859 31.8134 0.924681C31.8134 0.924681 30.3543 2.84802 29.0775 4.21654C27.6549 5.69603 25.5391 7.43443 25.5391 7.43443C25.0649 7.84129 24.153 8.17418 23.5328 8.17418H21.9643H19.7026H12.4069H10.1453H0.770366C0.150235 8.17418 -0.0321566 7.76732 0.332627 7.2495C0.332627 7.2495 1.79176 5.32616 3.0685 3.95763C4.49115 2.47814 6.60689 0.739744 6.60689 0.739744C7.08111 0.332885 7.99307 0 8.6132 0H10.1818H12.4434H19.7391ZM19.5931 11.8248H21.8548H31.2297C31.8498 11.8248 32.0322 12.2317 31.6674 12.7495C31.6674 12.7495 30.2083 14.6728 28.9316 16.0414C27.5089 17.5209 25.3932 19.2593 25.3932 19.2593C24.919 19.6661 24.007 19.999 23.3869 19.999H21.8183H19.5566H12.261H9.99933H0.624402C0.00427041 19.999 -0.178121 19.5921 0.186662 19.0743C0.186662 19.0743 1.64579 17.151 2.92254 15.7825C4.34519 14.303 6.46093 12.5646 6.46093 12.5646C6.93515 12.1577 7.84711 11.8248 8.46724 11.8248H10.0358H12.2975H19.5931Z","fill","url(#paint0_linear_966_27592)"],["id","paint0_linear_966_27592","x1","16","y1","-4.91317e-07","x2","26.3648","y2","20.0511","gradientUnits","userSpaceOnUse"],[1,"bg-neutral-white","rounded","border-solid","border-neutral-gray-3","border","pt-2","pr-3","pb-2","pl-3","flex","flex-row","gap-2","items-center","justify-center","shrink-0","h-8","relative",3,"click"],["icon","edit_alt","size","small"],[1,"text-neutral-gray-6","text-left","relative","text-button-md"],[1,"text-neutral-gray-2","text-left","relative","text-espressive-md-short"],[1,"text-neutral-white","text-left","relative","text-body-md-short","line-clamp-1"],[1,"text-neutral-white","text-left","relative","text-body-md-short"],["class","bg-white rounded-[4px] flex flex-col shadow-md md:rounded-lg flex-shrink-0",4,"ngIf"],[1,"bg-white","rounded-[4px]","flex","flex-col","shadow-md","md:rounded-lg","flex-shrink-0"],[1,"flex"],[1,"flex","flex-col","justify-between","pt-8","pl-3","grow","w-full","md:pt-3","md:pb-3","md:gap-y-3","md:justify-start"],[1,"hidden","md:flex","gap-x-3","items-center"],[1,"w-[36px]","h-[36px]","object-contain",3,"src"],[1,"flex","gap-x-4","items-center"],[1,"flex","flex-col","items-center"],[1,"text-heading-xs","text-neutral-gray-6"],[1,"text-espressive-xs","text-neutral-gray-4"],[1,"flex","flex-col","items-center","gap-y-1"],[1,"flex","items-center","justify-center"],[1,"h-0","border-b","border-b-neutral-gray-4","w-[64px]"],[1,"w-1","h-1","border-[2px]","border-t-neutral-gray-4","border-r-neutral-gray-4","border-b-transparent","border-l-transparent","rotate-45"],["class","text-espressive-xs text-neutral-gray-4",4,"ngIf"],[1,"items-center","hidden","md:flex"],[1,"text-espressive-sm","text-neutral-gray-6","whitespace-nowrap"],[1,"border-r","border-r-neutral-gray-2","h-4","mx-1"],[1,"text-espressive-xs","text-neutral-gray-4","whitespace-nowrap"],["class","hidden text-espressive-sm text-secondary-3-4 md:flex gap-x-1 items-center",4,"ngIf"],[1,"flex-col","justify-between","py-3","pr-3","pl-2","border-l","border-neutral-gray-1","hidden","md:flex"],[1,"flex","flex-col","items-end","min-w-[82px]"],["size","medium",1,"mb-2","-mr-2",3,"checked","checkChange"],["class","visible line-through text-neutral-gray-4 text-body-sm whitespace-nowrap",4,"ngIf"],["class","text-heading-xs text-neutral-gray-6 whitespace-nowrap",4,"ngIf"],[1,"hidden","text-espressive-sm","text-secondary-3-4","md:flex","gap-x-1","items-center"],["icon","circle_information","size","small",1,"text-neutral-gray-4"],[1,"text-neutral-gray-4","text-left","relative","text-espressive-xs"],[1,"visible","line-through","text-neutral-gray-4","text-body-sm","whitespace-nowrap"],[1,"text-heading-xs","text-neutral-gray-6","whitespace-nowrap"],[1,"pt-5","p-4","flex","flex-col","w-full"],[1,"flex","flex-col","gap-y-4",3,"ngModel","ngModelChange"],["cf-button","",1,"w-full","justify-center","mt-6",3,"click"],[1,"flex","justify-center","text-body-md"],["class","flex justify-center text-body-sm",4,"ngIf"],[1,"flex","justify-center","text-body-sm"],[1,"fixed","top-0","left-0","w-screen","!w-[100svw]","h-screen","!h-[100svh]","flex","justify-center","items-center","bg-neutral-white","opacity-95"],[3,"text","percent"]],template:function(t,a){if(1&t){const i=e.EpF();e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3),e._uU(4),e.qZA(),e.TgZ(5,"cf-icon",4),e.NdJ("click",function(){return a.onClose()}),e.qZA()(),e.TgZ(6,"div",5)(7,"div",6)(8,"div",7)(9,"div",8),e._UZ(10,"cf-icon",9),e._uU(11," T\xf9y ch\u1ec9nh hi\u1ec3n th\u1ecb "),e.qZA(),e.TgZ(12,"div",10)(13,"cf-checkbox",11),e.NdJ("click",function(){return a.onShowNetPrice()}),e._uU(14," Hi\u1ec3n th\u1ecb gi\xe1 Net "),e.qZA(),e.TgZ(15,"cf-checkbox",11),e.NdJ("click",function(){return a.onHiddenFare()}),e._uU(16," \u1ea8n h\u1ea1ng gh\u1ebf "),e.qZA()()(),e.TgZ(17,"div",12)(18,"div",13)(19,"div",14)(20,"div"),e.YNc(21,Xt,1,1,"img",15),e.YNc(22,ei,6,0,"svg",16),e.qZA(),e.TgZ(23,"div",17)(24,"div",18),e._uU(25,"Ph\xf2ng v\xe9"),e.qZA(),e.TgZ(26,"div",19),e._uU(27),e.qZA()()(),e.TgZ(28,"div",20),e.YNc(29,ti,5,1,"div",21),e.YNc(30,ii,5,1,"div",21),e.YNc(31,ai,5,1,"div",21),e.YNc(32,ri,5,1,"div",21),e.qZA()(),e.TgZ(33,"div"),e.YNc(34,ni,3,0,"button",22),e.qZA()(),e.TgZ(35,"div",23)(36,"div",24)(37,"div")(38,"div",25)(39,"div",26),e._uU(40),e.qZA()(),e.TgZ(41,"div",27),e._uU(42),e.ALo(43,"date"),e.qZA()(),e.TgZ(44,"button",28),e.NdJ("click",function(){return a.addonSurcharge()}),e._UZ(45,"cf-icon",29),e._uU(46," Ch\u1ec9nh ph\xed ph\u1ee5 thu "),e.qZA()(),e.TgZ(47,"cf-table",30,31)(49,"thead",32)(50,"th",33)(51,"cf-checkbox",34),e.NdJ("checkChange",function(s){return a.allCheckSet(s)}),e.qZA()(),e.TgZ(52,"th",33),e._uU(53,"H\xe3ng bay"),e.qZA(),e.TgZ(54,"th",33),e._uU(55,"C\u1ea5t c\xe1nh"),e.qZA(),e.TgZ(56,"th",33),e._uU(57,"H\u1ea1 c\xe1nh"),e.qZA(),e.TgZ(58,"th",33),e._uU(59,"Chuy\u1ebfn bay"),e.qZA(),e.TgZ(60,"th",33),e._uU(61,"S\u1ed1 \u0111i\u1ec3m d\u1eebng"),e.qZA(),e.TgZ(62,"th",35),e._uU(63,"T\u1ed5ng chi ph\xed"),e.qZA()(),e.TgZ(64,"tbody"),e.YNc(65,gi,24,20,"ng-template",36),e.qZA()()()()(),e.TgZ(66,"div",37)(67,"div",38)(68,"div",10)(69,"div",39),e._uU(70,"\u0110\u1ecbnh d\u1ea1ng:"),e.qZA(),e.TgZ(71,"cf-radio-group",40),e.NdJ("ngModelChange",function(s){return a.formatType=s}),e.TgZ(72,"cf-radio",41),e._uU(73,"PDF"),e.qZA(),e.TgZ(74,"cf-radio",41),e._uU(75,"\u1ea2nh JPEG"),e.qZA(),e.TgZ(76,"cf-radio",41),e._uU(77,"SMS"),e.qZA()()(),e.TgZ(78,"button",42),e.NdJ("click",function(){return a.onShare()}),e._UZ(79,"cf-icon",43),e._uU(80," Ho\xe0n th\xe0nh "),e.qZA()()()()(),e.YNc(81,pi,1,0,"cf-spinner",44),e.TgZ(82,"div",45),e.NdJ("scrolled",function(){return a.onMobileScrollDown()}),e.TgZ(83,"div",46)(84,"div",47)(85,"div",48),e.YNc(86,mi,1,1,"img",15),e.YNc(87,fi,6,0,"svg",49),e.qZA(),e.TgZ(88,"div",50)(89,"div",51),e._uU(90," Ph\xf2ng v\xe9 "),e.qZA(),e.TgZ(91,"div",52),e._uU(92),e.qZA()(),e.TgZ(93,"div",53),e.YNc(94,_i,4,0,"div",54),e.qZA()(),e.TgZ(95,"div",55)(96,"div",56)(97,"div",57),e.YNc(98,Ti,2,0,"div",58),e.YNc(99,vi,2,0,"div",58),e.YNc(100,bi,2,0,"div",58),e.YNc(101,Ci,2,0,"div",58),e.qZA(),e.TgZ(102,"div",59),e.YNc(103,xi,2,1,"div",60),e.YNc(104,yi,2,1,"div",61),e.YNc(105,Si,2,1,"div",61),e.YNc(106,ki,2,1,"div",61),e.qZA()()()(),e.TgZ(107,"div",62)(108,"div",63)(109,"div",64),e._uU(110),e.qZA()(),e.TgZ(111,"div",65),e._uU(112),e.ALo(113,"date"),e.qZA()(),e.TgZ(114,"div",66)(115,"div",67)(116,"div",68),e._uU(117),e.qZA(),e.TgZ(118,"button",69),e.NdJ("click",function(){return a.addonSurchargeMobile()}),e._UZ(119,"cf-icon",29),e._uU(120," Ch\u1ec9nh ph\xed ph\u1ee5 thu "),e.qZA()(),e.TgZ(121,"div",70)(122,"div",68),e._uU(123),e.qZA(),e.TgZ(124,"cf-checkbox",34),e.NdJ("checkChange",function(s){return a.allCheckSet(s)}),e.qZA()(),e.TgZ(125,"div",71),e.YNc(126,wi,2,1,"ng-container",72),e.qZA()(),e.YNc(127,Zi,10,4,"ng-template",null,73,e.W1O),e.YNc(129,Mi,6,1,"ng-template",null,74,e.W1O),e.YNc(131,Hi,5,0,"ng-template",null,75,e.W1O),e.qZA(),e.TgZ(133,"div",76)(134,"button",77),e.NdJ("click",function(){e.CHM(i);const s=e.MAs(128);return e.KtG(a.onMobileOk(s))}),e._uU(135," Ho\xe0n th\xe0nh "),e.qZA()(),e._UZ(136,"cf-quotation-graphic",78,79)(138,"cf-toast"),e.YNc(139,Li,2,2,"div",80)}if(2&t){const i=e.MAs(48);e.xp6(4),e.lnq("Chia s\u1ebb c\xe1c chuy\u1ebfn bay ",a.journey.startPoint," - ",a.journey.endPoint,", ",a.journey.departDate,""),e.xp6(9),e.Q6J("checked",a.isHiddenNetPrice),e.xp6(2),e.Q6J("checked",a.isHiddenCabin),e.xp6(6),e.Q6J("ngIf",a.agentInfo.logoUrl),e.xp6(1),e.Q6J("ngIf",!a.agentInfo.logoUrl),e.xp6(5),e.Oqu(a.agentInfo.displayName),e.xp6(2),e.Q6J("ngIf",a.agentInfo.address),e.xp6(1),e.Q6J("ngIf",a.agentInfo.email),e.xp6(1),e.Q6J("ngIf",a.agentInfo.website),e.xp6(1),e.Q6J("ngIf",a.agentInfo.phone),e.xp6(2),e.Q6J("ngIf",a.canEditHeader),e.xp6(6),e.AsE(" C\xe1c chuy\u1ebfn bay ch\u1eb7ng ",a.journey.startPointName," - ",a.journey.endPointName," "),e.xp6(2),e.hij(" ",e.xi3(43,58,a.journey.departDateQuotation,"EEEE, d MMMM, yyyy")," "),e.xp6(5),e.Q6J("fnSort",a.sortChange)("fnSearch",a.searchChange)("pageSizeList",a.pageSizeList)("listData",a.listTicket)("pageSize",a.pageSize),e.xp6(4),e.Q6J("checked",a.checked),e.xp6(14),e.Q6J("ngForOf",i.partOfdata),e.xp6(6),e.Q6J("ngModel",a.formatType),e.xp6(1),e.Q6J("value","PDF"),e.xp6(2),e.Q6J("value","JPEG"),e.xp6(2),e.Q6J("value","SMS"),e.xp6(5),e.Q6J("ngIf",a.isDowloading),e.xp6(1),e.Q6J("infiniteScrollDistance",2)("infiniteScrollThrottle",300)("scrollWindow",!1)("fromRoot",!0)("alwaysCallback",!0),e.xp6(4),e.Q6J("ngIf",a.agentInfo.logoUrl),e.xp6(1),e.Q6J("ngIf",!a.agentInfo.logoUrl),e.xp6(5),e.hij(" ",a.agentInfo.displayName," "),e.xp6(2),e.Q6J("ngIf",a.canEditHeader),e.xp6(4),e.Q6J("ngIf",a.agentInfo.address),e.xp6(1),e.Q6J("ngIf",a.agentInfo.email),e.xp6(1),e.Q6J("ngIf",a.agentInfo.website),e.xp6(1),e.Q6J("ngIf",a.agentInfo.phone),e.xp6(2),e.Q6J("ngIf",a.agentInfo.address),e.xp6(1),e.Q6J("ngIf",a.agentInfo.email),e.xp6(1),e.Q6J("ngIf",a.agentInfo.website),e.xp6(1),e.Q6J("ngIf",a.agentInfo.phone),e.xp6(4),e.AsE(" C\xe1c chuy\u1ebfn bay ch\u1eb7ng ",a.journey.startPointName," - ",a.journey.endPointName," "),e.xp6(2),e.hij(" ",e.xi3(113,61,a.journey.departDateQuotation,"EEEE, d MMMM, yyyy")," "),e.xp6(5),e.hij(" ",a.listTicket.length," k\u1ebft qu\u1ea3 "),e.xp6(6),e.hij("\u0110\xe3 ch\u1ecdn: ",a.listTicketSelectedLength,""),e.xp6(1),e.Q6J("checked",a.checked),e.xp6(2),e.Q6J("ngForOf",a.listTicket),e.xp6(10),e.Q6J("listTicket",a.listTicketSelected)("cabinName",a.cabinName)("isHiddenCabin",a.isHiddenCabin)("journey",a.journey)("agentInfo",a.agentInfo),e.xp6(3),e.Q6J("ngIf",a.isMobileDownloading)}},dependencies:[v.ez,v.mk,v.sg,v.O5,v.JJ,v.uU,y.u5,y.JJ,y.On,m.AxE,m.Sm8,be.u,Ce.o,Ce.T,E.N8,E.Xq,L.OR,q.rC,q.E_,q.zs,jt,G.hj,b.AS,Q.Rq,Q.Ry,ze],encapsulation:2}),r})();var Ye=g(17489),Qi=g(13138),Bi=g(3803),Ji=g(62733),Oi=g(28490),Ui=g(85114),qi=g(77492),Gi=g(46779),Yi=g(42678),ji=g(9497);function $i(r,o){if(1&r){const t=e.EpF();e.TgZ(0,"button",46),e.NdJ("click",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.researchFlight())}),e._UZ(1,"cf-icon",47),e.TgZ(2,"div",48),e._uU(3," T\xecm chuy\u1ebfn bay "),e.qZA()()}if(2&r){const t=e.oxw();e.Q6J("disabled",t.searchFlightLoading)}}function Ki(r,o){if(1&r){const t=e.EpF();e.TgZ(0,"div",49)(1,"div",50)(2,"div",51),e.NdJ("click",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.addMultiRoute())}),e._UZ(3,"cf-icon",52),e.TgZ(4,"div",53),e._uU(5,"Th\xeam ch\u1eb7ng m\u1edbi"),e.qZA()(),e.TgZ(6,"div",54),e.NdJ("click",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.removeAllDataMultiRoute())}),e._UZ(7,"cf-icon",55),e.TgZ(8,"div",56),e._uU(9,"X\xf3a t\u1ea5t c\u1ea3"),e.qZA()()(),e.TgZ(10,"button",57),e.NdJ("click",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.researchFlight())}),e._UZ(11,"cf-icon",47),e.TgZ(12,"div",48),e._uU(13," T\xecm chuy\u1ebfn bay "),e.qZA()()()}if(2&r){const t=e.oxw();e.xp6(10),e.Q6J("disabled",t.searchFlightLoading)}}function Vi(r,o){if(1&r&&(e.TgZ(0,"div",58),e._UZ(1,"div",59),e.qZA()),2&r){const t=e.oxw();e.xp6(1),e.Udp("width",t.progress+"%")}}function zi(r,o){if(1&r){const t=e.EpF();e.TgZ(0,"app-sort-flight",60),e.NdJ("sortChange",function(i){e.CHM(t);const n=e.oxw();return e.KtG(n.onSortChange(i))}),e.qZA()}if(2&r){const t=e.oxw();e.Q6J("disableSort",t.searchFlightLoading)("sortDefault",t.sortDefault)}}function Wi(r,o){if(1&r){const t=e.EpF();e.TgZ(0,"app-sort-flight-combo",61),e.NdJ("sortChange",function(i){e.CHM(t);const n=e.oxw();return e.KtG(n.onSortChangeCombo(i))}),e.qZA()}if(2&r){const t=e.oxw();e.Q6J("sortDefault",t.sortDefaultCombo)("tabDetail",t.tabComboDetail)}}function Xi(r,o){if(1&r){const t=e.EpF();e.TgZ(0,"app-switch-mode",62),e.NdJ("modeChange",function(i){e.CHM(t);const n=e.oxw();return e.KtG(n.modeChange(i))}),e.qZA()}if(2&r){const t=e.oxw();e.Q6J("modeView",t.currentMode)("disableAgencyMode",t.searchFlightLoading)}}function ea(r,o){if(1&r){const t=e.EpF();e.TgZ(0,"div",63),e._UZ(1,"cf-icon",64),e.TgZ(2,"div",65)(3,"div",66),e._uU(4,"Kh\xf4ng t\xecm th\u1ea5y c\xe1c chuy\u1ebfn bay QH - Bamboo Airways?"),e.qZA(),e.TgZ(5,"div",56),e._uU(6,"C\xf3 th\u1ec3 b\u1ea1n \u0111\xe3 nh\u1eadp m\xe3 khuy\u1ebfn m\xe3i kh\xf4ng h\u1ee3p l\u1ec7 \u0111\u1ed1i v\u1edbi h\xe3ng Bamboo Airways. Vui l\xf2ng ki\u1ec3m tra v\xe0 th\u1eed l\u1ea1i!"),e.qZA()(),e.TgZ(7,"cf-icon",67),e.NdJ("click",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.isShowBambooPromotionError=!1)}),e.qZA()()}}function ta(r,o){if(1&r&&(e.TgZ(0,"div",72)(1,"div",73),e._uU(2),e.qZA(),e.TgZ(3,"div",74)(4,"div",75),e._uU(5),e.qZA(),e.TgZ(6,"div",76),e._uU(7),e.qZA(),e.TgZ(8,"div",77),e._uU(9),e.qZA()()()),2&r){const t=o.active,a=e.oxw(),i=a.index,n=a.$implicit;e.xp6(1),e.ekj("!text-primary-2-4",t)("!bg-primary-2-1",t),e.xp6(1),e.hij(" ",i+1," "),e.xp6(3),e.AsE("",n.startPoint," - ",n.endPoint," "),e.xp6(2),e.hij(" ",n.departDate,""),e.xp6(2),e.hij(" ",n.mobileDepartDate,"")}}function ia(r,o){if(1&r&&(e.TgZ(0,"cf-tab",70),e.YNc(1,ta,10,9,"ng-template",null,71,e.W1O),e.qZA()),2&r){const t=o.$implicit,a=e.MAs(2),i=e.oxw(2);e.Q6J("active",t.leg===i.currentLeg)("title",a)}}function aa(r,o){if(1&r){const t=e.EpF();e.TgZ(0,"cf-tabset",68),e.NdJ("selectedIndexChange",function(i){e.CHM(t);const n=e.oxw();return e.KtG(n.tabChangeIndex(i))}),e.YNc(1,ia,3,2,"cf-tab",69),e.qZA()}if(2&r){const t=e.oxw();e.xp6(1),e.Q6J("ngForOf",t.tabData)}}function ra(r,o){if(1&r){const t=e.EpF();e.TgZ(0,"app-sort-flight-combo",78),e.NdJ("sortChange",function(i){e.CHM(t);const n=e.oxw();return e.KtG(n.onSortChangeCombo(i))}),e.qZA()}if(2&r){const t=e.oxw();e.Q6J("sortDefault",t.sortDefaultCombo)("tabDetail",t.tabComboDetail)}}const je=function(r){return{"text-neutral-gray-2":r}};function na(r,o){if(1&r){const t=e.EpF();e.TgZ(0,"button",83),e.NdJ("click",function(){e.CHM(t);const i=e.oxw(2);return e.KtG(i.onRegisterBookingHunter())}),e._UZ(1,"cf-icon",84),e.TgZ(2,"span"),e._uU(3,"S\u0103n v\xe9"),e.qZA()()}if(2&r){const t=e.oxw(2);e.Q6J("disabled",t.searchFlightLoading),e.xp6(1),e.Q6J("ngClass",e.VKq(2,je,t.searchFlightLoading))}}function oa(r,o){if(1&r){const t=e.EpF();e.TgZ(0,"button",83),e.NdJ("click",function(){e.CHM(t);const i=e.oxw(2);return e.KtG(i.onQuotation(i.currentLeg))}),e._UZ(1,"cf-icon",85),e.TgZ(2,"span"),e._uU(3,"B\xe1o gi\xe1"),e.qZA()()}if(2&r){const t=e.oxw(2);e.Q6J("disabled",t.searchFlightLoading),e.xp6(1),e.Q6J("ngClass",e.VKq(2,je,t.searchFlightLoading))}}function sa(r,o){if(1&r){const t=e.EpF();e.TgZ(0,"div",79)(1,"app-switch-mode",62),e.NdJ("modeChange",function(i){e.CHM(t);const n=e.oxw();return e.KtG(n.modeChange(i))}),e.qZA(),e.TgZ(2,"div",80),e.YNc(3,na,4,4,"button",81),e.YNc(4,oa,4,4,"button",81),e.TgZ(5,"app-sort-flight",82),e.NdJ("sortChange",function(i){e.CHM(t);const n=e.oxw();return e.KtG(n.onSortChange(i))}),e.qZA()()()}if(2&r){const t=e.oxw();e.xp6(1),e.Q6J("modeView",t.currentMode)("disableAgencyMode",t.searchFlightLoading),e.xp6(2),e.Q6J("ngIf",t.huntBookingFlag),e.xp6(1),e.Q6J("ngIf",t.showQuotation&&"retail"===t.currentMode),e.xp6(1),e.Q6J("sortDefault",t.sortDefault)("disableSort",t.searchFlightLoading)}}function la(r,o){if(1&r){const t=e.EpF();e.TgZ(0,"ticket-item-combo",93),e.NdJ("ticketSelected",function(i){e.CHM(t);const n=e.oxw(4);return e.KtG(n.chooseComboTicket(i))})("ticketComboShare",function(i){e.CHM(t);const n=e.oxw(4);return e.KtG(n.onShareCombo(i))})("verifyFlight",function(i){e.CHM(t);const n=e.oxw(),s=n.$implicit,c=n.index,l=e.oxw(3);return e.KtG(l.onVerifyFlight(i,s,c))}),e.qZA()}if(2&r){const t=e.oxw().$implicit,a=e.oxw(3);e.Q6J("ticket",t)("listFareRule",a.listFareRule)("loading",a.isVerifyComboProgress)}}function ca(r,o){if(1&r&&(e.ynx(0),e.YNc(1,la,1,3,"ticket-item-combo",92),e.BQk()),2&r){const t=o.$implicit,a=o.index,i=e.oxw(3);e.xp6(1),e.Q6J("ngIf",a<i.ticketInfiniteScrollCount&&!t.soldOut)}}function ua(r,o){1&r&&(e.TgZ(0,"div",94),e._uU(1,"C\xe1c chuy\u1ebfn bay h\u1ebft ch\u1ed7"),e.qZA())}function da(r,o){if(1&r){const t=e.EpF();e.TgZ(0,"ticket-item-combo",96),e.NdJ("ticketComboShare",function(i){e.CHM(t);const n=e.oxw(4);return e.KtG(n.onShareCombo(i))}),e.qZA()}if(2&r){const t=e.oxw().$implicit,a=e.oxw(3);e.Q6J("ticket",t)("listFareRule",a.listFareRule)}}function ha(r,o){if(1&r&&(e.ynx(0),e.YNc(1,da,1,2,"ticket-item-combo",95),e.BQk()),2&r){const t=o.$implicit,a=o.index,i=e.oxw(3);e.xp6(1),e.Q6J("ngIf",a<i.ticketInfiniteScrollCount&&t.soldOut)}}function ga(r,o){if(1&r){const t=e.EpF();e.TgZ(0,"div",89),e.NdJ("scrolled",function(){e.CHM(t);const i=e.oxw(2);return e.KtG(i.onScrollDown())}),e.YNc(1,ca,2,1,"ng-container",90),e.YNc(2,ua,2,0,"div",91),e.YNc(3,ha,2,1,"ng-container",90),e.qZA()}if(2&r){const t=e.oxw(2);e.Q6J("infiniteScrollDistance",1)("infiniteScrollThrottle",300)("infiniteScrollContainer",".main-scroll-bar")("scrollWindow",!1)("fromRoot",!0)("alwaysCallback",!0),e.xp6(1),e.Q6J("ngForOf",t.listTicketComboDisplay)("ngForTrackBy",t.ticketTrackByFn),e.xp6(1),e.Q6J("ngIf",t.hasOutOfSeatComboDisplay()),e.xp6(1),e.Q6J("ngForOf",t.listTicketComboDisplay)("ngForTrackBy",t.ticketTrackByFn)}}function pa(r,o){1&r&&(e.ynx(0),e._UZ(1,"ticket-item-skeleton")(2,"ticket-item-skeleton")(3,"ticket-item-skeleton")(4,"ticket-item-skeleton"),e.BQk())}function ma(r,o){if(1&r){const t=e.EpF();e.TgZ(0,"div",99),e._UZ(1,"img",100),e.TgZ(2,"div",101),e._uU(3,"Kh\xf4ng c\xf3 chuy\u1ebfn bay n\xe0o ph\xf9 h\u1ee3p"),e.qZA(),e.TgZ(4,"div",102),e._uU(5," Vui l\xf2ng s\u1eeda \u0111\u1ed5i b\u1ed9 l\u1ecdc cho ph\xf9 h\u1ee3p ho\u1eb7c ch\u1ecdn n\xfat b\xean d\u01b0\u1edbi \u0111\u1ec3 h\u1ee7y vi\u1ec7c l\u1ecdc. "),e.qZA(),e.TgZ(6,"button",103),e.NdJ("click",function(){e.CHM(t);const i=e.oxw(3);return e.KtG(i.onResetFilter())}),e._uU(7," H\u1ee7y l\u1ecdc chuy\u1ebfn bay "),e.qZA()()}2&r&&(e.xp6(6),e.Q6J("type","solid"))}function fa(r,o){if(1&r){const t=e.EpF();e.TgZ(0,"div",99),e._UZ(1,"img",100),e.TgZ(2,"div",101),e._uU(3,"Kh\xf4ng c\xf3 chuy\u1ebfn bay n\xe0o"),e.qZA(),e.TgZ(4,"div",105),e._uU(5," Vui l\xf2ng s\u1eeda \u0111\u1ed5i b\u1ed9 l\u1ecdc ho\u1eb7c thay \u0111\u1ed5i t\xecm ki\u1ebfm c\u1ee7a b\u1ea1n. "),e.qZA(),e.TgZ(6,"button",106),e.NdJ("click",function(){e.CHM(t);const i=e.oxw(4),n=e.MAs(12);return e.KtG(i.onChangeSearch(n))}),e._UZ(7,"cf-icon",107),e._uU(8," Thay \u0111\u1ed5i t\xecm ki\u1ebfm "),e.qZA()()}2&r&&(e.xp6(6),e.Q6J("type","secondary"))}function _a(r,o){if(1&r&&e.YNc(0,fa,9,1,"div",104),2&r){const t=e.oxw(3);e.Q6J("ngIf",!t.searchFlightData.flightOptions.length)}}function Ta(r,o){if(1&r&&(e.YNc(0,ma,8,1,"div",97),e.YNc(1,_a,1,1,"ng-template",null,98,e.W1O)),2&r){const t=e.MAs(2),a=e.oxw(2);e.Q6J("ngIf",!a.listTicketComboDisplay.length)("ngIfElse",t)}}function va(r,o){if(1&r&&(e.ynx(0),e.YNc(1,ga,4,11,"div",86),e.YNc(2,pa,5,0,"ng-container",87),e.YNc(3,Ta,3,2,"ng-template",null,88,e.W1O),e.BQk()),2&r){const t=e.MAs(4),a=e.oxw();e.xp6(1),e.Q6J("ngIf",!a.searchFlightLoading),e.xp6(1),e.Q6J("ngIf",a.searchFlightLoading)("ngIfElse",t)}}function ba(r,o){1&r&&(e.ynx(0),e.TgZ(1,"div",109),e._UZ(2,"ticket-item-skeleton")(3,"ticket-item-skeleton")(4,"ticket-item-skeleton")(5,"ticket-item-skeleton"),e.qZA(),e.BQk())}function Ca(r,o){if(1&r){const t=e.EpF();e.TgZ(0,"div",99),e._UZ(1,"img",100),e.TgZ(2,"div",101),e._uU(3,"Kh\xf4ng c\xf3 chuy\u1ebfn bay n\xe0o"),e.qZA(),e.TgZ(4,"div",105),e._uU(5," Vui l\xf2ng s\u1eeda \u0111\u1ed5i b\u1ed9 l\u1ecdc ho\u1eb7c thay \u0111\u1ed5i t\xecm ki\u1ebfm c\u1ee7a b\u1ea1n. "),e.qZA(),e.TgZ(6,"button",106),e.NdJ("click",function(){e.CHM(t);const i=e.oxw(3),n=e.MAs(12);return e.KtG(i.onChangeSearch(n))}),e._UZ(7,"cf-icon",107),e._uU(8," Thay \u0111\u1ed5i t\xecm ki\u1ebfm "),e.qZA()()}2&r&&(e.xp6(6),e.Q6J("type","secondary"))}function xa(r,o){if(1&r){const t=e.EpF();e.TgZ(0,"app-ticket-item",113),e.NdJ("onReselectClick",function(i){e.CHM(t);const n=e.oxw(7);return e.KtG(n.reselect(i))}),e.qZA()}if(2&r){const t=e.oxw().$implicit,a=e.oxw(6);e.Q6J("ticket",t)("listFareRule",a.listFareRule)("mobileSelected",!0)("listFareRuleClasses",a.listFareRuleClasses)}}function ya(r,o){if(1&r&&(e.ynx(0),e.YNc(1,xa,1,4,"app-ticket-item",112),e.BQk()),2&r){const t=o.$implicit;e.xp6(1),e.Q6J("ngIf",t)}}function Sa(r,o){if(1&r&&(e.ynx(0),e.YNc(1,ya,2,1,"ng-container",111),e.BQk()),2&r){const t=e.oxw(5);e.xp6(1),e.Q6J("ngForOf",t.listTicketDisplaySelectedMobile)}}function ka(r,o){if(1&r){const t=e.EpF();e.TgZ(0,"app-ticket-item",115),e.NdJ("ticketSelected",function(i){e.CHM(t);const n=e.oxw(6);return e.KtG(n.chooseTicket(i))}),e.qZA()}if(2&r){const t=e.oxw().$implicit,a=e.oxw(5);e.Q6J("ticket",t)("listFareRule",a.listFareRule)("listFareRuleClasses",a.listFareRuleClasses)}}function Da(r,o){if(1&r&&(e.ynx(0),e.YNc(1,ka,1,3,"app-ticket-item",114),e.BQk()),2&r){const t=o.$implicit,a=o.index,i=e.oxw(5);e.xp6(1),e.Q6J("ngIf",a<i.ticketInfiniteScrollCount&&t.seatRemain>0)}}function Fa(r,o){1&r&&(e.TgZ(0,"div",94),e._uU(1,"C\xe1c chuy\u1ebfn bay h\u1ebft ch\u1ed7"),e.qZA())}function Ea(r,o){if(1&r){const t=e.EpF();e.TgZ(0,"app-ticket-item",115),e.NdJ("ticketSelected",function(i){e.CHM(t);const n=e.oxw(6);return e.KtG(n.chooseTicket(i))}),e.qZA()}if(2&r){const t=e.oxw().$implicit,a=e.oxw(5);e.Q6J("ticket",t)("listFareRule",a.listFareRule)("listFareRuleClasses",a.listFareRuleClasses)}}function Pa(r,o){if(1&r&&(e.ynx(0),e.YNc(1,Ea,1,3,"app-ticket-item",114),e.BQk()),2&r){const t=o.$implicit,a=o.index,i=e.oxw(5);e.xp6(1),e.Q6J("ngIf",a<i.ticketInfiniteScrollCount&&0===t.seatRemain)}}function Na(r,o){if(1&r){const t=e.EpF();e.TgZ(0,"div",89),e.NdJ("scrolled",function(){e.CHM(t);const i=e.oxw(4);return e.KtG(i.onScrollDown())}),e.YNc(1,Sa,2,1,"ng-container",37),e.YNc(2,Da,2,1,"ng-container",90),e.YNc(3,Fa,2,0,"div",91),e.YNc(4,Pa,2,1,"ng-container",90),e.qZA()}if(2&r){const t=e.oxw(4);e.Q6J("infiniteScrollDistance",1)("infiniteScrollThrottle",300)("infiniteScrollContainer",".main-scroll-bar")("scrollWindow",!1)("fromRoot",!0)("alwaysCallback",!0),e.xp6(1),e.Q6J("ngIf",t.isMobile),e.xp6(1),e.Q6J("ngForOf",t.listTicketDisplay)("ngForTrackBy",t.ticketTrackByFn),e.xp6(1),e.Q6J("ngIf",t.hasOutOfSeatDisplay()),e.xp6(1),e.Q6J("ngForOf",t.listTicketDisplay)("ngForTrackBy",t.ticketTrackByFn)}}function Aa(r,o){if(1&r){const t=e.EpF();e.TgZ(0,"div",99),e._UZ(1,"img",100),e.TgZ(2,"div",101),e._uU(3,"Kh\xf4ng c\xf3 chuy\u1ebfn bay n\xe0o ph\xf9 h\u1ee3p"),e.qZA(),e.TgZ(4,"div",102),e._uU(5," Vui l\xf2ng s\u1eeda \u0111\u1ed5i b\u1ed9 l\u1ecdc cho ph\xf9 h\u1ee3p ho\u1eb7c ch\u1ecdn n\xfat b\xean d\u01b0\u1edbi \u0111\u1ec3 h\u1ee7y vi\u1ec7c l\u1ecdc. "),e.qZA(),e.TgZ(6,"button",103),e.NdJ("click",function(){e.CHM(t);const i=e.oxw(4);return e.KtG(i.onResetFilter())}),e._uU(7," H\u1ee7y l\u1ecdc chuy\u1ebfn bay "),e.qZA()()}2&r&&(e.xp6(6),e.Q6J("type","solid"))}function Ia(r,o){if(1&r&&(e.YNc(0,Na,5,12,"div",86),e.YNc(1,Aa,8,1,"div",104)),2&r){const t=e.oxw(3);e.Q6J("ngIf",t.listTicketDisplay.length),e.xp6(1),e.Q6J("ngIf",!t.listTicketDisplay.length)}}function wa(r,o){if(1&r&&(e.YNc(0,Ca,9,1,"div",97),e.YNc(1,Ia,2,2,"ng-template",null,110,e.W1O)),2&r){const t=e.MAs(2),a=e.oxw(2);e.Q6J("ngIf",a.isSearchRetailEmpty)("ngIfElse",t)}}function Za(r,o){if(1&r&&(e.ynx(0),e.YNc(1,ba,6,0,"ng-container",87),e.YNc(2,wa,3,2,"ng-template",null,108,e.W1O),e.BQk()),2&r){const t=e.MAs(3),a=e.oxw();e.xp6(1),e.Q6J("ngIf",a.searchFlightLoading)("ngIfElse",t)}}function Ra(r,o){1&r&&(e.ynx(0),e.TgZ(1,"div",109),e._UZ(2,"ticket-item-skeleton")(3,"ticket-item-skeleton")(4,"ticket-item-skeleton")(5,"ticket-item-skeleton"),e.qZA(),e.BQk())}function Ma(r,o){if(1&r){const t=e.EpF();e.TgZ(0,"div",99),e._UZ(1,"img",100),e.TgZ(2,"div",101),e._uU(3,"Kh\xf4ng c\xf3 chuy\u1ebfn bay n\xe0o"),e.qZA(),e.TgZ(4,"div",105),e._uU(5," Vui l\xf2ng s\u1eeda \u0111\u1ed5i b\u1ed9 l\u1ecdc ho\u1eb7c thay \u0111\u1ed5i t\xecm ki\u1ebfm c\u1ee7a b\u1ea1n. "),e.qZA(),e.TgZ(6,"button",106),e.NdJ("click",function(){e.CHM(t);const i=e.oxw(3),n=e.MAs(12);return e.KtG(i.onChangeSearch(n))}),e._UZ(7,"cf-icon",107),e._uU(8," Thay \u0111\u1ed5i t\xecm ki\u1ebfm "),e.qZA()()}2&r&&(e.xp6(6),e.Q6J("type","secondary"))}function Ha(r,o){if(1&r){const t=e.EpF();e.TgZ(0,"agent-ticket-item",119),e.NdJ("onReselectClick",function(i){e.CHM(t);const n=e.oxw(6);return e.KtG(n.reselect(i))})("ticketSelected",function(i){e.CHM(t);const n=e.oxw(6);return e.KtG(n.chooseAgentTicket(i))}),e.qZA()}if(2&r){const t=e.oxw().$implicit,a=e.oxw(5);e.Q6J("ticket",t)("listFareRule",a.listFareRule)("mobileSelected",!0)("listFareRuleClasses",a.listFareRuleClasses)}}function La(r,o){if(1&r&&(e.ynx(0),e.YNc(1,Ha,1,4,"agent-ticket-item",118),e.BQk()),2&r){const t=o.$implicit;e.xp6(1),e.Q6J("ngIf",t)}}function Qa(r,o){if(1&r&&(e.ynx(0),e.YNc(1,La,2,1,"ng-container",111),e.BQk()),2&r){const t=e.oxw(4);e.xp6(1),e.Q6J("ngForOf",t.listTicketDisplaySelectedAgentMobile)}}function Ba(r,o){if(1&r){const t=e.EpF();e.TgZ(0,"agent-ticket-item",115),e.NdJ("ticketSelected",function(i){e.CHM(t);const n=e.oxw(6);return e.KtG(n.chooseAgentTicket(i))}),e.qZA()}if(2&r){const t=e.oxw().$implicit,a=e.oxw(5);e.Q6J("ticket",t)("listFareRule",a.listFareRule)("listFareRuleClasses",a.listFareRuleClasses)}}function Ja(r,o){if(1&r&&(e.ynx(0),e.YNc(1,Ba,1,3,"agent-ticket-item",114),e.BQk()),2&r){const t=o.$implicit,a=o.index,i=e.oxw(5);e.xp6(1),e.Q6J("ngIf",a<i.ticketInfiniteScrollCount&&!i.hasOutOfSeatAgentDisplay(t))}}function Oa(r,o){1&r&&(e.TgZ(0,"div",94),e._uU(1,"C\xe1c chuy\u1ebfn bay h\u1ebft ch\u1ed7"),e.qZA())}function Ua(r,o){if(1&r){const t=e.EpF();e.TgZ(0,"agent-ticket-item",115),e.NdJ("ticketSelected",function(i){e.CHM(t);const n=e.oxw(6);return e.KtG(n.chooseAgentTicket(i))}),e.qZA()}if(2&r){const t=e.oxw().$implicit,a=e.oxw(5);e.Q6J("ticket",t)("listFareRule",a.listFareRule)("listFareRuleClasses",a.listFareRuleClasses)}}function qa(r,o){if(1&r&&(e.ynx(0),e.YNc(1,Ua,1,3,"agent-ticket-item",114),e.BQk()),2&r){const t=o.$implicit,a=o.index,i=e.oxw(5);e.xp6(1),e.Q6J("ngIf",a<i.ticketInfiniteScrollCount&&i.hasOutOfSeatAgentDisplay(t))}}function Ga(r,o){if(1&r){const t=e.EpF();e.TgZ(0,"div",89),e.NdJ("scrolled",function(){e.CHM(t);const i=e.oxw(4);return e.KtG(i.onScrollDown())}),e.YNc(1,Ja,2,1,"ng-container",90),e.YNc(2,Oa,2,0,"div",91),e.YNc(3,qa,2,1,"ng-container",90),e.qZA()}if(2&r){const t=e.oxw(4);e.Q6J("infiniteScrollDistance",1)("infiniteScrollThrottle",300)("infiniteScrollContainer",".main-scroll-bar")("scrollWindow",!1)("fromRoot",!0)("alwaysCallback",!0),e.xp6(1),e.Q6J("ngForOf",t.listTicketAgentDisplay)("ngForTrackBy",t.ticketTrackByFn),e.xp6(1),e.Q6J("ngIf",t.hasOutOfSeatAgentDisplay()),e.xp6(1),e.Q6J("ngForOf",t.listTicketAgentDisplay)("ngForTrackBy",t.ticketTrackByFn)}}function Ya(r,o){if(1&r){const t=e.EpF();e.TgZ(0,"div",99),e._UZ(1,"img",100),e.TgZ(2,"div",101),e._uU(3,"Kh\xf4ng c\xf3 chuy\u1ebfn bay n\xe0o ph\xf9 h\u1ee3p"),e.qZA(),e.TgZ(4,"div",102),e._uU(5," Vui l\xf2ng s\u1eeda \u0111\u1ed5i b\u1ed9 l\u1ecdc cho ph\xf9 h\u1ee3p ho\u1eb7c ch\u1ecdn n\xfat b\xean d\u01b0\u1edbi \u0111\u1ec3 h\u1ee7y vi\u1ec7c l\u1ecdc. "),e.qZA(),e.TgZ(6,"button",103),e.NdJ("click",function(){e.CHM(t);const i=e.oxw(4);return e.KtG(i.onResetFilter())}),e._uU(7," H\u1ee7y l\u1ecdc chuy\u1ebfn bay "),e.qZA()()}2&r&&(e.xp6(6),e.Q6J("type","solid"))}function ja(r,o){if(1&r&&(e.YNc(0,Qa,2,1,"ng-container",37),e.YNc(1,Ga,4,11,"div",86),e.YNc(2,Ya,8,1,"div",104)),2&r){const t=e.oxw(3);e.Q6J("ngIf",t.isMobile),e.xp6(1),e.Q6J("ngIf",t.listTicketAgentDisplay.length),e.xp6(1),e.Q6J("ngIf",!t.listTicketAgentDisplay.length)}}function $a(r,o){if(1&r&&(e.YNc(0,Ma,9,1,"div",97),e.YNc(1,ja,3,3,"ng-template",null,117,e.W1O)),2&r){const t=e.MAs(2),a=e.oxw(2);e.Q6J("ngIf",a.isSearchAgentEmpty)("ngIfElse",t)}}function Ka(r,o){if(1&r&&(e.ynx(0),e.YNc(1,Ra,6,0,"ng-container",87),e.YNc(2,$a,3,2,"ng-template",null,116,e.W1O),e.BQk()),2&r){const t=e.MAs(3),a=e.oxw();e.xp6(1),e.Q6J("ngIf",a.searchFlightAgentLoading)("ngIfElse",t)}}function Va(r,o){if(1&r){const t=e.EpF();e.TgZ(0,"cf-icon",120),e.NdJ("click",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.onShare())}),e.qZA()}}function za(r,o){if(1&r&&(e.TgZ(0,"div",40)(1,"div",41),e._uU(2,"T\u1ed5ng chi ph\xed:"),e.qZA(),e.TgZ(3,"div",121),e._uU(4),e.ALo(5,"replace"),e.ALo(6,"number"),e.qZA()()),2&r){const t=e.oxw();e.xp6(4),e.hij(" ",e.Dn7(5,1,e.lcZ(6,5,t.totalPrice||0),",",".")," \u0111 ")}}let Wa=(()=>{class r{constructor(t,a,i,n,s,c,l,d,u,h,f,_,T,x,F,N){this._dataProvider=t,this._ticketSelectedDataProvider=a,this._searchFlightService=i,this._flightDataService=n,this._locationDataService=s,this.cfIconRegister=c,this._router=l,this._modal=d,this._searchInputService=u,this._permissionService=h,this._mobileDetectService=f,this._bottomSheetService=_,this._eventLogService=T,this._userService=x,this._requestDataService=F,this._systemService=N,this.tabData=[],this.tabComboDetail={cheapest:{price:0,durationStr:""},best:{price:0,durationStr:""},fastest:{price:0,durationStr:""}},this.listTicketSelected=[],this.ticketSelectedNumber=0,this.currentMode="retail",this.searchFlightLoading=!1,this.searchFlightAgentLoading=!1,this.searchFlightEmpty=!1,this.isSearchRetailEmpty=!1,this.isSearchAgentEmpty=!1,this.hasGDS=!1,this.ticketDisplayState=new Te.X({showNetPrice:!1,showSalePrice:!1,hideFareClass:!1,showDuration:!0,showTotalComboPrice:!1}),this.destroy$=new Ve.x,this.currentLeg=0,this.lastLeg=0,this.listTicket=[],this.listTicketAgent=[],this.listTicketCombo=[],this.airlineList=[],this.fareclassList=[],this.selectedFare={value:""},this.planModelList=[],this.departureTimeList=[],this.arrivalTimeList=[],this.departTimeComboList=[],this.arriveTimeComboList=[],this.bookingSystemList=[],this.minFareClss="",this.numberOfPassenger={adult:0,child:0,infant:0},this.sortDefault="min_price",this.sortState="min_price",this.sortDefaultCombo="best",this.sortStateCombo="best",this.isFirstTake=!0,this.showQuotation=this._permissionService.hasPermission(k.or.CreateFlightTicketQuote),this.showSharedFlight=this._permissionService.hasPermission(k.or.CanShareFlightSelected),this.isShowBambooPromotionError=!1,this.TICKET_INFINITE_SCROLL_DEFAULT=10,this.TICKET_INFINITE_OFSET_INCREASE=10,this.ticketInfiniteScrollCount=this.TICKET_INFINITE_SCROLL_DEFAULT,this.canEditHeader=this._permissionService.hasPermission(k.or.EditShareFlightSelectedHeader),this.huntBookingFlag=this._permissionService.hasPermission(k.or.CanMonitorHuntFareTicket),this.isShareFlight=!1,this.isHiddenTotalCharge=!1,this.durationFilter=[0,50],this.minDuration=0,this.maxDuration=50,this.priceFilter=[0,0],this.minPrice=0,this.maxPrice=0,this.filterStateInit={showAirline:[],direct:this._searchInputService.isDirectFlight,oneRoute:!1,moreRoute:!1,departTime:[],arriveTime:[],fareclass:[],bookingSystem:[],plane:[],comboTime:{departStartTime:{from:0,to:1440},arriveStartTime:{from:0,to:1440},departEndTime:{from:0,to:1440},arriveEndTime:{from:0,to:1440}},comboDuration:{from:0,to:50},comboPrice:{from:void 0,to:void 0}},this.isMobile=!1,this.progress=0,this.isprogress=!1,this.hoursDifferenceAllowed=3,this.isVerifyComboProgress=!1,this.totalPriceCombo=0,this.flightTypeSearch=S.jX.RoundTrip,this.multiFilghtType=S.jX.MultiWay,c.registerIcons([m.bHT,m.D5L,m.TM4,m.gll,m.TOh,m.KYu,m.tLH,m.IIV,m.gEm,m.D7,m.a04,m.Xlt,m.$S,m.okA,m.B2I,m.s5C,m._hx,m.YvC,m.YwC]),u.patchForm()}ngOnInit(){this.checkMobile(),this.ticketFilterState=new Te.X(this.filterStateInit),this.ticketDisplayState.pipe((0,ve.R)(this.destroy$)).subscribe({next:()=>this.loadTicketDisplay()}),this.ticketFilterState.pipe((0,ve.R)(this.destroy$)).subscribe({next:()=>{"combo"===this.currentMode?this.loadComboTicketFilter():this.loadTicketFilter()}}),this.bindingTypeSearch(),this.loadNumberOfPassenger(),this.searchFlight(),this.loadTabData(),this.loadTicketSelectedData()}startProgressBar(){this.isprogress=!0,this.interval=setInterval(()=>{if(this.progress<99){const t=25*Math.random();this.progress+=t,this.progress>100&&(this.progress=99)}else clearInterval(this.interval)},1500)}ngOnDestroy(){this._searchInputService.reset(),this.destroy$.next(),this.destroy$.complete(),this.clearTimer()}checkMobile(){this._mobileDetectService.mobileSubject.subscribe(t=>this.isMobile=t)}modeChange(t){this.currentMode=t,this.ticketInfiniteScrollCount=this.TICKET_INFINITE_SCROLL_DEFAULT}initFilterAirline(){var t;let a=[{name:"Early Morning",code:"early_morning",start:"00:00",end:"06:00",isActive:!1,disable:!1,startTime:0,endTime:360,totalAvailable:0},{name:"Morning",code:"morning",start:"06:00",end:"12:00",isActive:!1,disable:!1,startTime:360,endTime:720,totalAvailable:0},{name:"Afternoon",code:"afternoon",start:"12:00",end:"18:00",isActive:!1,disable:!1,startTime:720,endTime:1080,totalAvailable:0},{name:"Evening",code:"evening",start:"18:00",end:"24:00",isActive:!1,disable:!1,startTime:1080,endTime:1440,totalAvailable:0}],i=[{name:"Early Morning",code:"early_morning",start:"00:00",end:"06:00",isActive:!1,disable:!1,startTime:0,endTime:360,totalAvailable:0},{name:"Morning",code:"morning",start:"06:00",end:"12:00",isActive:!1,disable:!1,startTime:360,endTime:720,totalAvailable:0},{name:"Afternoon",code:"afternoon",start:"12:00",end:"18:00",isActive:!1,disable:!1,startTime:720,endTime:1080,totalAvailable:0},{name:"Evening",code:"evening",start:"18:00",end:"24:00",isActive:!1,disable:!1,startTime:1080,endTime:1440,totalAvailable:0}],n=[];this.searchFlightData.flightOptions.length&&"COMBO"!==this.searchFlightData.flightOptions[0].type&&(n=this.searchFlightData.flightOptions.flatMap(u=>u.journeys).map(u=>({airline:u.airline,airlineName:u.airlineName})).filter((u,h,f)=>f.findIndex(_=>_.airline===u.airline)===h));let s=new Map,c=Number.MAX_SAFE_INTEGER,l=new Set,d=new Map;this.searchFlightData.flightOptions.length&&"COMBO"!==this.searchFlightData.flightOptions[0].type&&this.searchFlightData.flightOptions.forEach(u=>{l.add(u.provider),u.journeys.forEach(h=>h.fareOptions.forEach(f=>{f.fareInfos.forEach(_=>{var T,x,F,N,I,C,A;f.getTotalAmount()<c&&(c=f.getTotalAmount(),_.cabin&&!(null===(T=_.cabin)||void 0===T)&&T.name&&(this.minFareClss=_.cabin.name.toUpperCase())),s.set(null===(F=null===(x=_.cabin)||void 0===x?void 0:x.name)||void 0===F?void 0:F.toUpperCase(),Object.assign(Object.assign({},_.cabin),{description:null===(I=null===(N=_.cabin)||void 0===N?void 0:N.description)||void 0===I?void 0:I.toUpperCase(),name:null===(A=null===(C=_.cabin)||void 0===C?void 0:C.name)||void 0===A?void 0:A.toUpperCase(),isActive:!1,isDisable:!1}))}),h.segments.forEach(_=>{d.set(_.modelAirplane,{code:_.modelAirplane,name:_.modelAirplaneName,isActive:!1,isDisable:!1})}),a.forEach(_=>{const T=p(h.departure.localTime).toDate(),x=60*T.getHours()+T.getMinutes();x>=_.startTime&&x<=_.endTime&&(_.totalAvailable=++_.totalAvailable)}),i.forEach(_=>{const T=p(h.arrival.localTime).toDate(),x=60*T.getHours()+T.getMinutes();x>=_.startTime&&x<=_.endTime&&(_.totalAvailable=++_.totalAvailable)})}))}),this.hasGDS=l.has("GDS"),this.bookingSystemList=this.hasGDS?[{code:"GDS",name:"Ch\u1ec9 h\u1ec7 th\u1ed1ng GDS",isActive:!1,isDisable:!1},{code:"DOMESTIC",name:"Ch\u1ec9 c\xe1c h\xe3ng n\u1ed9i \u0111\u1ecba",isActive:!1,isDisable:!1}]:[],this.fareclassList=[...s.values()].filter(u=>u.name).map(u=>u),this.selectedFare.value=(null===(t=this.fareclassList.find(u=>u.isActive))||void 0===t?void 0:t.name)||"",this.planModelList=[...d.values()],this._dataProvider.searchInputData.journey.length>1&&(this.departTimeComboList=this._dataProvider.searchInputData.journey.map(u=>({departCode:`${this._locationDataService.getCityNameByCode(u.startPoint)} (${u.startPoint})`,departTime:u.departDate})),this.arriveTimeComboList=this._dataProvider.searchInputData.journey.reverse().map(u=>({departCode:`${this._locationDataService.getCityNameByCode(u.startPoint)} (${u.startPoint})`,departTime:u.departDate}))),1===this._dataProvider.searchInputData.journey.length&&(this.departTimeComboList=this._dataProvider.searchInputData.journey.map(u=>({departCode:`${this._locationDataService.getCityNameByCode(u.startPoint)} (${u.startPoint})`,departTime:u.departDate})),this.arriveTimeComboList=this._dataProvider.searchInputData.journey.map(u=>({departCode:`${this._locationDataService.getCityNameByCode(u.endPoint)} (${u.endPoint})`,departTime:u.departDate}))),this.airlineList=n.map(u=>({code:u.airline,name:u.airlineName,actived:!1})),this.airlineList.filter(u=>u.actived).length===this.airlineList.length?this.airlineList.forEach(u=>u.actived=!1):0!==this.airlineList.filter(u=>u.actived).length&&this.ticketFilterState.next(Object.assign(Object.assign({},this.ticketFilterState.value),{showAirline:this.airlineList.filter(u=>u.actived).map(u=>u.code)}))}initComboFilter(){let t=[];t=this.searchFlightData.flightOptions.flatMap(i=>i.comboInfo).flatMap(i=>[{airline:i.departJourneys[0].airline,airlineName:i.departJourneys[0].airlineName},{airline:i.arriveJourneys[0].airline,airlineName:i.arriveJourneys[0].airlineName}]).filter((i,n,s)=>s.findIndex(c=>c.airline===i.airline)===n),this.airlineList=t.map(i=>({code:i.airline,name:i.airlineName,actived:!1})),this.departTimeComboList=this._dataProvider.searchInputData.journey.map(i=>({departCode:`${this._locationDataService.getCityNameByCode(i.startPoint)} (${i.startPoint})`,departTime:i.departDate})),this.arriveTimeComboList=this._dataProvider.searchInputData.journey.reverse().map(i=>({departCode:`${this._locationDataService.getCityNameByCode(i.startPoint)} (${i.startPoint})`,departTime:i.departDate}));const a=this.listTicketCombo.map(i=>i.departOptions[0].totalPrice+i.arriveOptions[0].totalPrice);this.priceFilter=[Math.min(...a),Math.max(...a)],this.minPrice=this.priceFilter[0],this.maxPrice=this.priceFilter[1]}checkQHPromotionError(){this.isShowBambooPromotionError=!(this.airlineList.find(t=>"QH"===t.code)||!this._dataProvider.searchInputData.promotion.find(t=>"QH"===t.airline)||!this._dataProvider.searchInputData.journey.find(t=>t.airline.includes("QH")||t.airline.includes("qh")))}filterChange(t){this.ticketFilterState.next(Object.assign(Object.assign({},this.ticketFilterState.value),t))}displayChange(t){this.ticketDisplayState.next(Object.assign(Object.assign({},this.ticketDisplayState.value),t))}loadNumberOfPassenger(){this.numberOfPassenger={adult:this._dataProvider.searchInputData.adult,child:this._dataProvider.searchInputData.child,infant:this._dataProvider.searchInputData.infant}}onScrollDown(){this.ticketInfiniteScrollCount+=this.TICKET_INFINITE_OFSET_INCREASE}loadTabData(){this.tabData=this._dataProvider.searchInputData.journey.map((t,a)=>({startPoint:t.startPoint,endPoint:t.endPoint,departDate:(0,v.p6)(t.departDate,"EEEE","vi-VN")+", ng\xe0y "+(0,v.p6)(t.departDate,"dd/MM/yyyy","vi-VN"),departDateQuotation:t.departDate,mobileDepartDate:(0,v.p6)(t.departDate,"EEEEEE-dd/MM","vi-VN"),active:0===a,leg:a})),this.lastLeg=this.tabData.length-1,this.currentLeg>this.lastLeg&&(this.currentLeg=this.lastLeg)}loadTicketSelectedData(){this.listTicketSelected=this._dataProvider.searchInputData.journey.map((t,a)=>({startPoint:this._locationDataService.getCityNameByCode(t.startPoint),endPoint:this._locationDataService.getCityNameByCode(t.endPoint),departDate:(0,v.p6)(t.departDate,"EEEE, dd/MM/yyyy","vi-VN"),startCode:t.startPoint,endCode:t.endPoint,airlineLogo:"",provider:"",airline:"",airlineName:"",operating:"",operatingName:"",flight:"",startTime:new Date((new Date).setHours(0,0,0,0)),endTime:new Date((new Date).setHours(0,0,0,0)),expireTime:(new Date).getMilliseconds(),duration:"",highlight:0===a,selected:!1,actived:!1,numOfStop:0,totalPrice:0,journeyKey:"",journeyFareClass:"",fareOptionKey:"",sessionId:"",segments:[],bookingType:"b2c",leg:a,isHiddenTotalCharge:!1,bagCharge:0,seatCharge:0,comboRefs:[]})),this.listTicketDisplaySelectedMobile=this._dataProvider.searchInputData.journey.map(t=>{}),this.listTicketDisplaySelectedAgentMobile=this._dataProvider.searchInputData.journey.map(t=>{})}tabChangeIndex(t){this.currentLeg=t,this.autoInactivePreview(),this.loadTicketFilter()}chooseTicket(t){const a=()=>{const i=this.getFareRuleClass(t.airline,t.fareClass,t.fareType);this.listTicketSelected[t.leg].airlineLogo=t.airlineLogo,this.listTicketSelected[t.leg].provider=t.provider,this.listTicketSelected[t.leg].airline=t.airline,this.listTicketSelected[t.leg].airlineName=t.airlineName,this.listTicketSelected[t.leg].operating=t.operating,this.listTicketSelected[t.leg].operatingName=t.operatingName,this.listTicketSelected[t.leg].flight=t.flightNumber,this.listTicketSelected[t.leg].startTime=t.startTime,this.listTicketSelected[t.leg].endTime=t.endTime,this.listTicketSelected[t.leg].duration=t.durationStr,this.listTicketSelected[t.leg].expireTime=t.expireTime,this.listTicketSelected[t.leg].numOfStop=t.stopStatus,this.listTicketSelected[t.leg].selected=!0,this.listTicketSelected[t.leg].bookingType="b2c",this.listTicketSelected[t.leg].totalPrice=t.ticketDetail.totalCharge,this.listTicketSelected[t.leg].journeyKey=t.journeyKey,this.listTicketSelected[t.leg].journeyFareClass=t.journeyFareClass,this.listTicketSelected[t.leg].fareOptionKey=t.fareOptionKey,this.listTicketSelected[t.leg].segments=t.segments,this.listTicketSelected[t.leg].actived=!0,this.listTicketSelected[t.leg].leg=t.leg,this.listTicketSelected[t.leg].ticketPrice=t.ticketDetail,this.listTicketSelected[t.leg].fareRule=this.listFareRule.find(n=>{var s,c;return n.airline===t.airline&&(null===(s=n.fareClass)||void 0===s?void 0:s.toLowerCase())===(null===(c=t.fareType)||void 0===c?void 0:c.toLowerCase())})||null,this.listTicketSelected[t.leg].handBag=i.handBag,this.listTicketSelected[t.leg].checkedBag=i.checkedBag,this.listTicketSelected[t.leg].isHiddenTotalCharge=0===t.ticketDetail.totalCharge&&"VN"===t.airline&&"agency"===this.currentMode,this.listTicketDisplaySelectedMobile[t.leg]=t,this.caculateTotalPrice(),this.caculateTicketSelectedNumber(),this.moveToNextJourney(),this.checkShareFlight(),this.showTotalCharge()};if(this.listTicketSelected.every(i=>!i.journeyKey))a();else{const{startTime:i,endTime:n}=this.listTicketSelected[t.leg];this.listTicketSelected[t.leg].startTime=t.startTime,this.listTicketSelected[t.leg].endTime=t.endTime;for(const[s,c]of this.listTicketSelected.entries())if(s>0){const l=this.listTicketSelected[s-1];if((c.startTime.getTime()-l.endTime.getTime())/36e5<=this.hoursDifferenceAllowed)return this._modal.open(b.bK,{}),this.listTicketSelected[t.leg].startTime=i,void(this.listTicketSelected[t.leg].endTime=n);a()}}}checkShareFlight(){var t;this.isShareFlight=null===(t=this.listTicketSelected)||void 0===t?void 0:t.some(a=>a.segments.length)}autoInactivePreview(){this.listTicketSelected.forEach(t=>{t.highlight=t.leg===this.currentLeg,t.actived=!!t.journeyKey})}convertComboTicketToTicketSelectedVM(t,a){const i=Ye.cloneDeep(this.listTicketSelected[a]);return i.airlineLogo=t.airlineLogo,i.provider=t.provider,i.airline=t.airline,i.airlineName=t.airlineName,i.flight=t.flightNumber,i.startTime=t.departureDate,i.endTime=t.returnDate,i.expireTime=t.expireTime,i.duration=t.durationStr,i.numOfStop=t.numOfStop,i.selected=!0,i.bookingType="combo",i.totalPrice=t.ticketPrice.totalCharge,i.journeyKey=t.journeyKey,i.fareOptionKey=t.fareOptionKey,i.actived=!0,i.leg=a,i.ticketPrice=t.ticketPrice,i.fareRule={airline:t.airline,fareClass:"VN"===t.airline?t.fareClass||"":t.fareType||"",rules:[]},i.handBag="",i.checkedBag="",i.isHiddenTotalCharge=!1,i.journeyFareClass=t.cabin||"",i.sessionId="",i.segments=t.segments.map(n=>({segmentKey:n.key,fareClass:n.fareClass,airline:n.airline,airlineName:n.airlineName,airlineLogo:this._flightDataService.getAirlineLogoByCode(n.airline),operating:n.operating,operatingName:n.operatingName,jetCode:n.modelAirplane,startCode:n.startPoint,endCode:n.endPoint,startPoint:n.startPointName,endPoint:n.endPointName,departDate:n.startDate,arrivalDate:n.endDate,flightNumber:n.flightNumber,modelAirplane:n.modelAirplane,modelAirplaneName:n.modelAirplaneName,stopPoint:n.stopPoint,duration:""})),i.comboRefs=t.comboRefs,i}chooseComboTicket(t){var a;const i=null===(a=t[0].comboRefs)||void 0===a?void 0:a.find(n=>n.key===t[1].fareOptionKey);t.forEach((n,s)=>{this.listTicketSelected[s]=this.convertComboTicketToTicketSelectedVM(n,s),this.listTicketSelected[s].sessionId=(null==i?void 0:i.sessionId)||""}),this.caculateTotalPrice(),this.moveToNextJourney()}chooseAgentTicket(t){var a,i;this.listTicketSelected[t.leg].airlineLogo=t.airlineLogo,this.listTicketSelected[t.leg].provider=t.provider,this.listTicketSelected[t.leg].airline=t.airline,this.listTicketSelected[t.leg].airlineName=t.airlineName,this.listTicketSelected[t.leg].operating=t.operating,this.listTicketSelected[t.leg].operatingName=t.operatingName,this.listTicketSelected[t.leg].flight=t.segmentsDisplay[0].flightNumber,this.listTicketSelected[t.leg].startTime=t.departure.localTime,this.listTicketSelected[t.leg].endTime=t.arrival.localTime,this.listTicketSelected[t.leg].expireTime=t.expireTime,this.listTicketSelected[t.leg].duration=t.durationStr,this.listTicketSelected[t.leg].numOfStop=t.numOfStop,this.listTicketSelected[t.leg].ticketPrice=t.ticketDetail,this.listTicketSelected[t.leg].selected=!0,this.listTicketSelected[t.leg].bookingType="b2b",this.listTicketSelected[t.leg].fareRule=t.fareRule,this.listTicketSelected[t.leg].journeyFareClass=(null===(a=null==t?void 0:t.fareRule)||void 0===a?void 0:a.fareClass)||"";const n=t.segmentsDisplay.flatMap(s=>{const c=s.fareClasses.find(l=>l.isSelected);return c?(this.listTicketSelected[t.leg].ticketPrice=c.ticketPriceDetail,c.totalPrice):0}).reduce((s,c)=>s+c,0);this.listTicketSelected[t.leg].totalPrice=n,this.listTicketSelected[t.leg].journeyKey=t.journeyKey,this.listTicketSelected[t.leg].isHiddenTotalCharge=0===n&&"VN"===t.airline&&"agency"===this.currentMode,this.listTicketSelected[t.leg].fareOptionKey=null===(i=t.segmentsDisplay[0].fareClasses.find(s=>s.isSelected))||void 0===i?void 0:i.fareOptionKey,this.listTicketSelected[t.leg].segments=t.segmentDetails.map((s,c)=>{var l,d;return{segmentKey:s.segmentKey,fareClass:"VJ"===t.airline||"QH"===t.airline?null===(l=t.segmentsDisplay[0].fareClasses.find(u=>u.isSelected))||void 0===l?void 0:l.fareClass:null===(d=t.segmentsDisplay[c].fareClasses.find(u=>u.isSelected))||void 0===d?void 0:d.fareClass,airline:s.airline,airlineName:s.airlineName,airlineLogo:this._flightDataService.getAirlineLogoByCode(s.airline),operating:s.operating,operatingName:s.operatingName,jetCode:s.jetCode,startCode:s.startCode,endCode:s.endCode,startPoint:s.startPoint,endPoint:s.endPoint,departDate:s.departDate,arrivalDate:s.arrivalDate,flightNumber:s.flightNumber,modelAirplane:s.modelAirplane,modelAirplaneName:s.modelAirplaneName,stopPoint:s.stopPoint,duration:s.durationStr}}),this.listTicketDisplaySelectedAgentMobile[t.leg]=t,this.autoInactivePreview(),this.caculateTotalPrice(),this.caculateTicketSelectedNumber(),this.moveToNextJourney(),this.showTotalCharge(),this.checkShareFlight()}showTotalCharge(){this.isHiddenTotalCharge=this.listTicketSelected.some(t=>t.isHiddenTotalCharge)}reselect(t){this.listTicketSelected[t].airlineLogo="",this.listTicketSelected[t].airline="",this.listTicketSelected[t].journeyKey="",this.listTicketSelected[t].flight="",this.listTicketSelected[t].startTime=new Date,this.listTicketSelected[t].endTime=new Date,this.listTicketSelected[t].duration="",this.listTicketSelected[t].numOfStop=-1,this.listTicketSelected[t].selected=!1,this.listTicketSelected[t].totalPrice=0,this.listTicketSelected[t].segments=[],this.listTicketSelected[t].isHiddenTotalCharge=!1,this.listTicketDisplaySelectedMobile[t]=void 0,this.listTicketDisplaySelectedAgentMobile[t]=void 0,this.tabChangeIndex(t),this.caculateTotalPrice(),this.caculateTicketSelectedNumber(),this.checkShareFlight(),this.showTotalCharge(),this.ticketInfiniteScrollCount+=1}caculateTotalPrice(){var t,a;this.totalPrice=this.listTicketSelected.map(i=>i.totalPrice).reduce((i,n)=>i+n),this.totalPriceCombo=(null===(a=null===(t=this.listTicketSelected[0].comboRefs)||void 0===t?void 0:t.find(i=>i.key===this.listTicketSelected[1].fareOptionKey))||void 0===a?void 0:a.totalAllPaxPriceCombo)||0}caculateTicketSelectedNumber(){this.ticketSelectedNumber=this.listTicketSelected.filter(t=>t.selected).length}moveToNextJourney(){const t=this.listTicketSelected.findIndex(a=>!a.selected);if(-1==t)if(this.isMobile){const a=this._bottomSheetService.open(b.GM,{headerTitle:"X\xe1c nh\u1eadn chuy\u1ebfn bay \u0111\xe3 ch\u1ecdn",rightButtonIcon:"close",leftButtonIcon:"share",containerFullHeigh:!0,rightButtonIconClass:"text-neutral-gray-4",data:{ticketsSelected:this.listTicketSelected,totalPrice:this.totalPrice,totalPriceCombo:this.totalPriceCombo}});a.containerInstance._leftButtonClick.subscribe(i=>{const n=this._bottomSheetService.open(b.eP,{headerTitle:"Chia s\u1ebb c\xe1c chuy\u1ebfn bay l\u1ef1a ch\u1ecdn",leftButtonIcon:"",leftButtonIconClass:"text-neutral-gray-4",rightButtonIcon:"close",containerFullHeigh:!0,data:{ticketsSelected:this.listTicketSelected,canEditHeader:this.canEditHeader,totalPrice:this.listTicketSelected.map(s=>s.totalPrice).reduce((s,c)=>s+c),isHiddenTotalCharge:this.isHiddenTotalCharge}});n.containerInstance._rightButtonClick.subscribe(s=>n.dismiss())}),a.afterDismissed().subscribe(i=>{i?(this._ticketSelectedDataProvider.ticketSelectedData=this.listTicketSelected,this._eventLogService.captureConfirmFlyBook(),this._router.navigate(["/admin/passenger-info"])):(this._eventLogService.captureConfirmFlyCancle(),"combo"===this.currentMode?(this.reselect(0),this.reselect(1)):this.reselect(this.currentLeg),this.checkShareFlight())})}else this._modal.open(b.u9,{ticketsSelected:this.listTicketSelected,totalPrice:this.totalPrice,totalPriceCombo:this.totalPriceCombo,enabledBooking:[k.or.CanBookingFlightTicket,k.or.CanIssuedFlightTicket].some(i=>this._permissionService.hasPermission(i)),showSharedFlight:this.showSharedFlight}).afterClosed$.subscribe({next:i=>{"backdropClick"===i.type||0==i.data?(this._eventLogService.captureConfirmFlyCancle(),"combo"===this.currentMode?(this.reselect(0),this.reselect(1)):this.reselect(this.currentLeg),this.checkShareFlight()):(this._ticketSelectedDataProvider.ticketSelectedData=this.listTicketSelected,this._eventLogService.captureConfirmFlyBook(),this._router.navigate(["/admin/passenger-info"]))}});else this.tabChangeIndex(t)}searchFlight(){this._mobileDetectService.collapseSidebarSubject.next(!0),this.startProgressBar();const t=this._dataProvider.searchInputData.promotion.find(n=>"VJ"===n.airline),a=this._dataProvider.searchInputData.promotion.find(n=>"QH"===n.airline),i=this._dataProvider.searchInputData.promotion.find(n=>"VN"===n.airline);this.isSearchRetailEmpty=!1,this.searchFlightLoading=!0,this._searchFlightService.searchFlight({adultCount:this.numberOfPassenger.adult,childCount:this.numberOfPassenger.child,infantCount:this.numberOfPassenger.infant,promoCodeVJ:t?t.code:"",promoCodeQH:a?a.code:"",promoCodeVN:i?i.code:"",flightsRequest:this._dataProvider.searchInputData.journey.map((n,s)=>({airline:n.airline,startPoint:n.startPoint,leg:s,endPoint:n.endPoint,departDate:(0,v.p6)(n.departDate,"yyyy-MM-dd","vi-VN")}))},this._dataProvider.searchInputData.type).pipe((0,U.x)(()=>{this.progress=100,setTimeout(()=>{this.isprogress=!1},1e3),this.searchFlightLoading=!1})).subscribe({next:n=>{var s,c,l,d,u,h;this.searchFlightData=n.data,(n.success&&!(null!==(s=this.searchFlightData)&&void 0!==s&&s.flightOptions.length)||!n.success)&&(this.isSearchRetailEmpty=!0),!(null===(c=this.searchFlightData)||void 0===c)&&c.flightOptions.length||(this.isSearchRetailEmpty=!0),!(null===(l=this.searchFlightData)||void 0===l)&&l.flightOptions.length&&"COMBO"===(null===(d=this.searchFlightData)||void 0===d?void 0:d.flightOptions[0].type)&&(this.currentMode="combo"),this.listFareRule=null===(u=n.data)||void 0===u?void 0:u.fareRules,this.listFareRuleClasses=null===(h=n.data)||void 0===h?void 0:h.fareRuleClasses;try{this.convertAllTicket()}catch(f){console.log(f),this._searchFlightService.sendErrorDataSearch(JSON.stringify(n),f.message+f.stack,this._userService.currentUserSubject.value.data.displayName).subscribe({next:()=>console.log("Send error data success"),error(_){console.log("Send error data fail")}})}this.loadTicketDisplay(),"combo"===this.currentMode?this.initComboFilter():this.initFilterAirline(),this.checkQHPromotionError(),this.loadTicketFilter(),this.loadComboTicketFilter(),this.initTicketExpireTimer()},error:()=>{this.isSearchRetailEmpty=!0}})}syncDelayPoint(t){for(let a=0;a<t.length-1;a++)t[a+1].delay=t[a].delay,t[a].delay=0;return t}convertAllTicket(){if(this.searchFlightData)if("combo"!==this.currentMode){let t=0;this.listTicket=this.searchFlightData.flightOptions.flatMap(a=>a.journeys.flatMap(i=>{if(!i.fareOptions)return[];"VN"===i.airline&&(i.segments=this.syncDelayPoint(i.segments));const n=i.fareOptions.map(l=>{var d,u,h,f;t++;const _=this.getFareRuleClass(i.airline,l.fareInfos[0].fareClass,null===(d=l.fareInfos[0].fareType)||void 0===d?void 0:d.code);return{indexForTracking:t,provider:a.provider,airline:i.airline,airlineLogo:this._flightDataService.getAirlineLogoByCode(i.airline),mobileAirlineLogo:["VJ","VN","QH"].includes(i.airline)?"assets/airline-logo/"+i.airline+"_small.png":"assets/airline-logo/"+i.airline+".png",airlineName:i.airlineName,flightNumber:`${i.airline} ${i.segments[0].flightNumber}`,operating:i.operating,operatingName:i.operatingName,stopStatus:i.numOfStops,duration:i.duration,durationStr:i.getDurationString(),startPoint:i.departure.airport.code,endPoint:i.arrival.airport.code,startTime:p(i.departure.localTime).toDate(),endTime:p(i.arrival.localTime).toDate(),expireTime:i.expireTime,totalPrice:l.getTotalAmount(),netPrice:l.getNetAmount(this.numberOfPassenger.adult,this.numberOfPassenger.child),serviceFee:l.getServiceFee(),promotionalPrice:0!==l.getDiscount()?l.getTotalAmount()+l.getDiscount():void 0,currency:l.currency?l.currency.code:"VN\u0110",fareClass:l.fareInfos[0].fareClass,fareType:null===(u=l.fareInfos[0].fareType)||void 0===u?void 0:u.code,journeyFareClass:l.journeyFareClass,handBag:_.handBag,checkedBag:_.checkedBag,seatRemain:l.fareInfos[0].seatRemain,cabin:null===(h=l.fareInfos[0].cabin)||void 0===h?void 0:h.description,cabinName:(null===(f=l.fareInfos[0].cabin)||void 0===f?void 0:f.name)||"undefined",isLowestFare:!1,isLowestFareAvailable:!1,leg:i.leg,departure:{scheduleTime:p(1e3*i.departure.scheduleTime).toDate(),airport:i.departure.airport.code,localTime:p(i.departure.localTime).toDate()},arrival:{scheduleTime:p(1e3*i.arrival.scheduleTime).toDate(),airport:i.arrival.airport.code,localTime:p(i.arrival.localTime).toDate()},journeyKey:i.key,fareOptionKey:l.key,segments:i.segments.map((T,x)=>{var F;const N=T.getDelayString();return{segmentKey:T.key,fareClass:l.fareInfos[x].fareClass,fareType:(null===(F=l.fareInfos[x].fareType)||void 0===F?void 0:F.description)||"",airline:T.airline,airlineName:T.airlineName,mobileAirlineLogo:["VJ","VN","QH"].includes(T.airline)?"assets/airline-logo/"+T.airline+"_small.png":"assets/airline-logo/"+T.airline+".png",operating:T.operating,operatingName:T.operatingName,airlineLogo:this._flightDataService.getAirlineLogoByCode(T.operating),jetCode:"N/A",startCode:T.departure.airport.code,endCode:T.arrival.airport.code,startPoint:this._locationDataService.getCityNameByCode(T.departure.airport.code),endPoint:this._locationDataService.getCityNameByCode(T.arrival.airport.code),departDate:p(T.departure.localTime).toDate(),arrivalDate:p(T.arrival.localTime).toDate(),flightNumber:T.flightNumber,duration:T.getDurationString(),modelAirplane:T.modelAirplane,modelAirplaneName:T.modelAirplaneName,delay:T.getDelayString(),stopPoint:N?`D\u1eebng t\u1ea1i: ${this._locationDataService.getAirportNameByCode(T.departure.airport.code)} (${T.departure.airport.code}). Th\u1eddi gian d\u1eebng: ${N}`:""}}),showSalePrice:this.ticketDisplayState.value.showSalePrice,showNetPrice:this.ticketDisplayState.value.showNetPrice,hideFareClass:this.ticketDisplayState.value.hideFareClass,showDuration:this.ticketDisplayState.value.showDuration,ticketDetail:this.getTicketDetail(l,i.airline)}}),s=Ye.groupBy(n,"cabinName");for(const l of Object.keys(s)){const u=Math.min(...s[l].map(h=>h.totalPrice));n.filter(h=>h.cabinName===l).forEach(h=>{h.isLowestFare=h.totalPrice===u})}const c=Math.min(...n.filter(l=>l.seatRemain).map(l=>l.totalPrice));return n.forEach(l=>{l.isLowestFareAvailable=l.totalPrice===c}),n})).sort((a,i)=>a.totalPrice-i.totalPrice).sort((a,i)=>a.stopStatus-i.stopStatus),this.listTicketAgent=this.searchFlightData.flightOptions.filter(a=>!["GDS"].includes(a.provider)).flatMap((a,i)=>this.convertAgentTicket(a,i)).sort((a,i)=>a.numOfStop-i.numOfStop)}else this.listTicketCombo=this.searchFlightData.flightOptions.filter(t=>t.comboInfo.arriveJourneys[0].fareOptions).map((t,a)=>this.convertComboTicket(t,a))}convertComboTicket(t,a){if("GDS"===t.provider)return{indexForTracking:a,provider:t.provider,showTotalPrice:this.ticketDisplayState.value.showTotalComboPrice,departOptions:t.comboInfo.departJourneys.map((i,n)=>({selected:0===n,airline:i.airline,airlineLogo:this._flightDataService.getAirlineLogoByCode(i.airline),operating:i.operating,operatingName:i.operatingName,mobileAirlineLogo:["VJ","VN","QH"].includes(i.airline)?"assets/airline-logo/"+i.airline+"_small.png":"assets/airline-logo/"+i.airline+".png",airlineName:i.airlineName,departureDate:p(i.departure.localTime).toDate(),returnDate:p(i.arrival.localTime).toDate(),durationStr:i.getDurationString(),duration:i.duration,startPoint:i.departure.airport.code,startPointName:this._locationDataService.getCityNameByCode(i.departure.airport.code),endPointName:this._locationDataService.getCityNameByCode(i.arrival.airport.code),endPoint:i.arrival.airport.code,expireTime:i.expireTime,flightNumber:`${i.airline} ${i.segments[0].flightNumber}`,totalPrice:i.fareOptions[0].getTotalAmount(),totalAllPaxPrice:i.fareOptions[0].getTotalAmountAllPax(this.numberOfPassenger.adult,this.numberOfPassenger.child),stops:i.getStopList().map(s=>Object.assign(Object.assign({},s),{country:this._locationDataService.getCityNameByCode(s.airport)})),numOfStop:i.numOfStops,stopOvernight:i.stopOvernight,returnDateTooltip:"H\u1ea1 c\xe1nh ng\xe0y "+(0,v.p6)(new Date(i.arrival.localTime),"dd/MM/yyyy","vi-VN"),ticketPrice:this.getTicketDetail(i.fareOptions[0],i.airline),provider:t.provider,fareOptionKey:i.fareOptions[0].key,journeyKey:i.key,comboRefs:[],segments:i.segments.map((s,c)=>{const l=s.getDelayString();return{airline:s.airline,airlineSystem:s.airline,airlineName:s.airlineName,airlineLogo:this._flightDataService.getAirlineLogoByCode(s.airline),operating:s.operating,operatingName:s.operatingName,mobileAirlineLogo:["VJ","VN","QH"].includes(s.airline)?"assets/airline-logo/"+s.airline+"_small.png":"assets/airline-logo/"+s.airline+".png",flightNumber:`${s.flightNumber}`,startDate:p(s.departure.localTime).toDate(),startPoint:s.departure.airport.code,startPointName:this._locationDataService.getCityNameByCode(s.departure.airport.code),endDate:p(s.arrival.localTime).toDate(),endPoint:s.arrival.airport.code,endPointName:this._locationDataService.getCityNameByCode(s.arrival.airport.code),rules:[],modelAirplane:s.modelAirplane,modelAirplaneName:s.modelAirplaneName,key:s.key,durationStr:s.getDurationString(),stopPoint:l?`D\u1eebng t\u1ea1i: ${this._locationDataService.getAirportNameByCode(s.departure.airport.code)} (${s.departure.airport.code}). Th\u1eddi gian d\u1eebng: ${l}`:"",fareClass:i.fareOptions[0].fareInfos[c].fareClass}})})),arriveOptions:t.comboInfo.arriveJourneys.map((i,n)=>({selected:0===n,airline:i.airline,airlineLogo:this._flightDataService.getAirlineLogoByCode(i.airline),operating:i.operating,operatingName:i.operatingName,mobileAirlineLogo:["VJ","VN","QH"].includes(i.airline)?"assets/airline-logo/"+i.airline+"_small.png":"assets/airline-logo/"+i.airline+".png",airlineName:i.airlineName,departureDate:p(i.departure.localTime).toDate(),returnDate:p(i.arrival.localTime).toDate(),durationStr:i.getDurationString(),duration:i.duration,startPoint:i.departure.airport.code,startPointName:this._locationDataService.getCityNameByCode(i.departure.airport.code),endPointName:this._locationDataService.getCityNameByCode(i.arrival.airport.code),endPoint:i.arrival.airport.code,expireTime:i.expireTime,flightNumber:`${i.airline} ${i.segments[0].flightNumber}`,totalPrice:0,totalAllPaxPrice:0,stops:i.getStopList().map(s=>Object.assign(Object.assign({},s),{country:this._locationDataService.getCityNameByCode(s.airport)})),numOfStop:i.numOfStops,stopOvernight:i.stopOvernight,returnDateTooltip:"H\u1ea1 c\xe1nh ng\xe0y "+(0,v.p6)(new Date(i.arrival.localTime),"dd/MM/yyyy","vi-VN"),ticketPrice:this.getTicketDetail(new _e.YY,i.airline),provider:t.provider,fareOptionKey:i.fareOptions[0].key,journeyKey:i.key,comboRefs:[],segments:i.segments.map((s,c)=>{const l=s.getDelayString();return{airline:s.airline,airlineSystem:s.airline,airlineName:s.airlineName,airlineLogo:this._flightDataService.getAirlineLogoByCode(s.airline),operating:s.operating,operatingName:s.operatingName,mobileAirlineLogo:["VJ","VN","QH"].includes(s.airline)?"assets/airline-logo/"+s.airline+"_small.png":"assets/airline-logo/"+s.airline+".png",flightNumber:`${s.flightNumber}`,startDate:p(s.departure.localTime).toDate(),startPoint:s.departure.airport.code,startPointName:this._locationDataService.getCityNameByCode(s.departure.airport.code),endDate:p(s.arrival.localTime).toDate(),endPoint:s.arrival.airport.code,endPointName:this._locationDataService.getCityNameByCode(s.arrival.airport.code),rules:[],modelAirplane:s.modelAirplane,modelAirplaneName:s.modelAirplaneName,key:s.key,durationStr:s.getDurationString(),stopPoint:l?`D\u1eebng t\u1ea1i: ${this._locationDataService.getAirportNameByCode(s.departure.airport.code)} (${s.departure.airport.code}). Th\u1eddi gian d\u1eebng: ${l}`:"",fareClass:i.fareOptions[0].fareInfos[c].fareClass}}),verifyState:"UNCHECKED"})),score:t.comboInfo.score,bestChoice:t.comboInfo.bestChoice,fastest:t.comboInfo.fastest,cheapest:t.comboInfo.cheapest,soldOut:!1};{const i=t.comboInfo.departJourneys[0].fareOptions.every(s=>!s.fareInfos[0].seatRemain)||t.comboInfo.arriveJourneys[0].fareOptions.every(s=>!s.fareInfos[0].seatRemain),n=t.comboInfo.departJourneys[0].fareOptions.some(s=>s.comboRefs);return"VN"===t.comboInfo.departJourneys[0].airline&&(t.comboInfo.departJourneys[0].segments=this.syncDelayPoint(t.comboInfo.departJourneys[0].segments)),"VN"===t.comboInfo.arriveJourneys[0].airline&&(t.comboInfo.arriveJourneys[0].segments=this.syncDelayPoint(t.comboInfo.arriveJourneys[0].segments)),{indexForTracking:"VN"!==t.provider||n?a:-1,provider:t.provider,showTotalPrice:this.ticketDisplayState.value.showTotalComboPrice,departOptions:t.comboInfo.departJourneys[0].fareOptions.map((s,c)=>({selected:0===c,airline:t.comboInfo.departJourneys[0].airline,airlineLogo:this._flightDataService.getAirlineLogoByCode(t.comboInfo.departJourneys[0].airline),operating:t.comboInfo.departJourneys[0].operating,operatingName:t.comboInfo.departJourneys[0].operatingName,mobileAirlineLogo:["VJ","VN","QH"].includes(t.comboInfo.departJourneys[0].airline)?"assets/airline-logo/"+t.comboInfo.departJourneys[0].airline+"_small.png":"assets/airline-logo/"+t.comboInfo.departJourneys[0].airline+".png",airlineName:t.comboInfo.departJourneys[0].airlineName,departureDate:p(t.comboInfo.departJourneys[0].departure.localTime).toDate(),returnDate:p(t.comboInfo.departJourneys[0].arrival.localTime).toDate(),durationStr:t.comboInfo.departJourneys[0].getDurationString(),duration:t.comboInfo.departJourneys[0].duration,startPoint:t.comboInfo.departJourneys[0].departure.airport.code,startPointName:this._locationDataService.getCityNameByCode(t.comboInfo.departJourneys[0].departure.airport.code),endPointName:this._locationDataService.getCityNameByCode(t.comboInfo.departJourneys[0].arrival.airport.code),endPoint:t.comboInfo.departJourneys[0].arrival.airport.code,expireTime:t.comboInfo.departJourneys[0].expireTime,flightNumber:`${t.comboInfo.departJourneys[0].airline} ${t.comboInfo.departJourneys[0].segments[0].flightNumber}`,totalPrice:s.getTotalAmount(),totalAllPaxPrice:s.getTotalAmountAllPax(this.numberOfPassenger.adult,this.numberOfPassenger.child),stops:t.comboInfo.departJourneys[0].getStopList().map(l=>Object.assign(Object.assign({},l),{country:this._locationDataService.getCityNameByCode(l.airport)})),numOfStop:t.comboInfo.departJourneys[0].numOfStops,stopOvernight:t.comboInfo.departJourneys[0].stopOvernight,fareClass:s.fareInfos[0].fareClass,fareType:s.fareInfos[0].fareType.code,seatRemain:s.fareInfos[0].seatRemain,cabin:s.fareInfos[0].fareType.description,returnDateTooltip:"H\u1ea1 c\xe1nh ng\xe0y "+(0,v.p6)(new Date(t.comboInfo.departJourneys[0].arrival.localTime),"dd/MM/yyyy","vi-VN"),ticketPrice:this.getTicketDetail(s,t.comboInfo.departJourneys[0].airline),provider:t.provider,fareOptionKey:s.key,journeyKey:t.comboInfo.departJourneys[0].key,comboRefKey:s.comboRefKey,comboRefs:t.comboInfo.arriveJourneys[0].fareOptions.map(l=>{var d;const u=null===(d=s.comboRefs)||void 0===d?void 0:d.find(h=>h.key[0]===l.key);return{key:l.key,sessionId:u?u.sessionId:"",verifyState:u&&u.sessionId?"CHECKED":"UNCHECKED",totalPriceCombo:u?u.getTotalAmount():0,totalAllPaxPriceCombo:u?u.getTotalAmountAllPax(this.numberOfPassenger.adult,this.numberOfPassenger.child):0,ticketPrice:u?this.getTicketDetail(u,t.comboInfo.departJourneys[0].airline):null}}),segments:t.comboInfo.departJourneys[0].segments.map((l,d)=>{const u=l.getDelayString();return{airline:l.airline,airlineSystem:l.airline,airlineName:l.airlineName,airlineLogo:this._flightDataService.getAirlineLogoByCode(l.airline),operating:l.operating,operatingName:l.operatingName,mobileAirlineLogo:["VJ","VN","QH"].includes(l.airline)?"assets/airline-logo/"+l.airline+"_small.png":"assets/airline-logo/"+l.airline+".png",flightNumber:`${l.flightNumber}`,startDate:p(l.departure.localTime).toDate(),startPoint:l.departure.airport.code,startPointName:this._locationDataService.getCityNameByCode(l.departure.airport.code),endDate:p(l.arrival.localTime).toDate(),endPoint:l.arrival.airport.code,endPointName:this._locationDataService.getCityNameByCode(l.arrival.airport.code),rules:[],modelAirplane:l.modelAirplane,modelAirplaneName:l.modelAirplaneName,key:l.key,durationStr:l.getDurationString(),stopPoint:u?`D\u1eebng t\u1ea1i: ${this._locationDataService.getAirportNameByCode(l.departure.airport.code)} (${l.departure.airport.code}). Th\u1eddi gian d\u1eebng: ${u}`:"",fareClass:s.fareInfos[d].fareClass}})})),arriveOptions:t.comboInfo.arriveJourneys[0].fareOptions.map((s,c)=>({selected:0===c,airline:t.comboInfo.arriveJourneys[0].airline,airlineLogo:this._flightDataService.getAirlineLogoByCode(t.comboInfo.arriveJourneys[0].airline),operating:t.comboInfo.arriveJourneys[0].operating,operatingName:t.comboInfo.arriveJourneys[0].operatingName,mobileAirlineLogo:["VJ","VN","QH"].includes(t.comboInfo.arriveJourneys[0].airline)?"assets/airline-logo/"+t.comboInfo.arriveJourneys[0].airline+"_small.png":"assets/airline-logo/"+t.comboInfo.arriveJourneys[0].airline+".png",airlineName:t.comboInfo.arriveJourneys[0].airlineName,departureDate:p(t.comboInfo.arriveJourneys[0].departure.localTime).toDate(),returnDate:p(t.comboInfo.arriveJourneys[0].arrival.localTime).toDate(),durationStr:t.comboInfo.arriveJourneys[0].getDurationString(),duration:t.comboInfo.arriveJourneys[0].duration,startPoint:t.comboInfo.arriveJourneys[0].departure.airport.code,startPointName:this._locationDataService.getCityNameByCode(t.comboInfo.arriveJourneys[0].departure.airport.code),endPointName:this._locationDataService.getCityNameByCode(t.comboInfo.arriveJourneys[0].arrival.airport.code),endPoint:t.comboInfo.arriveJourneys[0].arrival.airport.code,expireTime:t.comboInfo.arriveJourneys[0].expireTime,flightNumber:`${t.comboInfo.arriveJourneys[0].airline} ${t.comboInfo.arriveJourneys[0].segments[0].flightNumber}`,totalPrice:s.getTotalAmount(),totalAllPaxPrice:s.getTotalAmountAllPax(this.numberOfPassenger.adult,this.numberOfPassenger.child),stops:t.comboInfo.arriveJourneys[0].getStopList().map(l=>Object.assign(Object.assign({},l),{country:this._locationDataService.getCityNameByCode(l.airport)})),numOfStop:t.comboInfo.arriveJourneys[0].numOfStops,stopOvernight:t.comboInfo.arriveJourneys[0].stopOvernight,fareClass:s.fareInfos[0].fareClass,fareType:s.fareInfos[0].fareType.code,seatRemain:s.fareInfos[0].seatRemain,cabin:s.fareInfos[0].fareType.description,returnDateTooltip:"H\u1ea1 c\xe1nh ng\xe0y "+(0,v.p6)(new Date(t.comboInfo.arriveJourneys[0].arrival.localTime),"dd/MM/yyyy","vi-VN"),ticketPrice:this.getTicketDetail(s,t.comboInfo.arriveJourneys[0].airline),provider:t.provider,fareOptionKey:s.key,journeyKey:t.comboInfo.arriveJourneys[0].key,comboRefKey:s.comboRefKey,comboRefs:[],segments:t.comboInfo.arriveJourneys[0].segments.map((l,d)=>{const u=l.getDelayString();return{airline:l.airline,airlineSystem:l.airline,airlineName:l.airlineName,airlineLogo:this._flightDataService.getAirlineLogoByCode(l.airline),operating:l.operating,operatingName:l.operatingName,mobileAirlineLogo:["VJ","VN","QH"].includes(l.airline)?"assets/airline-logo/"+l.airline+"_small.png":"assets/airline-logo/"+l.airline+".png",flightNumber:`${l.flightNumber}`,startDate:p(l.departure.localTime).toDate(),startPoint:l.departure.airport.code,startPointName:this._locationDataService.getCityNameByCode(l.departure.airport.code),endDate:p(l.arrival.localTime).toDate(),endPoint:l.arrival.airport.code,endPointName:this._locationDataService.getCityNameByCode(l.arrival.airport.code),rules:[],modelAirplane:l.modelAirplane,modelAirplaneName:l.modelAirplaneName,key:l.key,durationStr:l.getDurationString(),stopPoint:u?`D\u1eebng t\u1ea1i: ${this._locationDataService.getAirportNameByCode(l.departure.airport.code)} (${l.departure.airport.code}). Th\u1eddi gian d\u1eebng: ${u}`:"",fareClass:s.fareInfos[d].fareClass}})})),score:t.comboInfo.score,bestChoice:t.comboInfo.bestChoice,fastest:t.comboInfo.fastest,cheapest:t.comboInfo.cheapest,soldOut:i}}}convertAgentTicket(t,a,i=""){return t.journeys.flatMap((n,s)=>("VN"===n.airline&&(n.segments=this.syncDelayPoint(n.segments)),{indexForTracking:`${i}_${a}_${s}`,provider:t.provider,airline:n.airline,airlineName:this._flightDataService.getAirlineNameByCode(n.airline),airlineLogo:this._flightDataService.getAirlineLogoByCode(n.airline),mobileAirlineLogo:["VJ","VN","QH"].includes(n.airline)?"assets/airline-logo/"+n.airline+"_small.png":"assets/airline-logo/"+n.airline+".png",operating:n.operating,operatingName:n.operatingName,flightNumber:`${n.airline} ${n.segments[0].flightNumber}`,departure:{scheduleTime:p(1e3*n.departure.scheduleTime).toDate(),airport:n.departure.airport.code,localTime:p(n.departure.localTime).toDate()},arrival:{scheduleTime:p(1e3*n.arrival.scheduleTime).toDate(),airport:n.arrival.airport.code,localTime:p(n.arrival.localTime).toDate()},startPoint:n.departure.airport.code,endPoint:n.arrival.airport.code,duration:n.duration,expireTime:n.expireTime,durationStr:n.getDurationString(),numOfStop:n.numOfStops,numberOfSegment:n.segments.length,leg:n.leg,journeyKey:n.key,lookupSeatReamin:"VN"===n.airline,fareRule:this.listFareRule.find(c=>c.airline===n.airline)||null,segmentDetails:n.segments.map((c,l,d)=>{const u=c.getDelayString();return{segmentKey:c.key,airline:c.airline,airlineName:this._flightDataService.getAirlineNameByCode(c.airline),airlineLogo:this._flightDataService.getAirlineLogoByCode(n.airline),mobileAirlineLogo:["VJ","VN","QH"].includes(c.airline)?"assets/airline-logo/"+c.airline+"_small.png":"assets/airline-logo/"+c.airline+".png",jetCode:"N/A",startCode:c.departure.airport.code,endCode:c.arrival.airport.code,startPoint:this._locationDataService.getCityNameByCode(c.departure.airport.code),endPoint:this._locationDataService.getCityNameByCode(c.arrival.airport.code),departDate:p(c.departure.localTime).toDate(),arrivalDate:p(c.arrival.localTime).toDate(),flightNumber:c.flightNumber,duration:c.duration,durationStr:c.getDurationString(),modelAirplane:c.modelAirplane,modelAirplaneName:c.modelAirplaneName,operating:c.operating,operatingName:c.operatingName,stopPoint:u?`D\u1eebng t\u1ea1i: ${this._locationDataService.getAirportNameByCode(c.departure.airport.code)} (${c.departure.airport.code}). Th\u1eddi gian d\u1eebng: ${u}`:""}}),segmentsDisplay:["VJ","QH","VU"].includes(n.airline)?[{airline:n.airline,airlineLogo:this._flightDataService.getAirlineLogoByCode(n.airline),flightNumber:`${n.airline} ${n.segments[0].flightNumber}`,jetCode:"N/A",operating:n.operating,startPoint:n.departure.airport.code,endPoint:n.arrival.airport.code,segmentKey:void 0,fareClasses:n.fareOptions.map(c=>({totalPrice:c.getTotalAmount(),isExistPrice:!0,currency:c.currency?c.currency.code:"VN\u0110",segmentIndex:0,fareType:c.fareInfos[0].fareType.description,seatRemain:c.fareInfos[0].seatRemain,fareClass:c.fareInfos[0].fareClass,isSelected:!1,fareOptionKey:c.key,ticketPriceDetail:this.getTicketDetail(c,n.airline)})),departure:{scheduleTime:p(1e3*n.departure.scheduleTime).toDate(),airport:n.departure.airport.code,localTime:p(n.departure.localTime).toDate()},arrival:{scheduleTime:p(1e3*n.arrival.scheduleTime).toDate(),airport:n.arrival.airport.code,localTime:p(n.arrival.localTime).toDate()}}]:n.segments.map(c=>{var l;return{airline:c.airline,airlineLogo:this._flightDataService.getAirlineLogoByCode(c.airline),flightNumber:`${c.airline} ${c.flightNumber}`,jetCode:"N/A",operating:c.operating,startPoint:c.departure.airport.code,endPoint:c.arrival.airport.code,segmentKey:c.key,fareClasses:(null===(l=c.bookingClassArr)||void 0===l?void 0:l.reverse().map(d=>{const u=n.fareOptions&&n.fareOptions.length?n.fareOptions.find(h=>{var f;return(null===(f=h.fareInfos[0])||void 0===f?void 0:f.fareClass)===d.fareClass}):null;return{totalPrice:n.fareOptions&&-1!=n.fareOptions.findIndex(h=>h.fareInfos[0].fareClass===d.fareClass)?n.fareOptions.find(h=>h.fareInfos[0].fareClass===d.fareClass).getTotalAmount():0,isExistPrice:!(!n.fareOptions||-1==n.fareOptions.findIndex(h=>h.fareInfos[0].fareClass===d.fareClass)),currency:n.fareOptions?n.fareOptions[0].currency.code:"VN\u0110",fareType:"",segmentIndex:c.index,seatRemain:d.available,fareClass:d.fareClass,isSelected:!1,fareOptionKey:u?u.key:"",ticketPriceDetail:u?this.getTicketDetail(u,n.airline):void 0}}))||[],departure:{scheduleTime:p(1e3*c.departure.scheduleTime).toDate(),airport:c.departure.airport.code,localTime:p(c.departure.localTime).toDate()},arrival:{scheduleTime:p(1e3*c.arrival.scheduleTime).toDate(),airport:c.arrival.airport.code,localTime:p(c.arrival.localTime).toDate()}}})}))}ticketTrackByFn(t,a){return a.indexForTracking}getRandomInt(t,a){return Math.floor(Math.random()*(a-t+1)+t)}loadTicketDisplay(){this.loadClientTicketDisplay(),this.loadAgentTicketDisplay(),this.loadComboTicketDisplay()}loadClientTicketDisplay(){this.listTicketDisplay=(this.listTicketDisplay?this.listTicketDisplay:this.listTicket).filter(t=>t.leg===this.currentLeg).map(t=>Object.assign(Object.assign({},t),{showSalePrice:this.ticketDisplayState.value.showSalePrice,showNetPrice:this.ticketDisplayState.value.showNetPrice,hideFareClass:this.ticketDisplayState.value.hideFareClass,showDuration:this.ticketDisplayState.value.showDuration})),this.processSort()}loadAgentTicketDisplay(){this.listTicketAgentDisplay=this.listTicketAgent}loadComboTicketDisplay(){this.listTicketComboDisplay=(this.listTicketComboDisplay?this.listTicketComboDisplay:this.listTicketCombo).map(t=>Object.assign(Object.assign({},t),{showTotalPrice:this.ticketDisplayState.value.showTotalComboPrice})),this.loadTabDataCombo(),this.processSortCombo()}loadTabDataCombo(){if(0===this.listTicketCombo.length)return;const t=this.listTicketCombo.sort((n,s)=>n.departOptions[0].duration+n.arriveOptions[0].duration-(s.departOptions[0].duration+s.arriveOptions[0].duration))[0];this.tabComboDetail.fastest.price=t.departOptions[0].totalPrice+t.arriveOptions[0].totalPrice,this.tabComboDetail.fastest.durationStr=t.departOptions[0].durationStr;const a=this.listTicketCombo.sort((n,s)=>n.departOptions[0].totalPrice+n.arriveOptions[0].totalPrice-(s.departOptions[0].totalPrice+s.arriveOptions[0].totalPrice))[0];this.tabComboDetail.cheapest.price=a.departOptions[0].totalPrice+a.arriveOptions[0].totalPrice,this.tabComboDetail.cheapest.durationStr=a.departOptions[0].durationStr;const i=this.listTicketCombo.sort((n,s)=>s.score-n.score)[0];this.tabComboDetail.best.price=i.departOptions[0].totalPrice+i.arriveOptions[0].totalPrice,this.tabComboDetail.best.durationStr=i.departOptions[0].durationStr}loadTicketFilter(){this.listTicketDisplay=this.listTicket.filter(t=>t.leg===this.currentLeg).filter(t=>0===this.ticketFilterState.value.showAirline.length||this.ticketFilterState.value.showAirline.includes(t.airline)).filter(t=>!!(!this.ticketFilterState.value.direct&&!this.ticketFilterState.value.oneRoute&&!this.ticketFilterState.value.moreRoute||this.ticketFilterState.value.direct&&0===t.stopStatus||this.ticketFilterState.value.oneRoute&&1===t.stopStatus||this.ticketFilterState.value.moreRoute&&t.stopStatus>1)).filter(t=>{if(0===t.leg){const a=60*t.departure.localTime.getHours()+t.departure.localTime.getMinutes();if(a<this.ticketFilterState.value.comboTime.departStartTime.from||a>this.ticketFilterState.value.comboTime.departStartTime.to)return!1;const i=60*t.arrival.localTime.getHours()+t.arrival.localTime.getMinutes();if(i<this.ticketFilterState.value.comboTime.departEndTime.from||i>this.ticketFilterState.value.comboTime.departEndTime.to)return!1}if(1===t.leg){const a=60*t.departure.localTime.getHours()+t.departure.localTime.getMinutes(),i=60*t.arrival.localTime.getHours()+t.arrival.localTime.getMinutes();if(a<this.ticketFilterState.value.comboTime.arriveStartTime.from||a>this.ticketFilterState.value.comboTime.arriveStartTime.to||i<this.ticketFilterState.value.comboTime.arriveEndTime.from||i>this.ticketFilterState.value.comboTime.arriveEndTime.to)return!1}return!0}).filter(t=>{var a,i;return this.ticketFilterState.value.fareclass.length>0&&"GDS"!==t.provider?this.ticketFilterState.value.fareclass.indexOf(null===(a=t.cabinName)||void 0===a?void 0:a.toUpperCase())>=0&&t.isLowestFare:null!==(i=this.ticketFilterState.value.fareclass)&&void 0!==i&&i.length||"GDS"===t.provider?t.isLowestFare:t.isLowestFareAvailable}).filter(t=>!(this.ticketFilterState.value.plane.length>0)||t.segments.map(a=>this.ticketFilterState.value.plane.indexOf(a.modelAirplane.toUpperCase())>=0).reduce((a,i)=>a||i,!1)).filter(t=>!(this.ticketFilterState.value.bookingSystem.length>0)||this.ticketFilterState.value.bookingSystem.map(a=>"GDS"===a?a===t.provider:"DOMESTIC"===a&&("VN"===t.provider||"VJ"===t.provider||"QH"===t.provider)).reduce((a,i)=>a||i,!1)).map(t=>Object.assign(Object.assign({},t),{showSalePrice:this.ticketDisplayState.value.showSalePrice,showNetPrice:this.ticketDisplayState.value.showNetPrice,hideFareClass:this.ticketDisplayState.value.hideFareClass,showDuration:this.ticketDisplayState.value.showDuration})),this.listTicketAgentDisplay=this.listTicketAgent.filter(t=>t.leg===this.currentLeg).filter(t=>{const a=this.airlineList.map(i=>i.code.toLocaleLowerCase());return 0===a.length||a.includes(t.airline.toLowerCase())}).filter(t=>0===this.ticketFilterState.value.showAirline.length||this.ticketFilterState.value.showAirline.includes(t.airline)).filter(t=>!!(!this.ticketFilterState.value.direct&&!this.ticketFilterState.value.oneRoute&&!this.ticketFilterState.value.moreRoute||this.ticketFilterState.value.direct&&0===t.numOfStop||this.ticketFilterState.value.oneRoute&&1===t.numOfStop||this.ticketFilterState.value.moreRoute&&t.numOfStop>1)).filter(t=>{if(0===t.leg){const a=60*t.departure.localTime.getHours()+t.departure.localTime.getMinutes();if(a<this.ticketFilterState.value.comboTime.departStartTime.from||a>this.ticketFilterState.value.comboTime.departStartTime.to)return!1;const i=60*t.arrival.localTime.getHours()+t.arrival.localTime.getMinutes();if(i<this.ticketFilterState.value.comboTime.departEndTime.from||i>this.ticketFilterState.value.comboTime.departEndTime.to)return!1}if(1===t.leg){const a=60*t.departure.localTime.getHours()+t.departure.localTime.getMinutes(),i=60*t.arrival.localTime.getHours()+t.arrival.localTime.getMinutes();if(a<this.ticketFilterState.value.comboTime.arriveStartTime.from||a>this.ticketFilterState.value.comboTime.arriveStartTime.to||i<this.ticketFilterState.value.comboTime.arriveEndTime.from||i>this.ticketFilterState.value.comboTime.arriveEndTime.to)return!1}return!0}).filter(t=>{if(!this.ticketFilterState.value.plane.length)return!0;const a=t.segmentDetails.map(n=>n.modelAirplane);return!!this.ticketFilterState.value.plane.some(n=>a.includes(n))}),this.listTicketAgentDisplay=[...this.listTicketAgentDisplay],this.processSort(),this.ticketInfiniteScrollCount=this.TICKET_INFINITE_SCROLL_DEFAULT}loadComboTicketFilter(){this.listTicketComboDisplay=this.listTicketCombo.filter(t=>0===this.ticketFilterState.value.showAirline.length||this.ticketFilterState.value.showAirline.includes(t.departOptions[0].airline)||this.ticketFilterState.value.showAirline.includes(t.arriveOptions[0].airline)).filter(t=>!!(!this.ticketFilterState.value.direct&&!this.ticketFilterState.value.oneRoute&&!this.ticketFilterState.value.moreRoute||this.ticketFilterState.value.direct&&0===t.departOptions[0].numOfStop&&0===t.arriveOptions[0].numOfStop||this.ticketFilterState.value.oneRoute&&1===t.departOptions[0].numOfStop&&1===t.arriveOptions[0].numOfStop||this.ticketFilterState.value.moreRoute&&t.departOptions[0].numOfStop>1&&t.arriveOptions[0].numOfStop>1)).filter(t=>{const a=60*t.departOptions[0].departureDate.getHours()+t.departOptions[0].departureDate.getMinutes(),i=60*t.arriveOptions[0].departureDate.getHours()+t.arriveOptions[0].departureDate.getMinutes(),n=60*t.departOptions[0].returnDate.getHours()+t.departOptions[0].returnDate.getMinutes(),s=60*t.arriveOptions[0].returnDate.getHours()+t.arriveOptions[0].returnDate.getMinutes();return!(a<this.ticketFilterState.value.comboTime.departStartTime.from||a>this.ticketFilterState.value.comboTime.departStartTime.to||i<this.ticketFilterState.value.comboTime.arriveStartTime.from||i>this.ticketFilterState.value.comboTime.arriveStartTime.to||n<this.ticketFilterState.value.comboTime.departEndTime.from||n>this.ticketFilterState.value.comboTime.departEndTime.to||s<this.ticketFilterState.value.comboTime.arriveEndTime.from||s>this.ticketFilterState.value.comboTime.arriveEndTime.to)}).filter(t=>{const a=t.departOptions[0].duration,i=t.arriveOptions[0].duration,n=60*this.ticketFilterState.value.comboDuration.from,s=60*this.ticketFilterState.value.comboDuration.to;return!(a<n||a>s||i<n||i>s)}).filter(t=>{if(this.ticketFilterState.value.comboPrice.from&&this.ticketFilterState.value.comboPrice.to){const a=t.departOptions[0].totalPrice+t.arriveOptions[0].totalPrice;return a>=this.ticketFilterState.value.comboPrice.from&&a<=this.ticketFilterState.value.comboPrice.to}return!0}),this.listTicketComboDisplay=[...this.listTicketComboDisplay],this.processSortCombo(),this.ticketInfiniteScrollCount=this.TICKET_INFINITE_SCROLL_DEFAULT}bindingTypeSearch(){switch(this._searchInputService.flightType){case"ONE_WAY":this.flightTypeSearch=S.jX.OneWay;break;case"ROUND_TRIP":this.flightTypeSearch=S.jX.RoundTrip;break;case"MULTI_WAY":this.flightTypeSearch=S.jX.MultiWay}}numberOfPassengerChange(t){this._searchInputService.numberOfPassengerChange(t),this._searchInputService.suggestPromotion()}airlineFilterChange(t){this._searchInputService.airlineFilterChange(t)}addMultiRoute(){this._searchInputService.addMultiRoute()}removeRoute(t){this._searchInputService.removeRoute(t)}removeAllDataMultiRoute(){this._searchInputService.removeAllDataMultiRoute()}flightTypeChange(t){switch(this.flightTypeSearch=t,t){case S.jX.OneWay:this._searchInputService.flightTypeChange("ONE_WAY");break;case S.jX.RoundTrip:this._searchInputService.flightTypeChange("ROUND_TRIP");break;case S.jX.MultiWay:this._searchInputService.flightTypeChange("MULTI_WAY")}}researchFlight(){let t;this.progress=1,this.totalPrice=0,t=this.flightTypeSearch===S.jX.OneWay?"ONE_WAY":this.flightTypeSearch===S.jX.RoundTrip?"ROUND_TRIP":"MULTI_WAY",this._searchInputService.prepareRequestFlight(t)&&(this.ticketInfiniteScrollCount=this.TICKET_INFINITE_SCROLL_DEFAULT,this.airlineList=[],this.bookingSystemList=[],this.isFirstTake=!0,this.tabData=[],this.modeChange("retail"),this.bindingTypeSearch(),this.loadNumberOfPassenger(),this.onResetFilter(),this.searchFlight(),this.loadTabData(),this.loadTicketSelectedData(),this.resetOptionFilters(),this.checkShareFlight())}onQuotation(t){let a=this.tabData[this.currentLeg];a=Object.assign(Object.assign({},a),{startPoint:a.startPoint,startPointName:this._locationDataService.getCityNameByCode(a.startPoint),endPoint:a.endPoint,endPointName:this._locationDataService.getCityNameByCode(a.endPoint)}),this._modal.open(me,{isHiddenNetPrice:this.ticketDisplayState.value.showNetPrice,isHiddenCabin:this.ticketDisplayState.value.hideFareClass,listTicketDisplay:this.listTicketDisplay.filter(i=>i.seatRemain>0),journey:a,currentLeg:t,canEditHeader:this._permissionService.hasPermission(k.or.EditFlightTicketQuoteHeader)})}onMobileQuotation(t){let a=this.tabData[this.currentLeg];a=Object.assign(Object.assign({},a),{startPoint:a.startPoint,startPointName:this._locationDataService.getCityNameByCode(a.startPoint),endPoint:a.endPoint,endPointName:this._locationDataService.getCityNameByCode(a.endPoint)});const i=this._bottomSheetService.open(me,{headerTitle:"Chia s\u1ebb c\xe1c chuy\u1ebfn bay l\u1ef1a ch\u1ecdn",leftButtonIcon:"close",leftButtonIconClass:"text-neutral-gray-4",rightButtonIcon:"",containerFullHeigh:!0,data:{isHiddenNetPrice:this.ticketDisplayState.value.showNetPrice,isHiddenCabin:this.ticketDisplayState.value.hideFareClass,listTicketDisplay:this.listTicketDisplay.filter(n=>n.seatRemain>0),journey:a,currentLeg:t,canEditHeader:this._permissionService.hasPermission(k.or.EditFlightTicketQuoteHeader)}});i.containerInstance._leftButtonClick.subscribe(n=>i.dismiss())}getTicketDetail(t,a){const i=[];if(this.numberOfPassenger.adult){const s={type:"Ng\u01b0\u1eddi l\u1edbn (ADT)",quantity:this.numberOfPassenger.adult,baseFare:t.getBaseFare("ADULT",a),surCharge:t.getSurCharge("ADULT",a),totalFare:t.getTotalAmountByType("ADULT")*this.numberOfPassenger.adult};i.push(s)}if(this.numberOfPassenger.child){const s={type:"Tr\u1ebb em (CHD)",quantity:this.numberOfPassenger.child,baseFare:t.getBaseFare("CHILD",a),surCharge:t.getSurCharge("CHILD",a),totalFare:t.getTotalAmountByType("CHILD")*this.numberOfPassenger.child};i.push(s)}if(this.numberOfPassenger.infant){const s={type:"Em b\xe9 (INF)",quantity:this.numberOfPassenger.infant,baseFare:t.getBaseFare("INFANT",a),surCharge:t.getSurCharge("INFANT",a),totalFare:t.getTotalAmountByType("INFANT")*this.numberOfPassenger.infant};i.push(s)}return{totalCharge:i.reduce((s,c)=>s+c.totalFare,0),details:i}}onShowDetailInfo(t){const a=this.listTicketSelected[t],i={airline:a.airline,airlineName:a.airlineName,airlineLogo:a.airlineLogo,operating:a.operating,operatingName:a.operatingName,flightNumber:a.flight,journeyName:`Chuy\u1ebfn bay: ${a.startPoint} - ${a.endPoint}`,numOfStop:a.numOfStop,departureDate:p(a.startTime).format("HH:mm DD/MM/YYYY"),startPoint:a.startCode,startPointName:a.startPoint,endPoint:a.endCode,endPointName:a.endPoint,price:a.totalPrice,handBag:"Kh\xf4ng",segments:a.segments.map((n,s)=>({airline:n.airline,airlineSystem:n.airline,airlineName:n.airlineName,airlineLogo:n.airlineLogo,operating:n.operating,operatingName:n.operatingName,mobileAirlineLogo:["VJ","VN","QH"].includes(n.airline)?"assets/airline-logo/"+n.airline+"_small.png":"assets/airline-logo/"+n.airline+".png",flightNumber:n.airline+n.flightNumber,startTime:p(n.departDate).format("HH:mm"),startDate:p(n.departDate).format("DD/MM/YYYY"),startPoint:n.startCode,startPointName:n.startPoint,startAirport:this._locationDataService.getAirportNameByCode(n.startPoint),endTime:p(n.arrivalDate).format("HH:mm"),endDate:p(n.arrivalDate).format("DD/MM/YYYY"),endPoint:n.endCode,endPointName:n.endPoint,endAirport:this._locationDataService.getAirportNameByCode(n.endPoint),stopPoint:n.stopPoint,modelAirplane:n.modelAirplane,rules:[{name:"Th\u1eddi gian bay",value:n.duration},{name:"Lo\u1ea1i m\xe1y bay",value:n.modelAirplane},{name:"H\u1ea1ng ch\u1ed7",value:n.fareClass},{name:"H\xe0nh l\xfd k\xfd g\u1eedi",value:a.checkedBag||"N/A"},{name:"H\xe0nh l\xfd x\xe1ch tay",value:a.handBag||"N/A"}]})),ticketPrice:a.ticketPrice,fareRule:a.fareRule};this.isMobile?this._bottomSheetService.open(b._8,{containerFullHeigh:!0,headerTitle:"Th\xf4ng tin chuy\u1ebfn bay",leftButtonIcon:"arrow_left",rightButtonIcon:""}):this._modal.open(b.Zk,{flightInfo:i})}getFareRuleClass(t,a,i){let n;n=["QH","VJ"].includes(t)?this.listFareRuleClasses.find(l=>{var d;return t===l.airline&&(null==i?void 0:i.toLocaleUpperCase())===(null===(d=l.fareClass)||void 0===d?void 0:d.toLocaleUpperCase())})||null:["VN"].includes(t)?this.listFareRuleClasses.find(l=>{var d;return t===l.airline&&(null==a?void 0:a.toLocaleUpperCase())===(null===(d=l.fareClass)||void 0===d?void 0:d.toLocaleUpperCase())})||null:{airline:t,fareClass:a,rules:[{name:"H\xe0nh l\xfd x\xe1ch tay",value:"N/A",cate:"HAND_BAGGAGE"},{name:"H\xe0nh l\xfd k\xfd g\u1eedi",value:"N/A",cate:"CHECKED_BAGGAGE"}]};const s=(null==n?void 0:n.rules.find(l=>"HAND_BAGGAGE"===l.cate))||null,c=(null==n?void 0:n.rules.find(l=>"CHECKED_BAGGAGE"===l.cate))||null;return{handBag:null==s?void 0:s.value,checkedBag:null==c?void 0:c.value}}onSortChange(t){this.sortState=t,this.processSort(),this.ticketInfiniteScrollCount=this.TICKET_INFINITE_SCROLL_DEFAULT}onSortChangeCombo(t){this.sortStateCombo=t,this.processSortCombo(),this.ticketInfiniteScrollCount=this.TICKET_INFINITE_SCROLL_DEFAULT}processSort(){var t,a;switch(this.sortState){case"min_price":this.listTicketDisplay.sort(this.ticketDisplayState.value.showNetPrice?(i,n)=>i.netPrice-n.netPrice:(i,n)=>i.totalPrice-n.totalPrice);break;case"max_price":this.listTicketDisplay.sort(this.ticketDisplayState.value.showNetPrice?(i,n)=>n.netPrice-i.netPrice:(i,n)=>n.totalPrice-i.totalPrice);break;case"min_flight":this.listTicketDisplay.sort((i,n)=>i.duration-n.duration),this.listTicketAgentDisplay.sort((i,n)=>i.duration-n.duration);break;case"max_flight":this.listTicketDisplay.sort((i,n)=>n.duration-i.duration),this.listTicketAgentDisplay.sort((i,n)=>n.duration-i.duration);break;case"earliest_departure":this.listTicketDisplay.sort((i,n)=>i.departure.localTime.getTime()-n.departure.localTime.getTime()),this.listTicketAgentDisplay.sort((i,n)=>i.departure.localTime.getTime()-n.departure.localTime.getTime());break;case"late_departure":this.listTicketDisplay.sort((i,n)=>n.departure.localTime.getTime()-i.departure.localTime.getTime()),this.listTicketAgentDisplay.sort((i,n)=>n.departure.localTime.getTime()-i.departure.localTime.getTime());break;case"earliest_arrival":this.listTicketDisplay.sort((i,n)=>i.arrival.localTime.getTime()-n.arrival.localTime.getTime()),this.listTicketAgentDisplay.sort((i,n)=>i.arrival.localTime.getTime()-n.arrival.localTime.getTime());break;case"late_arrival":this.listTicketDisplay.sort((i,n)=>n.arrival.localTime.getTime()-i.arrival.localTime.getTime()),this.listTicketAgentDisplay.sort((i,n)=>n.arrival.localTime.getTime()-i.arrival.localTime.getTime())}null===(t=this.listTicketDisplay)||void 0===t||t.sort((i,n)=>Number(0===i.seatRemain)-Number(0===n.seatRemain)),null===(a=this.listTicketAgentDisplay)||void 0===a||a.sort((i,n)=>{const s=i.segmentsDisplay.some(l=>l.fareClasses.every(d=>!d.seatRemain))?0:1;return(n.segmentsDisplay.some(l=>l.fareClasses.every(d=>!d.seatRemain))?0:1)-s})}processSortCombo(){const t=this.listTicketComboDisplay.filter(i=>-1!==i.indexForTracking),a=this.listTicketComboDisplay.filter(i=>-1===i.indexForTracking);switch(this.sortStateCombo){case"min_price":t.sort((i,n)=>i.departOptions[0].totalPrice+i.arriveOptions[0].totalPrice-(n.departOptions[0].totalPrice+n.arriveOptions[0].totalPrice));break;case"max_price":t.sort((i,n)=>n.departOptions[0].totalPrice+n.arriveOptions[0].totalPrice-(i.departOptions[0].totalPrice+i.arriveOptions[0].totalPrice));break;case"best":t.sort((i,n)=>n.score-i.score);break;case"fastest":t.sort((i,n)=>i.departOptions[0].duration+i.arriveOptions[0].duration-(n.departOptions[0].duration+n.arriveOptions[0].duration));break;case"max_flight":t.sort((i,n)=>n.departOptions[0].duration+n.arriveOptions[0].duration-(i.departOptions[0].duration+i.arriveOptions[0].duration));break;case"earliest_departure":t.sort((i,n)=>i.departOptions[0].departureDate.getTime()-n.departOptions[0].departureDate.getTime());break;case"late_departure":t.sort((i,n)=>n.departOptions[0].departureDate.getTime()-i.departOptions[0].departureDate.getTime());break;case"earliest_arrival":t.sort((i,n)=>i.arriveOptions[0].departureDate.getTime()-n.arriveOptions[0].departureDate.getTime());break;case"late_arrival":t.sort((i,n)=>n.arriveOptions[0].departureDate.getTime()-i.arriveOptions[0].departureDate.getTime())}this.listTicketComboDisplay=[...t,...a]}onShare(){this._modal.open(b.eP,{ticketsSelected:this.listTicketSelected.filter(t=>t.journeyKey),canEditHeader:this.canEditHeader,totalPrice:this.totalPrice,totalPriceCombo:this.totalPriceCombo,isHiddenTotalCharge:this.isHiddenTotalCharge})}onShareCombo(t){var a,i;const n=t.map((c,l)=>this.convertComboTicketToTicketSelectedVM(c,l)),s=n.map(c=>c.totalPrice).reduce((c,l)=>c+l)||0;if(this.totalPriceCombo=(null===(i=null===(a=n[0].comboRefs)||void 0===a?void 0:a.find(c=>c.key===n[1].fareOptionKey))||void 0===i?void 0:i.totalAllPaxPriceCombo)||0,this.isMobile){const c=this._bottomSheetService.open(b.eP,{headerTitle:"Chia s\u1ebb c\xe1c chuy\u1ebfn bay l\u1ef1a ch\u1ecdn",leftButtonIcon:"close",leftButtonIconClass:"text-neutral-gray-4",rightButtonIcon:"",containerFullHeigh:!0,data:{ticketsSelected:n,canEditHeader:this.canEditHeader,totalPrice:n.map(l=>l.totalPrice).reduce((l,d)=>l+d),totalPriceCombo:this.totalPriceCombo,isHiddenTotalCharge:this.isHiddenTotalCharge}});c.containerInstance._leftButtonClick.subscribe(l=>c.dismiss())}else this._modal.open(b.eP,{ticketsSelected:n,canEditHeader:this.canEditHeader,totalPrice:s,totalPriceCombo:this.totalPriceCombo,isHiddenTotalCharge:this.isHiddenTotalCharge})}onChangeSearch(t){t.focusFirstStartPoint()}onResetFilter(){this.ticketFilterState.next(Object.assign(Object.assign({},this.filterStateInit),{direct:this._searchInputService.isDirectFlight}))}onTicketSelectedChange(t){console.log(t)}resetOptionFilters(){this.fareclassList=[],this.selectedFare.value=""}initTicketExpireTimer(){this.clearTimer();let t=Number.MAX_SAFE_INTEGER;0!==this.searchFlightData.flightOptions.length&&(this.searchFlightData.flightOptions.length&&"COMBO"!==this.searchFlightData.flightOptions[0].type?this.searchFlightData.flightOptions.forEach(a=>{a.journeys.forEach(i=>{i.expireTime<t&&(t=i.expireTime)})}):this.searchFlightData.flightOptions.length&&"COMBO"===this.searchFlightData.flightOptions[0].type&&this.searchFlightData.flightOptions.forEach(a=>{a.comboInfo.arriveJourneys.forEach(i=>{i.expireTime<t&&(t=i.expireTime)}),a.comboInfo.departJourneys.forEach(i=>{i.expireTime<t&&(t=i.expireTime)})}),t&&t!==Number.MAX_SAFE_INTEGER&&this._systemService.getCurrentTimeEpoch().subscribe({next:a=>{"OK"===a.status&&(this.ticketExpireTimer=setTimeout(()=>{this._modal.open(L.V0,{title:"C\u1eadp nh\u1eadt th\xf4ng tin m\u1edbi nh\u1ea5t",body:"Th\u1eed l\u1ea1i k\u1ebft qu\u1ea3 t\xecm ki\u1ebfm v\u1edbi th\xf4ng tin, chi ph\xed v\xe0 ch\u1ed7 tr\u1ed1ng m\u1edbi nh\u1ea5t.",okText:"T\u1ea3i l\u1ea1i",hasCancel:!1}).afterClosed$.subscribe({next:n=>{n.data&&this.researchFlight()}})},1e3*(t-a.data.timeStamp)))}}))}clearTimer(){clearTimeout(this.ticketExpireTimer)}hasOutOfSeatDisplay(){return this.listTicketDisplay.some(t=>0===t.seatRemain)}hasOutOfSeatComboDisplay(){return this.listTicketComboDisplay.some(t=>t.soldOut)}hasOutOfSeatAgentDisplay(t){return t?t.segmentsDisplay.some(a=>a.fareClasses.every(i=>!i.seatRemain)):this.listTicketAgentDisplay.some(a=>a.segmentsDisplay.some(i=>i.fareClasses.every(n=>!n.seatRemain)))}onRegisterBookingHunter(){this._requestDataService.sourceEvent="SEARCH_RESULT",this._router.navigate(["admin/request-booking-hunter"],{state:{isEntryPointSearch:!0}})}onVerifyFlight(t,a,i){var n,s;if("CHECKED"===((null===(n=t[0].comboRefs.find(u=>u.key===t[1].fareOptionKey))||void 0===n?void 0:n.verifyState)||"UNCHECKED"))return;const l=null===(s=t[0].comboRefs)||void 0===s?void 0:s.find(u=>u.key===t[1].fareOptionKey);l&&(l.verifyState="IN_PROGRESS"),this.isVerifyComboProgress=!0;const d={flights:t.map(u=>({fareOptionKey:u.fareOptionKey,journeyKey:u.journeyKey,serviceFeeInfo:null})),provider:t[0].provider,checkMinPrice:!1};this._searchFlightService.verifyFlightCombo(d).pipe((0,U.x)(()=>this.isVerifyComboProgress=!1)).subscribe({next:u=>{if("OK"===u.status){const h=u.data[0].comboRefs.find(_=>_.key[0]===(null==l?void 0:l.key));h&&(u.data[1].fareAmountBreakdowns=null==h?void 0:h.fareAmountBreakdowns),l&&(l.sessionId=(null==h?void 0:h.sessionId)||"",l.verifyState="CHECKED",l.totalPriceCombo=(null==h?void 0:h.getTotalAmount())||0,l.totalAllPaxPriceCombo=(null==h?void 0:h.getTotalAmountAllPax(this.numberOfPassenger.adult,this.numberOfPassenger.child))||0,l.ticketPrice=h?this.getTicketDetail(h,t[0].airline):null,this.listTicketComboDisplay[i]=Object.assign({},this.listTicketComboDisplay[i]))}else l&&(l.verifyState="FAIL")},error:()=>{l&&(l.verifyState="INVALID")}})}}return r.\u0275fac=function(t){return new(t||r)(e.Y36(Qi.R),e.Y36(Bi.h),e.Y36(_e.t7),e.Y36(Ji.G),e.Y36(Oi._),e.Y36(m.KNP),e.Y36(Je.F0),e.Y36(M.oE),e.Y36(Ui.v),e.Y36(k.$A),e.Y36(Ge.L),e.Y36(Z.a2),e.Y36(qi.x),e.Y36(Gi.r),e.Y36(Yi.FH),e.Y36(ji.o))},r.\u0275cmp=e.Xpm({type:r,selectors:[["search-flight-result-page"]],standalone:!0,features:[e.jDz],decls:51,vars:74,consts:[[1,"h-full","w-full","flex","flex-col"],[1,"bg-neutral-white","shadow-cf-md","md:hidden"],[1,"py-4","px-[30px]","w-full"],[1,"flex","items-center","justify-between","mb-4"],[3,"flightType","flightTypeSearchChange"],[1,"flex","items-center","justify-end","gap-x-4"],[3,"adultNumber","childNumber","infantNumber","numberOfPassengerChange"],[3,"airlineList","airlineFilterChange"],[3,"promotionGroupList"],[1,"flex","gap-x-2"],[1,"grow",3,"formArray","removeRoute"],["searchFlightEl",""],["cf-button","","size","medium","class","w-[168px] !py-[7px] !h-auto !max-h-14","type","secondary",3,"disabled","click",4,"ngIf"],["class","flex items-center justify-between mb-[9px]",4,"ngIf"],["class","h-1 w-full",4,"ngIf"],[1,"flex-col","w-full","hidden","md:flex","sticky","top-0","z-[5]"],[1,"px-4","pt-3","pb-2","hidden","md:block","bg-white"],[3,"currentMode","onReseachFlight","onFlightTypeChange","onQuotation"],[1,"pl-4","pt-0","hidden","md:block","bg-white","shadow-cf-md"],[1,"flex","items-center","gap-x-2","overflow-y-auto","pr-4","pb-3"],[3,"disableSort","sortDefault","sortChange",4,"ngIf"],[3,"sortDefault","tabDetail","sortChange",4,"ngIf"],[3,"currentMode","airlineList","ticketFilter","ticketDisplay","fareclassList","planeModelList","selectedFare","departureTimeList","arrivalTimeList","durationFilter","minDuration","maxDuration","departTimeComboList","arriveTimeComboList","minFareClss","priceFilter","minPrice","maxPrice","bookingSystemList","ticketFilterChange","ticketDisplayChange"],[3,"modeView","disableAgencyMode","modeChange",4,"ngIf"],[3,"airlineList","ticketFilter","ticketFilterChange"],[3,"ticketFilter","ticketFilterChange"],[1,"flex-auto","h-full","flex","py-6","px-[30px]","md:p-4"],[1,"w-[222px]","pr-[30px]","flex-shrink-0","md:hidden"],[3,"currentMode","airlineList","ticketFilter","ticketDisplay","fareclassList","planeModelList","departureTimeList","minFareClss","priceFilter","minPrice","maxPrice","departTimeComboList","arriveTimeComboList","durationFilter","minDuration","maxDuration","bookingSystemList","selectedFare","arrivalTimeList","ticketFilterChange","ticketDisplayChange"],[1,"flex","flex-col","grow","gap-y-6","md:w-full"],["class","py-3 px-4 flex items-center gap-x-2 bg-functional-1-1 rounded",4,"ngIf"],["class","md:overflow-y-auto md:hidden",3,"selectedIndexChange",4,"ngIf"],["class","md:hidden",3,"sortDefault","tabDetail","sortChange",4,"ngIf"],[1,"flex","flex-nowrap","gap-x-4","md:gap-x-0"],[1,"flex","flex-col","grow","gap-y-4","md:w-full"],["class","flex justify-between items-center md:hidden",4,"ngIf"],[1,"flex","flex-col","gap-y-3","md:mb-16"],[4,"ngIf"],[1,"mt-[56px]","w-[302px]","flex-shrink-0","rounded","h-fit","md:hidden","sticky","top-0"],[1,"bg-neutral-white"],[1,"flex","justify-between","items-center","py-3","px-4"],[1,"text-espressive-sm","text-neutral-black"],["class","cursor-pointer","icon","share","size","small",3,"click",4,"ngIf"],[3,"ticketsSelected","reselect","showDetail"],["class","flex justify-between items-center py-3 px-4",4,"ngIf"],[1,"hidden","md:block",3,"ticketSelectedNumber","ticketsSelected","totalPrice","reselect","showDetail","share"],["cf-button","","size","medium","type","secondary",1,"w-[168px]","!py-[7px]","!h-auto","!max-h-14",3,"disabled","click"],["icon","search","size","small",1,"mr-2.5"],[1,"whitespace-nowrap"],[1,"flex","items-center","justify-between","mb-[9px]"],[1,"flex","items-center","gap-x-10","mt-[19px]"],[1,"flex","items-center","text-secondary-1-5","cursor-pointer",3,"click"],["icon","plus","size","small",1,"mr-2.5"],[1,"text-heading-xs"],[1,"flex","items-center","text-neutral-black","cursor-pointer",3,"click"],["icon","rotate_left","size","small",1,"mr-2.5"],[1,"text-body-md"],["cf-button","","size","medium","type","secondary",1,"w-[168px]","mt-[25px]","!max-h-14",3,"disabled","click"],[1,"h-1","w-full"],[1,"h-1","bg-primary-1-4","transition-all","ease-out","duration-1000"],[3,"disableSort","sortDefault","sortChange"],[3,"sortDefault","tabDetail","sortChange"],[3,"modeView","disableAgencyMode","modeChange"],[1,"py-3","px-4","flex","items-center","gap-x-2","bg-functional-1-1","rounded"],["icon","circle_information","size","small",1,"text-functional-1-3"],[1,"flex","flex-col","grow","text-neutral-gray-6"],[1,"text-espressive-md"],["size","small","icon","close",1,"text-neutral-gray-4","cursor-pointer",3,"click"],[1,"md:overflow-y-auto","md:hidden",3,"selectedIndexChange"],["class","w-1/4 grow-0 md:w-fit",3,"active","title",4,"ngFor","ngForOf"],[1,"w-1/4","grow-0","md:w-fit",3,"active","title"],["titleTemplate",""],[1,"flex","gap-x-4","items-center","md:-mx-1","md:-my-1.5"],[1,"flex","justify-center","items-center","w-8","h-8","rounded-full","bg-neutral-gray-1","text-neutral-gray-4","text-heading-sm","md:w-6","md:h-6","md:text-espressive-sm"],[1,"flex","flex-col"],[1,"text-heading-sm","whitespace-nowrap"],[1,"text-body-sm","md:hidden","text-neutral-gray-5","whitespace-nowrap"],[1,"text-body-sm","hidden","md:block","text-neutral-gray-5","whitespace-nowrap"],[1,"md:hidden",3,"sortDefault","tabDetail","sortChange"],[1,"flex","justify-between","items-center","md:hidden"],[1,"flex","gap-x-3"],["cf-button","","size","medium","type","secondary","class","bg-white flex gap-x-2",3,"disabled","click",4,"ngIf"],[1,"md:hidden",3,"sortDefault","disableSort","sortChange"],["cf-button","","size","medium","type","secondary",1,"bg-white","flex","gap-x-2",3,"disabled","click"],["icon","ticket","size","small",1,"text-heading-xs","text-neutral-black","mr-1.5",3,"ngClass"],["icon","document","size","small",1,"text-heading-xs","text-neutral-black","mr-1.5",3,"ngClass"],["class","flex flex-col gap-y-3","infinite-scroll","",3,"infiniteScrollDistance","infiniteScrollThrottle","infiniteScrollContainer","scrollWindow","fromRoot","alwaysCallback","scrolled",4,"ngIf"],[4,"ngIf","ngIfElse"],["elseLoadingTemp",""],["infinite-scroll","",1,"flex","flex-col","gap-y-3",3,"infiniteScrollDistance","infiniteScrollThrottle","infiniteScrollContainer","scrollWindow","fromRoot","alwaysCallback","scrolled"],[4,"ngFor","ngForOf","ngForTrackBy"],["class","text-heading-md",4,"ngIf"],[3,"ticket","listFareRule","loading","ticketSelected","ticketComboShare","verifyFlight",4,"ngIf"],[3,"ticket","listFareRule","loading","ticketSelected","ticketComboShare","verifyFlight"],[1,"text-heading-md"],[3,"ticket","listFareRule","ticketComboShare",4,"ngIf"],[3,"ticket","listFareRule","ticketComboShare"],["class","empty flex items-center mt-20 flex-col",4,"ngIf","ngIfElse"],["elseEmptyTemp",""],[1,"empty","flex","items-center","mt-20","flex-col"],["src","assets/images/empty_result.png","alt","empty",1,"w-[160px]","h-160px","object-contain"],[1,"text-heading-md","mt-[30px]"],[1,"text-body-md","mt-2","text-center"],["cf-button","","color","primary-1","size","medium",1,"w-[200px]","mt-6","justify-center",3,"type","click"],["class","empty flex items-center mt-20 flex-col",4,"ngIf"],[1,"text-body-md","mt-2"],["cf-button","","size","medium",1,"w-[200px]","mt-6","justify-center","bg-white",3,"type","click"],["icon","search","size","small",1,"mr-2"],["elseSearchFlightTemplate",""],[1,"min-w-[676px]","md:min-w-fit","flex","flex-col","gap-y-3"],["elseSearchResultsTemplate",""],[4,"ngFor","ngForOf"],[3,"ticket","listFareRule","mobileSelected","listFareRuleClasses","onReselectClick",4,"ngIf"],[3,"ticket","listFareRule","mobileSelected","listFareRuleClasses","onReselectClick"],[3,"ticket","listFareRule","listFareRuleClasses","ticketSelected",4,"ngIf"],[3,"ticket","listFareRule","listFareRuleClasses","ticketSelected"],["elseSearchFlightAgentTemp",""],["elseSearchResultsAgentTemp",""],[3,"ticket","listFareRule","mobileSelected","listFareRuleClasses","onReselectClick","ticketSelected",4,"ngIf"],[3,"ticket","listFareRule","mobileSelected","listFareRuleClasses","onReselectClick","ticketSelected"],["icon","share","size","small",1,"cursor-pointer",3,"click"],[1,"text-heading-md","text-neutral-black"]],template:function(t,a){1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div")(5,"cf-flight-type-selector",4),e.NdJ("flightTypeSearchChange",function(n){return a.flightTypeChange(n)}),e.qZA()(),e.TgZ(6,"div",5)(7,"cf-number-of-passenger",6),e.NdJ("numberOfPassengerChange",function(n){return a.numberOfPassengerChange(n)}),e.qZA(),e.TgZ(8,"cf-airline-filter",7),e.NdJ("airlineFilterChange",function(n){return a.airlineFilterChange(n)}),e.qZA(),e._UZ(9,"cf-voucher-selector",8),e.qZA()(),e.TgZ(10,"div",9)(11,"cf-search-flight-input",10,11),e.NdJ("removeRoute",function(n){return a.removeRoute(n)}),e.qZA(),e.YNc(13,$i,4,1,"button",12),e.qZA(),e.YNc(14,Ki,14,1,"div",13),e.qZA(),e.YNc(15,Vi,2,2,"div",14),e.qZA(),e.TgZ(16,"div",15)(17,"div",16)(18,"mobile-search-input",17),e.NdJ("onReseachFlight",function(){return a.researchFlight()})("onFlightTypeChange",function(n){return a.flightTypeChange(n)})("onQuotation",function(){return a.onMobileQuotation(a.currentLeg)}),e.qZA()(),e.TgZ(19,"div",18)(20,"div",19),e.YNc(21,zi,1,2,"app-sort-flight",20),e.YNc(22,Wi,1,2,"app-sort-flight-combo",21),e.TgZ(23,"app-filter-flight",22),e.NdJ("ticketFilterChange",function(n){return a.filterChange(n)})("ticketDisplayChange",function(n){return a.displayChange(n)}),e.qZA(),e.YNc(24,Xi,1,2,"app-switch-mode",23),e.TgZ(25,"airline-filter-bottom-sheet",24),e.NdJ("ticketFilterChange",function(n){return a.filterChange(n)}),e.qZA(),e.TgZ(26,"stop-number-filter-bottom-sheet",25),e.NdJ("ticketFilterChange",function(n){return a.filterChange(n)}),e.qZA()()()(),e.TgZ(27,"div",26)(28,"div",27)(29,"app-filter-flight",28),e.NdJ("ticketFilterChange",function(n){return a.filterChange(n)})("ticketDisplayChange",function(n){return a.displayChange(n)}),e.qZA()(),e.TgZ(30,"div",29),e.YNc(31,ea,8,0,"div",30),e.YNc(32,aa,2,1,"cf-tabset",31),e.YNc(33,ra,1,2,"app-sort-flight-combo",32),e.TgZ(34,"div",33)(35,"div",34),e.YNc(36,sa,6,6,"div",35),e.TgZ(37,"div",36),e.YNc(38,va,5,3,"ng-container",37),e.YNc(39,Za,4,2,"ng-container",37),e.YNc(40,Ka,4,2,"ng-container",37),e.qZA()(),e.TgZ(41,"div",38)(42,"div",39)(43,"div",40)(44,"div",41),e._uU(45,"Chuy\u1ebfn bay c\u1ee7a b\u1ea1n"),e.qZA(),e.YNc(46,Va,1,0,"cf-icon",42),e.qZA(),e.TgZ(47,"div")(48,"tickets-selected",43),e.NdJ("reselect",function(n){return a.reselect(n)})("showDetail",function(n){return a.onShowDetailInfo(n)}),e.qZA()(),e.YNc(49,za,7,7,"div",44),e.qZA()()()()()(),e.TgZ(50,"ticket-selected-bottom-sheet",45),e.NdJ("reselect",function(n){return a.reselect(n)})("showDetail",function(n){return a.onShowDetailInfo(n)})("share",function(){return a.onShare()}),e.qZA()),2&t&&(e.xp6(5),e.Q6J("flightType",a.flightTypeSearch),e.xp6(2),e.Q6J("adultNumber",a._searchInputService.numberOfPassenger.adult)("childNumber",a._searchInputService.numberOfPassenger.child)("infantNumber",a._searchInputService.numberOfPassenger.infant),e.xp6(1),e.Q6J("airlineList",a._searchInputService.airlineFilters),e.xp6(1),e.Q6J("promotionGroupList",a._searchInputService.promotionGroupFilters),e.xp6(2),e.Q6J("formArray",a._searchInputService.searchInputForm),e.xp6(2),e.Q6J("ngIf",a.flightTypeSearch!==a.multiFilghtType),e.xp6(1),e.Q6J("ngIf",a.flightTypeSearch===a.multiFilghtType),e.xp6(1),e.Q6J("ngIf",a.isprogress),e.xp6(3),e.Q6J("currentMode",a.currentMode),e.xp6(3),e.Q6J("ngIf","combo"!==a.currentMode),e.xp6(1),e.Q6J("ngIf","combo"===a.currentMode),e.xp6(1),e.Q6J("currentMode",a.currentMode)("airlineList",a.airlineList)("ticketFilter",a.ticketFilterState.value)("ticketDisplay",a.ticketDisplayState.value)("fareclassList",a.fareclassList)("planeModelList",a.planModelList)("selectedFare",a.selectedFare)("departureTimeList",a.departureTimeList)("arrivalTimeList",a.arrivalTimeList)("durationFilter",a.durationFilter)("minDuration",a.minDuration)("maxDuration",a.maxDuration)("departTimeComboList",a.departTimeComboList)("arriveTimeComboList",a.arriveTimeComboList)("minFareClss",a.minFareClss)("priceFilter",a.priceFilter)("minPrice",a.minPrice)("maxPrice",a.maxPrice)("bookingSystemList",a.bookingSystemList)("priceFilter",a.priceFilter),e.xp6(1),e.Q6J("ngIf","combo"!==a.currentMode),e.xp6(1),e.Q6J("airlineList",a.airlineList)("ticketFilter",a.ticketFilterState.value),e.xp6(1),e.Q6J("ticketFilter",a.ticketFilterState.value),e.xp6(3),e.Q6J("currentMode",a.currentMode)("airlineList",a.airlineList)("ticketFilter",a.ticketFilterState.value)("ticketDisplay",a.ticketDisplayState.value)("fareclassList",a.fareclassList)("planeModelList",a.planModelList)("departureTimeList",a.departureTimeList)("minFareClss",a.minFareClss)("priceFilter",a.priceFilter)("minPrice",a.minPrice)("maxPrice",a.maxPrice)("departTimeComboList",a.departTimeComboList)("arriveTimeComboList",a.arriveTimeComboList)("priceFilter",a.priceFilter)("durationFilter",a.durationFilter)("minDuration",a.minDuration)("maxDuration",a.maxDuration)("bookingSystemList",a.bookingSystemList)("selectedFare",a.selectedFare)("arrivalTimeList",a.arrivalTimeList),e.xp6(1),e.ekj("!gap-y-4","combo"===a.currentMode),e.xp6(1),e.Q6J("ngIf",a.isShowBambooPromotionError),e.xp6(1),e.Q6J("ngIf",a.tabData.length>1&&"combo"!==a.currentMode),e.xp6(1),e.Q6J("ngIf","combo"===a.currentMode),e.xp6(3),e.Q6J("ngIf","combo"!==a.currentMode),e.xp6(2),e.Q6J("ngIf","combo"===a.currentMode),e.xp6(1),e.Q6J("ngIf","retail"===a.currentMode),e.xp6(1),e.Q6J("ngIf","agency"===a.currentMode),e.xp6(1),e.ekj("!mt-0","combo"===a.currentMode),e.xp6(5),e.Q6J("ngIf",a.showSharedFlight&&a.isShareFlight),e.xp6(2),e.Q6J("ticketsSelected",a.listTicketSelected),e.xp6(1),e.Q6J("ngIf",!a.isHiddenTotalCharge),e.xp6(1),e.Q6J("ticketSelectedNumber",a.ticketSelectedNumber)("ticketsSelected",a.listTicketSelected)("totalPrice",a.totalPrice))},dependencies:[E.N8,E.Xq,w.Q,w.F,b.qx,v.ez,v.mk,v.sg,v.O5,v.JJ,b.ZZ,b.kx,b.Vz,b.AS,m.AxE,m.Sm8,b.bM,b.IA,S.DA,S.z6,S.h4,S.uX,S.t3,y.u5,y.UX,Q.Rq,Q.Ry,Ke.MobileSearchInputComponent,b.xq,b.m0,b.a7,b.wv,b.wH,b.Fr],encapsulation:2}),r})()},3803:($e,H,g)=>{g.d(H,{h:()=>y});var v=g(94650);let y=(()=>{class E{get ticketSelectedData(){return JSON.parse(sessionStorage.getItem("ticketSelectedData"))}set ticketSelectedData(w){sessionStorage.setItem("ticketSelectedData",JSON.stringify(w))}}return E.\u0275fac=function(w){return new(w||E)},E.\u0275prov=v.Yz7({token:E,factory:E.\u0275fac,providedIn:"root"}),E})()}}]);