"use strict";(self.webpackChunkcheapflightclient=self.webpackChunkcheapflightclient||[]).push([[2819],{27849:(H,E,g)=>{g.d(E,{h:()=>C});var T=g(94650);let C=(()=>{class Z{constructor(){}getBookingDetailReroutingData(){return this.bookingDetailReroutingData}setBookingDetailReroutingData(v){this.bookingDetailReroutingData=v}}return Z.\u0275fac=function(v){return new(v||Z)},Z.\u0275prov=T.Yz7({token:Z,factory:Z.\u0275fac,providedIn:"root"}),Z})()},2819:(H,E,g)=>{g.r(E),g.d(E,{ReroutingPageComponent:()=>Le});var T=g(36895),C=g(24006),Z=g(37094),D=g(83700),v=g(72506),K=g(19123),b=g(48042),Q=g(34120),w=g(77296),$=g(77579),R=g(61135),j=g(82722),k=g(28746),h=g(15439),V=g(17489),q=g(39840),e=g(94650),I=g(97579);function z(n,d){if(1&n&&(e.TgZ(0,"div",48),e._UZ(1,"cf-icon",49),e.TgZ(2,"span",50),e._uU(3),e.qZA()()),2&n){const t=e.oxw().$implicit;e.xp6(3),e.hij(" ",t.stopPoint," ")}}function G(n,d){1&n&&e._UZ(0,"div",51)}function X(n,d){if(1&n&&(e.TgZ(0,"div",52)(1,"div",27),e._uU(2),e.qZA(),e.TgZ(3,"div",53),e._uU(4),e.qZA()()),2&n){const t=d.$implicit;e.xp6(2),e.hij("",t.name,":\xa0"),e.xp6(2),e.Oqu(t.value)}}const L=function(){return[]};function W(n,d){if(1&n&&(e.ynx(0),e.YNc(1,z,4,1,"div",18),e.TgZ(2,"div",19)(3,"div",20),e.YNc(4,G,1,0,"div",21),e.qZA(),e.TgZ(5,"div",22)(6,"div",23)(7,"div"),e._UZ(8,"img",24),e.qZA(),e.TgZ(9,"div",25)(10,"div",26),e._uU(11),e.qZA(),e.TgZ(12,"div",27),e._uU(13),e.qZA()(),e.TgZ(14,"div",28),e._uU(15),e.qZA()(),e.TgZ(16,"div",29)(17,"div",13)(18,"div",30)(19,"div",31),e._UZ(20,"cf-icon",32),e.TgZ(21,"div"),e._uU(22),e.qZA()(),e.TgZ(23,"div",33),e._UZ(24,"div",34)(25,"div",35)(26,"cf-icon",36),e.qZA()(),e.TgZ(27,"div",37),e._UZ(28,"cf-icon",38),e.TgZ(29,"div",39),e._uU(30),e.qZA()(),e.TgZ(31,"div",40),e._UZ(32,"cf-icon",41),e.TgZ(33,"div",42)(34,"span",43),e._uU(35),e.qZA(),e.TgZ(36,"span",44),e._uU(37),e.qZA()()()(),e.TgZ(38,"div")(39,"div",45),e._UZ(40,"cf-icon",32),e.TgZ(41,"div"),e._uU(42),e.qZA()(),e.TgZ(43,"div",37),e._UZ(44,"cf-icon",38),e.TgZ(45,"div",39),e._uU(46),e.qZA()(),e.TgZ(47,"div",40),e._UZ(48,"cf-icon",41),e.TgZ(49,"div",42)(50,"span",43),e._uU(51),e.qZA(),e.TgZ(52,"span",44),e._uU(53),e.qZA()()()()()(),e.TgZ(54,"div",46),e.YNc(55,X,5,2,"div",47),e.qZA()(),e.BQk()),2&n){const t=d.$implicit;e.xp6(1),e.Q6J("ngIf",t.stopPoint),e.xp6(3),e.Q6J("ngForOf",e.DdM(15,L).constructor(6)),e.xp6(4),e.Q6J("src","assets/airline-logo/"+t.operating+".png",e.LSH),e.xp6(3),e.hij("",t.operating," - "),e.xp6(2),e.hij("\xa0",t.operatingName,""),e.xp6(2),e.hij(" ",t.flightNumber," "),e.xp6(7),e.Oqu(t.startTime),e.xp6(8),e.Oqu(t.startDate),e.xp6(5),e.hij("",t.startPoint," - "),e.xp6(2),e.Oqu(t.startPointName),e.xp6(5),e.hij(" ",t.endTime," "),e.xp6(4),e.Oqu(t.endDate),e.xp6(5),e.hij("",t.endPoint," - "),e.xp6(2),e.Oqu(t.endPointName),e.xp6(2),e.Q6J("ngForOf",null==t?null:t.rules)}}function ee(n,d){if(1&n&&(e.TgZ(0,"tr")(1,"td",60),e._uU(2),e.qZA(),e.TgZ(3,"td",60),e._uU(4),e.qZA(),e.TgZ(5,"td",60),e._uU(6),e.ALo(7,"number"),e.qZA(),e.TgZ(8,"td",60),e._uU(9),e.ALo(10,"number"),e.qZA(),e.TgZ(11,"td",61),e._uU(12),e.ALo(13,"number"),e.qZA()()),2&n){const t=d.$implicit;e.xp6(2),e.Oqu(t.type),e.xp6(2),e.Oqu(t.type),e.xp6(2),e.Oqu(e.lcZ(7,5,t.baseFare)),e.xp6(3),e.Oqu(e.lcZ(10,7,t.surCharge)),e.xp6(3),e.Oqu(e.lcZ(13,9,t.totalFare))}}function te(n,d){if(1&n&&(e.TgZ(0,"div")(1,"div",14),e._UZ(2,"cf-icon",15),e.TgZ(3,"span",3),e._uU(4,"Gi\xe1 v\xe9 g\u1ed1c"),e.qZA()(),e.TgZ(5,"table",54)(6,"thead")(7,"tr",55)(8,"th",56),e._uU(9,"H\xe0nh kh\xe1ch"),e.qZA(),e.TgZ(10,"th",56),e._uU(11,"Lo\u1ea1i"),e.qZA(),e.TgZ(12,"th",56),e._uU(13,"Gi\xe1 v\xe9"),e.qZA(),e.TgZ(14,"th",56),e._uU(15,"Thu\u1ebf ph\xed"),e.qZA(),e.TgZ(16,"th",57),e._uU(17,"T\u1ed5ng gi\xe1"),e.qZA()()(),e.TgZ(18,"tbody"),e.YNc(19,ee,14,11,"tr",16),e.qZA()(),e.TgZ(20,"div",58)(21,"div",26),e._uU(22,"T\u1ed5ng gi\xe1 v\xe9"),e.qZA(),e.TgZ(23,"div",59),e._uU(24),e.ALo(25,"number"),e.qZA()()()),2&n){const t=e.oxw(2);e.xp6(19),e.Q6J("ngForOf",t.flightInfo.ticketPrice.details||e.DdM(4,L)),e.xp6(5),e.hij("",e.lcZ(25,2,t.flightInfo.ticketPrice.totalCharge)," \u0111")}}function ie(n,d){if(1&n&&(e.TgZ(0,"div",12)(1,"div",13)(2,"div",14),e._UZ(3,"cf-icon",15),e.TgZ(4,"span",3),e._uU(5," Th\xf4ng tin chuy\u1ebfn bay HAN - SGN, ng\xe0y 23/05/2024 "),e.qZA()(),e.YNc(6,W,56,16,"ng-container",16),e.qZA(),e.YNc(7,te,26,5,"div",17),e.qZA()),2&n){const t=e.oxw();e.xp6(6),e.Q6J("ngForOf",t.flightInfo.segments),e.xp6(1),e.Q6J("ngIf",t.flightInfo.ticketPrice)}}function ae(n,d){if(1&n&&(e.TgZ(0,"div",62)(1,"div",63)(2,"div",64),e._uU(3,"VIETJET"),e.qZA(),e.TgZ(4,"div",65),e._uU(5,"H\xe0nh tr\xecnh hi\u1ec7n t\u1ea1i"),e.qZA(),e.TgZ(6,"div",66),e._uU(7,"H\xe0nh tr\xecnh m\u1edbi"),e.qZA()(),e.TgZ(8,"div",63)(9,"div",64),e._uU(10,"H\xe0nh tr\xecnh"),e.qZA(),e.TgZ(11,"div",64)(12,"div",67)(13,"span"),e._uU(14),e.qZA(),e._UZ(15,"cf-icon",68),e.TgZ(16,"span"),e._uU(17),e.qZA()()(),e.TgZ(18,"div",64)(19,"div",67)(20,"span"),e._uU(21),e.qZA(),e._UZ(22,"cf-icon",68),e.TgZ(23,"span"),e._uU(24),e.qZA()()()(),e.TgZ(25,"div",69)(26,"div",64),e._uU(27,"Gi\u1edd bay"),e.qZA(),e.TgZ(28,"div",64),e._uU(29),e.qZA(),e.TgZ(30,"div",64),e._uU(31),e.qZA()(),e.TgZ(32,"div",63)(33,"div",64),e._uU(34,"Ch\u1eb7ng bay"),e.qZA(),e.TgZ(35,"div",64),e._uU(36),e.qZA(),e.TgZ(37,"div",64),e._uU(38),e.qZA()(),e.TgZ(39,"div",69)(40,"div",64),e._uU(41,"T\u1ed5ng gi\xe1 g\u1ed1c"),e.qZA(),e.TgZ(42,"div",64),e._uU(43),e.ALo(44,"number"),e.qZA(),e.TgZ(45,"div",64),e._uU(46),e.ALo(47,"number"),e.qZA()(),e.TgZ(48,"div",69)(49,"div",64),e._uU(50,"Ph\xed d\u1ecbch v\u1ee5"),e.qZA(),e.TgZ(51,"div",64),e._uU(52),e.ALo(53,"number"),e.qZA(),e.TgZ(54,"div",64),e._uU(55),e.ALo(56,"number"),e.qZA()(),e.TgZ(57,"div",63)(58,"div",64),e._uU(59,"T\u1ed5ng chi ph\xed"),e.qZA(),e.TgZ(60,"div",64),e._uU(61),e.ALo(62,"number"),e.qZA(),e.TgZ(63,"div",64),e._uU(64),e.ALo(65,"number"),e.qZA()(),e.TgZ(66,"div",69)(67,"div",64),e._uU(68,"Ch\xeanh l\u1ec7ch"),e.qZA(),e.TgZ(69,"div",64),e._uU(70),e.ALo(71,"number"),e.qZA(),e.TgZ(72,"div",70),e._uU(73),e.ALo(74,"number"),e.qZA()()()),2&n){const t=e.oxw();e.xp6(14),e.hij(" ",t.compareJourneyData.oldJourney.startPoint,""),e.xp6(3),e.hij(" ",t.compareJourneyData.oldJourney.endPoint," "),e.xp6(4),e.hij(" ",t.compareJourneyData.newJourney.startPoint," "),e.xp6(3),e.hij(" ",t.compareJourneyData.newJourney.endPoint," "),e.xp6(5),e.Oqu(t.compareJourneyData.oldJourney.startTime),e.xp6(2),e.Oqu(t.compareJourneyData.newJourney.startTime),e.xp6(5),e.Oqu(t.compareJourneyData.oldJourney.redirectType),e.xp6(2),e.Oqu(t.compareJourneyData.newJourney.redirectType),e.xp6(5),e.hij("",e.lcZ(44,16,t.compareJourneyData.oldJourney.totalBaseFare)," \u0111"),e.xp6(3),e.hij("",e.lcZ(47,18,t.compareJourneyData.newJourney.totalBaseFare)," \u0111"),e.xp6(6),e.hij("",e.lcZ(53,20,t.compareJourneyData.oldJourney.serviceFee)," \u0111"),e.xp6(3),e.hij("",e.lcZ(56,22,t.compareJourneyData.newJourney.serviceFee)," \u0111"),e.xp6(6),e.hij("",e.lcZ(62,24,t.compareJourneyData.oldJourney.totalCharge)," \u0111"),e.xp6(3),e.hij("",e.lcZ(65,26,t.compareJourneyData.newJourney.totalCharge)," \u0111"),e.xp6(6),e.hij("",e.lcZ(71,28,t.compareJourneyData.oldJourney.gapCharge)," \u0111"),e.xp6(3),e.hij("T\u0103ng ",e.lcZ(74,30,t.compareJourneyData.newJourney.gapCharge)," \u0111")}}let re=(()=>{class n{constructor(t,i){this.ref=i,this.currentIndex="JOURNEY_DETAIL",t.registerIcons([v.UNF,v.Ffn]),i&&(this.currentIndex=i.data.type,this.compareJourneyData=i.data.compareJourneyData,this.flightInfo=i.data.flightInfo)}ngOnInit(){}onClose(){this.ref&&this.ref.close()}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(v.KNP),e.Y36(I.gb))},n.\u0275cmp=e.Xpm({type:n,selectors:[["journey-modify-detail-modal"]],standalone:!0,features:[e.jDz],decls:18,vars:14,consts:[[1,"w-[800px]","rounded-lg","bg-neutral-white","overflow-hidden"],[1,"w-full","h-full","flex","flex-col"],[1,"flex","justify-between","items-center","px-6","py-[13px]","border-b","border-neutral-gray-1"],[1,"text-heading-sm","text-neutral-black"],["size","medium","icon","close",1,"text-neutral-gray-4","cursor-pointer",3,"click"],[1,"p-6"],[1,"flex","gap-x-3"],[1,"py-1.5","px-4","border","border-neutral-gray-3","text-neutral-gray-4","text-heading-xs","rounded-full","cursor-pointer",3,"click"],["class","flow-auto w-ful h-full overflow-auto py-4 px-6 flex flex-col gap-y-6",4,"ngIf"],["class","flex flex-col",4,"ngIf"],[1,"p-6","flex","justify-end","gap-x-4"],["cf-button","","size","medium",1,"min-w-[100px]","justify-center",3,"click"],[1,"flow-auto","w-ful","h-full","overflow-auto","py-4","px-6","flex","flex-col","gap-y-6"],[1,""],[1,"mb-4","flex","items-center","gap-x-2"],["icon","circle_information","size","small",1,"cf-icon-small"],[4,"ngFor","ngForOf"],[4,"ngIf"],["class","w-full bg-[#F0EAF4] rounded flex items-center gap-x-2 py-1.5 px-3 my-3",4,"ngIf"],[1,"flex","justify-between","items-center","border","border-neutral-gray-2","rounded","shadow-cf-journey-booking-success","relative"],[1,"absolute","-translate-x-[18%]","top-0","h-full","flex","flex-col","justify-between","py-3.5"],["class","w-1.5 h-3 border border-l-0 bg-neutral-white border-neutral-gray-2 rounded-r-full",4,"ngFor","ngForOf"],[1,"px-8","pt-6","pb-8","flex","flex-1","justify-between","gap-x-9"],[1,"flex","flex-col","items-center","justify-center"],[1,"w-[120px]","h-[60px]","object-contain",3,"src"],[1,"flex","items-center","mt-1.5"],[1,"text-espressive-sm"],[1,"text-body-sm"],[1,"py-[2px]","px-2","bg-neutral-gray-1","rounded","text-espressive-sm","text-neutral-black","mt-2"],[1,"flex","justify-between","gap-x-3"],[1,"flex","items-center","gap-x-[20px]","mb-3"],[1,"text-heading-lg","text-neutral-black","flex","gap-x-2","items-center"],["icon","clock","size","small"],[1,"flex","items-center","w-[50px]","py-1","px-2.5"],[1,"w-1.5","h-1.5","bg-neutral-gray-2","rounded-full"],[1,"w-full","h-[1px]","bg-neutral-gray-2"],["icon","plane","size","small",1,"text-[#ccc]"],[1,"flex","items-center","gap-x-2","mb-2"],["icon","calendar","size","small"],[1,"text-body-md","text-neutral-black"],[1,"flex","items-center","gap-x-2"],["icon","location","size","small"],[1,"text-neutral-black"],[1,"text-espressive-md"],[1,"text-body-md"],[1,"text-heading-lg","text-neutral-black","mb-3","flex","gap-x-2","items-center"],[1,"py-6","px-[18px]","border-l","border-dashed","border-neutral-gray-2","flex","flex-col","justify-between","gap-y-2"],["class","flex flex-nowrap items-center",4,"ngFor","ngForOf"],[1,"w-full","bg-[#F0EAF4]","rounded","flex","items-center","gap-x-2","py-1.5","px-3","my-3"],["icon","circle_information","size","small",1,"text-secondary-2-4"],[1,"text-express-md","text-neutral-gray-6"],[1,"w-1.5","h-3","border","border-l-0","bg-neutral-white","border-neutral-gray-2","rounded-r-full"],[1,"flex","flex-nowrap","items-center"],[1,"text-espressive-sm","text-neutral-black"],[1,"table-auto","w-full"],[1,"border-b","border-neutral-gray-1"],[1,"text-left","text-espressive-sm","text-neutral-gray-4","py-3"],[1,"text-right","text-espressive-sm","text-neutral-gray-4","py-3"],[1,"flex","justify-end","items-center","gap-x-6","bg-secondary-3-1","py-1","px-2"],[1,"text-heading-md"],[1,"text-body-md","text-neutral-black","py-3"],[1,"text-right","text-body-md","text-neutral-black","py-3"],[1,"flex","flex-col"],[1,"flex","justify-around","items-center"],[1,"w-full","flex","justify-center","py-2.5"],[1,"w-full","flex","justify-center","py-2.5","text-heading-md","text-neutral-gray-6"],[1,"w-full","flex","justify-center","py-2.5","text-heading-md","text-secondary-3-3"],[1,"text-heading-sm","py-1","px-3","bg-neutral-gray-1","flex","gap-x-2","items-center","justify-center","w-fit","rounded"],["icon","arrow_right","size","small"],[1,"flex","justify-around","items-center","bg-neutral-gray-0.5"],[1,"w-full","flex","justify-center","py-2.5","text-primary-1-4"]],template:function(t,i){1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3),e._uU(4,"Th\xf4ng tin chuy\u1ebfn bay"),e.qZA(),e.TgZ(5,"cf-icon",4),e.NdJ("click",function(){return i.onClose()}),e.qZA()(),e.TgZ(6,"div",5)(7,"div",6)(8,"div",7),e.NdJ("click",function(){return i.currentIndex="JOURNEY_DETAIL"}),e._uU(9," Chi ti\u1ebft h\xe0nh tr\xecnh m\u1edbi "),e.qZA(),e.TgZ(10,"div",7),e.NdJ("click",function(){return i.currentIndex="COMPARE_JOURNEY"}),e._uU(11," So s\xe1nh v\u1edbi h\xe0nh tr\xecnh c\u0169 "),e.qZA()()(),e.TgZ(12,"div"),e.YNc(13,ie,8,2,"div",8),e.YNc(14,ae,75,32,"div",9),e.qZA(),e.TgZ(15,"div",10)(16,"button",11),e.NdJ("click",function(){return i.onClose()}),e._uU(17," \u0110\xf3ng "),e.qZA()()()()),2&t&&(e.xp6(8),e.ekj("bg-secondary-3-5","JOURNEY_DETAIL"===i.currentIndex)("border-secondary-3-5","JOURNEY_DETAIL"===i.currentIndex)("text-neutral-white","JOURNEY_DETAIL"===i.currentIndex),e.xp6(2),e.ekj("bg-secondary-3-5","COMPARE_JOURNEY"===i.currentIndex)("border-secondary-3-5","COMPARE_JOURNEY"===i.currentIndex)("text-neutral-white","COMPARE_JOURNEY"===i.currentIndex),e.xp6(3),e.Q6J("ngIf","JOURNEY_DETAIL"===i.currentIndex),e.xp6(1),e.Q6J("ngIf","COMPARE_JOURNEY"===i.currentIndex))},dependencies:[T.ez,T.sg,T.O5,T.JJ,v.AxE,v.Sm8,D.N8,D.Xq],encapsulation:2}),n})();var ne=g(27849),M=g(80529),oe=g(88001),B=g(50494),O=g(54004),le=g(56322),F=g(97582),S=g(87067);let se=(()=>{class n{}return(0,F.gn)([(0,S.C)()],n.prototype,"status",void 0),(0,F.gn)([(0,S.C)()],n.prototype,"data",void 0),(0,F.gn)([(0,S.C)()],n.prototype,"objectError",void 0),(0,F.gn)([(0,S.C)()],n.prototype,"success",void 0),n})();const U={headers:new M.WM({"Content-Type":"application/json"})};let ue=(()=>{class n{constructor(t,i){this.http=t,this.appConfig=i}getListJourneyUpdate(t){return this.http.post(this.appConfig.apiUrl+"flight/get-list-update-journey",JSON.stringify(t),U).pipe((0,O.U)(i=>(0,B.yE)(le.sH,i,{excludeExtraneousValues:!0})))}quotationJourneyUpdate(t){return this.http.post(this.appConfig.apiUrl+"ticket/quotation-update-journey",JSON.stringify(t),U)}updateJourney(t){return this.http.post(this.appConfig.apiUrl+"ticket/update-journey-reservation",JSON.stringify(t),U).pipe((0,O.U)(i=>(0,B.yE)(se,i,{excludeExtraneousValues:!0})))}}return n.\u0275fac=function(t){return new(t||n)(e.LFG(M.eN),e.LFG(oe.qB))},n.\u0275prov=e.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();var ce=g(85114),de=g(28490),ge=g(62733),pe=g(62331),he=g(82761);function fe(n,d){1&n&&(e.TgZ(0,"div",31),e._UZ(1,"cf-icon",32),e.TgZ(2,"div",33),e._uU(3,"\u0110\u1ed5i h\xe0nh tr\xecnh s\u1ebd \xe1p d\u1ee5ng cho t\u1ea5t c\u1ea3 h\xe0nh kh\xe1ch c\xf3 chung m\xe3 \u0111\u1eb7t ch\u1ed7"),e.qZA()())}function me(n,d){if(1&n&&(e.TgZ(0,"div",26)(1,"div",34),e._UZ(2,"cf-icon",35),e.TgZ(3,"div",36),e._uU(4,"H\xe0nh tr\xecnh hi\u1ec7n t\u1ea1i"),e.qZA()(),e.TgZ(5,"div",37),e._uU(6),e._UZ(7,"cf-icon",38),e._uU(8),e.ALo(9,"date"),e.qZA()()),2&n){const t=e.oxw();e.xp6(6),e.hij(" ",null==t.reroutingJourneySeleceted?null:t.reroutingJourneySeleceted.startPointCode," "),e.xp6(2),e.AsE(" ",null==t.reroutingJourneySeleceted?null:t.reroutingJourneySeleceted.endPointCode," \u30fb ",e.xi3(9,3,null==t.reroutingJourneySeleceted?null:t.reroutingJourneySeleceted.startTime,"HH:mm dd/MM/yyyy")," \u30fb 1 ch\u1eb7ng ")}}function ve(n,d){1&n&&(e.TgZ(0,"div",39)(1,"div"),e.O4$(),e.TgZ(2,"svg",40),e._UZ(3,"path",41)(4,"path",42)(5,"path",43),e.qZA()(),e.kcU(),e.TgZ(6,"div",33)(7,"p"),e._uU(8,"1. H\u1ec7 th\u1ed1ng s\u1ebd t\u1ef1 \u0111\u1ed9ng hu\u1ef7 d\u1ecbch v\u1ee5 H\xe0nh l\xfd v\xe0 Ch\u1ed7 ng\u1ed3i. Qu\xfd \u0111\u1ea1i l\xfd c\xf3 th\u1ec3 ch\u1ecdn d\u1ecbch v\u1ee5 c\u1ed9ng th\xeam sau"),e.qZA(),e.TgZ(9,"p"),e._uU(10,"2. Ti\u1ec1n ch\xeanh l\u1ec7ch khi \u0111\u1ed5i sang h\xe0nh tr\xecnh r\u1ebb h\u01a1n s\u1ebd kh\xf4ng \u0111\u01b0\u1ee3c c\u1ea5n tr\u1eeb. \u0110\u1ea1i l\xfd c\xf3 th\u1ec3 c\xe2n nh\u1eafn c\xe1c l\u1ef1a ch\u1ecdn kh\xe1c (hu\u1ef7 h\xe0nh tr\xecnh r\u1ed3i th\xeam m\u1edbi) \u0111\u1ec3 t\u1ed1i \u01b0u chi ph\xed"),e.qZA()()())}function xe(n,d){if(1&n){const t=e.EpF();e.ynx(0),e.TgZ(1,"div",45)(2,"div",46),e._UZ(3,"img",47),e.TgZ(4,"div",48),e._uU(5),e.qZA()(),e.TgZ(6,"div",49)(7,"div",50)(8,"div",51),e._UZ(9,"cf-icon",52),e.TgZ(10,"div",53)(11,"div"),e._uU(12),e.qZA(),e._UZ(13,"cf-icon",38),e.TgZ(14,"div"),e._uU(15),e.qZA()()(),e.TgZ(16,"div",51),e._UZ(17,"cf-icon",54),e.TgZ(18,"div",55),e._uU(19),e.ALo(20,"date"),e.qZA()(),e.TgZ(21,"div",51),e._UZ(22,"cf-icon",56),e.TgZ(23,"div",55),e._uU(24),e.qZA()()(),e._UZ(25,"div",57),e.TgZ(26,"div",58)(27,"div")(28,"div",59),e._uU(29,"T\xecnh tr\u1ea1ng"),e.qZA(),e.TgZ(30,"div",60),e._uU(31),e.qZA()(),e.TgZ(32,"cf-radio",61),e.NdJ("checkChange",function(){const r=e.CHM(t).$implicit,l=e.oxw(2);return e.KtG(l.onChangeJourney(r))}),e.qZA()()()(),e.BQk()}if(2&n){const t=d.$implicit;e.xp6(3),e.Q6J("src",t.airlineLogo,e.LSH),e.xp6(2),e.AsE("",t.airline," - ",t.airlineName,""),e.xp6(7),e.AsE("",t.startPointName," (",t.startPointCode,")"),e.xp6(3),e.AsE("",t.endPointName," (",t.endPointCode,")"),e.xp6(4),e.hij(" ",e.xi3(20,12,t.startTime,"HH:mm dd/MM/yyyy")," "),e.xp6(5),e.hij(" ",t.redirectType," "),e.xp6(7),e.Oqu(t.statusText),e.xp6(1),e.Q6J("checked",t.selected)("value",t.journeyKey)}}const Y=function(){return[]};function Te(n,d){if(1&n&&(e.TgZ(0,"div",0),e.YNc(1,xe,33,15,"ng-container",44),e.qZA()),2&n){const t=e.oxw();e.xp6(1),e.Q6J("ngForOf",(null==t.bookingDetailReroutingData?null:t.bookingDetailReroutingData.journeys)||e.DdM(1,Y))}}function ye(n,d){if(1&n){const t=e.EpF();e.TgZ(0,"app-ticket-item",85),e.NdJ("ticketSelected",function(a){e.CHM(t);const r=e.oxw(5);return e.KtG(r.chooseTicket(a))}),e.qZA()}if(2&n){const t=e.oxw().$implicit,i=e.oxw(4);e.Q6J("ticket",t)("listFareRule",i.listFareRule)("listFareRuleClasses",i.listFareRuleClasses)}}function Ce(n,d){if(1&n&&(e.ynx(0),e.YNc(1,ye,1,3,"app-ticket-item",84),e.BQk()),2&n){const t=d.$implicit,i=d.index,a=e.oxw(4);e.xp6(1),e.Q6J("ngIf",i<a.ticketInfiniteScrollCount&&t.seatRemain>0)}}function _e(n,d){if(1&n){const t=e.EpF();e.TgZ(0,"div",82),e.NdJ("scrolled",function(){e.CHM(t);const a=e.oxw(3);return e.KtG(a.onScrollDown())}),e.YNc(1,Ce,2,1,"ng-container",83),e.qZA()}if(2&n){const t=e.oxw(3);e.Q6J("infiniteScrollDistance",1)("infiniteScrollThrottle",300)("infiniteScrollContainer",".main-scroll-bar")("scrollWindow",!1)("fromRoot",!0)("alwaysCallback",!0),e.xp6(1),e.Q6J("ngForOf",t.listTicketDisplay)("ngForTrackBy",t.ticketTrackByFn)}}function Ze(n,d){if(1&n&&(e.TgZ(0,"div"),e.YNc(1,_e,2,8,"div",81),e.qZA()),2&n){const t=e.oxw(2);e.xp6(1),e.Q6J("ngIf",t.listTicketDisplay.length)}}function De(n,d){if(1&n){const t=e.EpF();e.TgZ(0,"agent-ticket-item",85),e.NdJ("ticketSelected",function(a){e.CHM(t);const r=e.oxw(5);return e.KtG(r.chooseAgentTicket(a))}),e.qZA()}if(2&n){const t=e.oxw().$implicit,i=e.oxw(4);e.Q6J("ticket",t)("listFareRule",i.listFareRule)("listFareRuleClasses",i.listFareRuleClasses)}}function be(n,d){if(1&n&&(e.ynx(0),e.YNc(1,De,1,3,"agent-ticket-item",84),e.BQk()),2&n){const t=d.index,i=e.oxw(4);e.xp6(1),e.Q6J("ngIf",t<i.ticketInfiniteScrollCount)}}function Ae(n,d){if(1&n){const t=e.EpF();e.TgZ(0,"div",82),e.NdJ("scrolled",function(){e.CHM(t);const a=e.oxw(3);return e.KtG(a.onScrollDown())}),e.YNc(1,be,2,1,"ng-container",44),e.qZA()}if(2&n){const t=e.oxw(3);e.Q6J("infiniteScrollDistance",1)("infiniteScrollThrottle",300)("infiniteScrollContainer",".main-scroll-bar")("scrollWindow",!1)("fromRoot",!0)("alwaysCallback",!0),e.xp6(1),e.Q6J("ngForOf",t.listTicketAgentDisplay)}}function Ee(n,d){if(1&n&&(e.TgZ(0,"div"),e.YNc(1,Ae,2,7,"div",81),e.qZA()),2&n){const t=e.oxw(2);e.xp6(1),e.Q6J("ngIf",t.listTicketAgentDisplay.length)}}function Fe(n,d){if(1&n&&(e.TgZ(0,"div",77)(1,"div",78),e._uU(2,"T\u1ed5ng chi ph\xed:"),e.qZA(),e.TgZ(3,"div",86),e._uU(4),e.ALo(5,"replace"),e.ALo(6,"number"),e.qZA()()),2&n){const t=e.oxw(2);e.xp6(4),e.hij(" ",e.Dn7(5,1,e.lcZ(6,5,t.totalPrice||0),",",".")," \u0111 ")}}function Se(n,d){if(1&n){const t=e.EpF();e.TgZ(0,"div",62)(1,"div",63),e._UZ(2,"div"),e.TgZ(3,"div",64)(4,"div",65),e._UZ(5,"cf-search-flight-input",66),e.qZA(),e.TgZ(6,"button",67),e.NdJ("click",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.onResearchFlight())}),e._UZ(7,"cf-icon",68),e.TgZ(8,"div",69),e._uU(9," T\xecm chuy\u1ebfn bay "),e.qZA()()()(),e.TgZ(10,"div",70)(11,"div",71)(12,"app-filter-flight",72),e.NdJ("ticketFilterChange",function(a){e.CHM(t);const r=e.oxw();return e.KtG(r.filterChange(a))})("ticketDisplayChange",function(a){e.CHM(t);const r=e.oxw();return e.KtG(r.displayChange(a))}),e.qZA()(),e.TgZ(13,"div",65)(14,"div",73)(15,"app-switch-mode",74),e.NdJ("modeChange",function(a){e.CHM(t);const r=e.oxw();return e.KtG(r.modeChange(a))}),e.qZA()(),e.YNc(16,Ze,2,1,"div",30),e.YNc(17,Ee,2,1,"div",30),e.qZA(),e.TgZ(18,"div",75)(19,"div",76)(20,"div",77)(21,"div",78),e._uU(22,"Chuy\u1ebfn bay c\u1ee7a b\u1ea1n"),e.qZA()(),e.TgZ(23,"div")(24,"tickets-selected",79),e.NdJ("reselect",function(a){e.CHM(t);const r=e.oxw();return e.KtG(r.onReselected(a))}),e.qZA()(),e.YNc(25,Fe,7,7,"div",80),e.qZA()()()()}if(2&n){const t=e.oxw();e.xp6(5),e.Q6J("formArray",t.searchInputForm),e.xp6(7),e.Q6J("currentMode",t.currentMode)("airlineList",t.airlineList)("ticketFilter",t.ticketFilterState.value)("ticketDisplay",t.ticketDisplayState.value)("fareclassList",t.fareclassList)("planeModelList",t.planModelList)("selectedFare",t.selectedFare)("departureTimeList",t.departureTimeList)("arrivalTimeList",t.arrivalTimeList)("durationFilter",t.durationFilter)("minDuration",t.minDuration)("maxDuration",t.maxDuration)("departTimeComboList",t.departTimeComboList)("arriveTimeComboList",t.arriveTimeComboList)("minFareClss",t.minFareClss)("priceFilter",t.priceFilter)("minPrice",t.minPrice)("maxPrice",t.maxPrice)("bookingSystemList",t.bookingSystemList)("priceFilter",t.priceFilter),e.xp6(3),e.Q6J("modeView",t.currentMode)("disableAgencyMode",!1),e.xp6(1),e.Q6J("ngIf","retail"===t.currentMode),e.xp6(1),e.Q6J("ngIf","agency"===t.currentMode),e.xp6(7),e.Q6J("ticketsSelected",t.listTicketSelected),e.xp6(1),e.Q6J("ngIf",!t.isHiddenTotalCharge)}}function ke(n,d){if(1&n&&(e.TgZ(0,"tr")(1,"td",104),e._uU(2),e.qZA(),e.TgZ(3,"td",104),e._uU(4),e.qZA(),e.TgZ(5,"td",104),e._uU(6),e.ALo(7,"number"),e.qZA(),e.TgZ(8,"td",104),e._uU(9),e.ALo(10,"number"),e.qZA(),e.TgZ(11,"td",105),e._uU(12),e.ALo(13,"number"),e.qZA()()),2&n){const t=d.$implicit;e.xp6(2),e.Oqu(t.name),e.xp6(2),e.Oqu(t.type),e.xp6(2),e.Oqu(e.lcZ(7,5,t.baseFare)),e.xp6(3),e.Oqu(e.lcZ(10,7,t.taxFee)),e.xp6(3),e.Oqu(e.lcZ(13,9,t.totalPrice))}}function Ue(n,d){if(1&n&&(e.TgZ(0,"div",106)(1,"div",107)(2,"div",108),e._uU(3," Ph\xed h\xe0nh tr\xecnh m\u1edbi "),e._UZ(4,"cf-icon",109),e.qZA(),e.TgZ(5,"div",110),e._uU(6),e.ALo(7,"number"),e.qZA()(),e.TgZ(8,"div",107)(9,"div",108),e._uU(10," Ph\xed d\u1ecbch v\u1ee5 "),e._UZ(11,"cf-icon",109),e.qZA(),e.TgZ(12,"div",110),e._uU(13),e.ALo(14,"number"),e.qZA()(),e.TgZ(15,"div",107)(16,"div",108),e._uU(17," Ph\xed \u0111\u1ed5i h\xe0nh tr\xecnh "),e._UZ(18,"cf-icon",109),e.qZA(),e.TgZ(19,"div",110),e._uU(20),e.ALo(21,"number"),e.qZA()(),e.TgZ(22,"div",107)(23,"div",111),e._uU(24," T\u1ed5ng ph\xed "),e._UZ(25,"cf-icon",109),e.qZA(),e.TgZ(26,"div",112),e._uU(27),e.ALo(28,"number"),e.qZA()()()),2&n){const t=e.oxw(2);e.xp6(6),e.hij("",e.lcZ(7,4,t.paymentDetailBooked.newJourneyCharge)," \u0111"),e.xp6(7),e.hij("",e.lcZ(14,6,t.paymentDetailBooked.serviceFee)," \u0111"),e.xp6(7),e.hij("",e.lcZ(21,8,t.paymentDetailBooked.modifyCharge)," \u0111"),e.xp6(7),e.hij("",e.lcZ(28,10,t.paymentDetailBooked.totalCharge)," \u0111")}}function Pe(n,d){if(1&n&&(e.TgZ(0,"div",106)(1,"div",107)(2,"div",108),e._uU(3," Ph\xed h\xe0nh tr\xecnh m\u1edbi "),e._UZ(4,"cf-icon",109),e.qZA(),e.TgZ(5,"div",110),e._uU(6),e.ALo(7,"number"),e.qZA()(),e.TgZ(8,"div",107)(9,"div",108),e._uU(10," Ph\xed h\xe0nh tr\xecnh c\u0169 \u0111\xe3 thanh to\xe1n "),e._UZ(11,"cf-icon",109),e.qZA(),e.TgZ(12,"div",113),e._uU(13),e.ALo(14,"number"),e.qZA()(),e.TgZ(15,"div",107)(16,"div",108),e._uU(17," Ti\u1ec1n ch\xeanh l\u1ec7ch ph\u1ea3i tr\u1ea3 th\xeam "),e._UZ(18,"cf-icon",109),e.qZA(),e.TgZ(19,"div",114),e._uU(20),e.ALo(21,"number"),e.qZA()(),e.TgZ(22,"div",107)(23,"div",108),e._uU(24," Ph\xed \u0111\u1ed5i h\xe0nh tr\xecnh "),e._UZ(25,"cf-icon",109),e.qZA(),e.TgZ(26,"div",114),e._uU(27),e.ALo(28,"number"),e.qZA()(),e.TgZ(29,"div",107)(30,"div",111),e._uU(31," T\u1ed5ng ph\xed "),e._UZ(32,"cf-icon",109),e.qZA(),e.TgZ(33,"div",112),e._uU(34),e.ALo(35,"number"),e.qZA()()()),2&n){const t=e.oxw(2);e.xp6(6),e.hij("",e.lcZ(7,5,t.paymentDetailIssued.newJourneyCharge)," \u0111"),e.xp6(7),e.hij("",e.lcZ(14,7,t.paymentDetailIssued.oldJourneyCharge)," \u0111"),e.xp6(7),e.hij("",e.lcZ(21,9,t.paymentDetailIssued.gapCharge)," \u0111"),e.xp6(7),e.hij("",e.lcZ(28,11,t.paymentDetailIssued.modifyCharge)," \u0111"),e.xp6(7),e.hij("",e.lcZ(35,13,t.paymentDetailIssued.totalCharge)," \u0111")}}function Ne(n,d){if(1&n){const t=e.EpF();e.TgZ(0,"div",0)(1,"div",87)(2,"div",88)(3,"div",89),e._UZ(4,"cf-icon",90),e.TgZ(5,"div"),e._uU(6,"Chi ph\xed h\xe0nh tr\xecnh m\u1edbi"),e.qZA()(),e.TgZ(7,"div",91)(8,"button",27),e.NdJ("click",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.showJourneyModify("JOURNEY_DETAIL"))}),e._UZ(9,"cf-icon",92),e._uU(10," Xem chi ti\u1ebft "),e.qZA(),e.TgZ(11,"button",27),e.NdJ("click",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.showJourneyModify("COMPARE_JOURNEY"))}),e._UZ(12,"cf-icon",93),e._uU(13," So s\xe1nh v\u1edbi h\xe0nh tr\xecnh c\u0169 "),e.qZA()()(),e.TgZ(14,"div",94)(15,"table",95)(16,"thead")(17,"tr",96)(18,"th",97),e._uU(19,"H\xe0nh kh\xe1ch"),e.qZA(),e.TgZ(20,"th",97),e._uU(21,"Lo\u1ea1i kh\xe1ch"),e.qZA(),e.TgZ(22,"th",97),e._uU(23,"Gi\xe1 v\xe9"),e.qZA(),e.TgZ(24,"th",97),e._uU(25,"Thu\u1ebf ph\xed"),e.qZA(),e.TgZ(26,"th",98),e._uU(27,"T\u1ed5ng gi\xe1"),e.qZA()()(),e.TgZ(28,"tbody"),e.YNc(29,ke,14,11,"tr",44),e.qZA()(),e.TgZ(30,"div",99)(31,"div",33),e._uU(32,"Ph\xed h\xe0nh tr\xecnh m\u1edbi"),e.qZA(),e.TgZ(33,"div",100),e._uU(34),e.ALo(35,"number"),e.qZA()()()(),e.TgZ(36,"div",101)(37,"div",102),e._UZ(38,"cf-icon",90),e._uU(39," Chi ti\u1ebft thanh to\xe1n "),e.qZA(),e.YNc(40,Ue,29,12,"div",103),e.YNc(41,Pe,36,15,"div",103),e.qZA()()}if(2&n){const t=e.oxw();e.xp6(29),e.Q6J("ngForOf",t.bookingDetailReroutingData.passengers||e.DdM(6,Y)),e.xp6(5),e.hij("",e.lcZ(35,4,(null==t.listTicketSelected[0]||null==t.listTicketSelected[0].ticketPrice?null:t.listTicketSelected[0].ticketPrice.totalCharge)||0)," \u0111"),e.xp6(6),e.Q6J("ngIf","BOOKED"===t.bookingDetailReroutingData.status),e.xp6(1),e.Q6J("ngIf","ISSUED"===t.bookingDetailReroutingData.status)}}function Je(n,d){if(1&n){const t=e.EpF();e.TgZ(0,"button",115),e.NdJ("click",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.onNextStep(1))}),e._uU(1," Ti\u1ebfp t\u1ee5c "),e._UZ(2,"cf-icon",116),e.qZA()}}function we(n,d){if(1&n){const t=e.EpF();e.TgZ(0,"button",115),e.NdJ("click",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.onNextStep(2))}),e._uU(1," Ti\u1ebfp t\u1ee5c "),e._UZ(2,"cf-icon",116),e.qZA()}}function Re(n,d){if(1&n){const t=e.EpF();e.TgZ(0,"button",115),e.NdJ("click",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.onNextStep(3))}),e._uU(1," Ti\u1ebfp t\u1ee5c "),e._UZ(2,"cf-icon",116),e.qZA()}}function qe(n,d){1&n&&e._UZ(0,"cf-spinner")}const Ie=function(n){return{"!w-full":n}};let Le=(()=>{class n{constructor(t,i,a,r,l,o,s,u,c,f){this._fb=i,this._requestReroutingService=a,this._reroutingService=r,this._searchInputService=l,this._locationDataService=o,this._flightDataService=s,this._modal=u,this._toastService=c,this._router=f,this.step=1,this.currentMode="retail",this.TICKET_INFINITE_SCROLL_DEFAULT=10,this.TICKET_INFINITE_OFSET_INCREASE=10,this.ticketInfiniteScrollCount=this.TICKET_INFINITE_SCROLL_DEFAULT,this.listTicket=[],this.listTicketDisplay=[],this.listTicketAgent=[],this.listTicketAgentDisplay=[],this.listTicketSelected=[],this.airlineList=[],this.destroy$=new $.x,this.ticketDisplayState=new R.X({showNetPrice:!1,showSalePrice:!1,hideFareClass:!1,showDuration:!0,showTotalComboPrice:!1}),this.fareclassList=[],this.planModelList=[],this.selectedFare={value:""},this.departureTimeList=[],this.arrivalTimeList=[],this.durationFilter=[0,50],this.minDuration=0,this.maxDuration=50,this.departTimeComboList=[],this.arriveTimeComboList=[],this.minFareClss="",this.priceFilter=[0,0],this.minPrice=0,this.maxPrice=0,this.bookingSystemList=[],this.filterStateInit={showAirline:[],direct:this._searchInputService.isDirectFlight,oneRoute:!1,moreRoute:!1,departTime:[],arriveTime:[],fareclass:[],bookingSystem:[],plane:[],comboTime:{departStartTime:{from:0,to:1440},arriveStartTime:{from:0,to:1440},departEndTime:{from:0,to:1440},arriveEndTime:{from:0,to:1440}},comboDuration:{from:0,to:50},comboPrice:{from:void 0,to:void 0}},this.numberOfPassenger={adult:1,child:0,infant:0},this.isLoading=!1,this.isHiddenTotalCharge=!1,this.totalPrice=0,this.paymentDetailBooked={newJourneyCharge:0,serviceFee:0,modifyCharge:0,totalCharge:0},this.paymentDetailIssued={newJourneyCharge:0,oldJourneyCharge:0,gapCharge:0,modifyCharge:0,totalCharge:0},t.registerIcons([v.gW0,v.s5C,v.Ffn,v.rks,v.wvd,v.okA,v.toh,v.UNF,v.QkI,v.ILM,v.o1t,v.B2I]),this.bookingDetailReroutingData=this._requestReroutingService.getBookingDetailReroutingData(),console.log(this.bookingDetailReroutingData)}ngOnInit(){this.createInstanceSearchForm(),this.ticketFilterState=new R.X(this.filterStateInit),this.ticketFilterState.pipe((0,j.R)(this.destroy$)).subscribe({next:()=>{this.loadTicketFilter()}})}createInstanceSearchForm(){this.searchInputForm=this._fb.array([this._fb.group({startPoint:["",C.kI.required],endPoint:["",C.kI.required],departDate:["",C.kI.required],returnDate:[""]})])}onNextStep(t){var i;switch(t){case 1:this.step=2,this.currentMode="retail",this.reroutingJourneySeleceted=this.bookingDetailReroutingData.journeys.find(r=>r.selected),this.reroutingJourneySeleceted&&(this.searchInputForm.clear(),this.searchInputForm.push(this._fb.group({startPoint:[this.reroutingJourneySeleceted.startPointCode,C.kI.required],endPoint:[this.reroutingJourneySeleceted.endPointCode,C.kI.required],departDate:[this.reroutingJourneySeleceted.startTime,C.kI.required],returnDate:[""]})),this.onResearchFlight());break;case 2:const a=null===(i=this.listTicketSelected[0].ticketPrice)||void 0===i?void 0:i.details;this.bookingDetailReroutingData.passengers.forEach(r=>{if("ADULT"===r.type){const l=null==a?void 0:a.find(o=>o.type.includes("ADT"));l&&(r.baseFare=l.baseFare,r.taxFee=l.surCharge,r.totalPrice=l.totalFare)}}),this.quotationUpdateJourney();break;case 3:this.updateJourneyReservation()}}onBack(){this.step=this.step>1?this.step-1:1}onCancel(){this._modal.open(q.V0,{title:"X\xe1c nh\u1eadn h\u1ee7y d\u1ecbch v\u1ee5",body:"B\u1ea1n c\xf3 ch\u1eafc ch\u1eafn mu\u1ed1n h\u1ee7y d\u1ecbch v\u1ee5 \u0110\u1ed5i h\xe0nh tr\xecnh?",okText:"C\xf3, h\u1ee7y d\u1ecbch v\u1ee5",cancelText:"Kh\xf4ng"}).afterClosed$.subscribe({next:i=>{i.data&&this._router.navigate([`admin/booking-detail/${this.bookingDetailReroutingData.airline}/${this.bookingDetailReroutingData.bookingCode}`])}})}onScrollDown(){this.ticketInfiniteScrollCount+=this.TICKET_INFINITE_OFSET_INCREASE}ticketTrackByFn(t,i){return i.indexForTracking}onChangeJourney(t){t.selected||(this.bookingDetailReroutingData.journeys.forEach(i=>{i.selected=i.journeyKey===t.journeyKey}),this.reroutingJourneySeleceted=this.bookingDetailReroutingData.journeys.find(i=>i.selected),this._requestReroutingService.setBookingDetailReroutingData(this.bookingDetailReroutingData))}onResearchFlight(){var t;this.listTicketSelected=[],this.totalPrice=0,this.isLoading=!0;const i=this.searchInputForm.value[0],a={airline:this.bookingDetailReroutingData.airline,bookingCode:this.bookingDetailReroutingData.bookingCode,journeyKey:(null===(t=this.reroutingJourneySeleceted)||void 0===t?void 0:t.journeyKey)||"",flightUpdate:{departDate:i.departDate?h(i.departDate).format("YYYY-MM-DD"):"",startPoint:(null==i?void 0:i.startPoint)||"",endPoint:(null==i?void 0:i.endPoint)||""}};this._reroutingService.getListJourneyUpdate(a).pipe((0,k.x)(()=>this.isLoading=!1)).subscribe({next:r=>{var l,o;console.log(r),this.searchFlightData=r.data,this.listFareRule=null===(l=r.data)||void 0===l?void 0:l.fareRules,this.listFareRuleClasses=null===(o=r.data)||void 0===o?void 0:o.fareRuleClasses,this.convertTicket(),this.convertAgentTicket(),this.initFilterAirline()}})}initFilterAirline(){var t;let i=[{name:"Early Morning",code:"early_morning",start:"00:00",end:"06:00",isActive:!1,disable:!1,startTime:0,endTime:360,totalAvailable:0},{name:"Morning",code:"morning",start:"06:00",end:"12:00",isActive:!1,disable:!1,startTime:360,endTime:720,totalAvailable:0},{name:"Afternoon",code:"afternoon",start:"12:00",end:"18:00",isActive:!1,disable:!1,startTime:720,endTime:1080,totalAvailable:0},{name:"Evening",code:"evening",start:"18:00",end:"24:00",isActive:!1,disable:!1,startTime:1080,endTime:1440,totalAvailable:0}],a=[{name:"Early Morning",code:"early_morning",start:"00:00",end:"06:00",isActive:!1,disable:!1,startTime:0,endTime:360,totalAvailable:0},{name:"Morning",code:"morning",start:"06:00",end:"12:00",isActive:!1,disable:!1,startTime:360,endTime:720,totalAvailable:0},{name:"Afternoon",code:"afternoon",start:"12:00",end:"18:00",isActive:!1,disable:!1,startTime:720,endTime:1080,totalAvailable:0},{name:"Evening",code:"evening",start:"18:00",end:"24:00",isActive:!1,disable:!1,startTime:1080,endTime:1440,totalAvailable:0}],r=[];this.searchFlightData.flightOptions.length&&"COMBO"!==this.searchFlightData.flightOptions[0].type&&(r=this.searchFlightData.flightOptions.flatMap(c=>c.journeys).map(c=>({airline:c.airline,airlineName:c.airlineName})).filter((c,f,x)=>x.findIndex(m=>m.airline===c.airline)===f));let l=new Map,o=Number.MAX_SAFE_INTEGER,s=new Set,u=new Map;this.searchFlightData.flightOptions.length&&"COMBO"!==this.searchFlightData.flightOptions[0].type&&this.searchFlightData.flightOptions.forEach(c=>{s.add(c.provider),c.journeys.forEach(f=>f.fareOptions.forEach(x=>{x.fareInfos.forEach(m=>{var p,y,_,A,P,N,J;x.getTotalAmount()<o&&(o=x.getTotalAmount(),m.cabin&&!(null===(p=m.cabin)||void 0===p)&&p.name&&(this.minFareClss=m.cabin.name.toUpperCase())),l.set(null===(_=null===(y=m.cabin)||void 0===y?void 0:y.name)||void 0===_?void 0:_.toUpperCase(),Object.assign(Object.assign({},m.cabin),{description:null===(P=null===(A=m.cabin)||void 0===A?void 0:A.description)||void 0===P?void 0:P.toUpperCase(),name:null===(J=null===(N=m.cabin)||void 0===N?void 0:N.name)||void 0===J?void 0:J.toUpperCase(),isActive:!1,isDisable:!1}))}),f.segments.forEach(m=>{u.set(m.modelAirplane,{code:m.modelAirplane,name:m.modelAirplaneName,isActive:!1,isDisable:!1})}),i.forEach(m=>{const p=h(f.departure.localTime).toDate(),y=60*p.getHours()+p.getMinutes();y>=m.startTime&&y<=m.endTime&&(m.totalAvailable=++m.totalAvailable)}),a.forEach(m=>{const p=h(f.arrival.localTime).toDate(),y=60*p.getHours()+p.getMinutes();y>=m.startTime&&y<=m.endTime&&(m.totalAvailable=++m.totalAvailable)})}))}),this.fareclassList=[...l.values()].filter(c=>c.name).map(c=>c),this.selectedFare.value=(null===(t=this.fareclassList.find(c=>c.isActive))||void 0===t?void 0:t.name)||"",this.planModelList=[...u.values()],this.departTimeComboList=this.bookingDetailReroutingData.journeys.map(c=>({departCode:`${c.startPointCode} (${c.startPointName})`,departTime:c.startTime})),this.arriveTimeComboList=this.bookingDetailReroutingData.journeys.map(c=>({departCode:`${c.endPointCode} (${c.endPointName})`,departTime:c.startTime})),this.airlineList=r.map(c=>({code:c.airline,name:c.airlineName,actived:!1})),this.airlineList.filter(c=>c.actived).length===this.airlineList.length?this.airlineList.forEach(c=>c.actived=!1):0!==this.airlineList.filter(c=>c.actived).length&&this.ticketFilterState.next(Object.assign(Object.assign({},this.ticketFilterState.value),{showAirline:this.airlineList.filter(c=>c.actived).map(c=>c.code)}))}convertTicket(){let t=0;this.listTicket=this.searchFlightData.flightOptions.flatMap(i=>i.journeys.flatMap(a=>{if(!a.fareOptions)return[];const r=a.fareOptions.map(s=>{var u,c,f,x;t++;const m=this.getFareRuleClass(a.airline,s.fareInfos[0].fareClass,null===(u=s.fareInfos[0].fareType)||void 0===u?void 0:u.code);return{indexForTracking:t,provider:i.provider,airline:a.airline,airlineLogo:this._flightDataService.getAirlineLogoByCode(a.airline),mobileAirlineLogo:["VJ","VN","QH"].includes(a.airline)?"assets/airline-logo/"+a.airline+"_small.png":"assets/airline-logo/"+a.airline+".png",airlineName:a.airlineName,flightNumber:`${a.airline} ${a.segments[0].flightNumber}`,operating:a.operating,operatingName:a.operatingName,stopStatus:a.numOfStops,duration:a.duration,durationStr:a.getDurationString(),startPoint:a.departure.airport.code,endPoint:a.arrival.airport.code,startTime:h(a.departure.localTime).toDate(),endTime:h(a.arrival.localTime).toDate(),expireTime:a.expireTime,totalPrice:s.getTotalAmount(),netPrice:s.getNetAmount(this.numberOfPassenger.adult,this.numberOfPassenger.child),serviceFee:s.getServiceFee(),promotionalPrice:0!==s.getDiscount()?s.getTotalAmount()+s.getDiscount():void 0,currency:s.currency?s.currency.code:"VN\u0110",fareClass:s.fareInfos[0].fareClass,fareType:null===(c=s.fareInfos[0].fareType)||void 0===c?void 0:c.code,journeyFareClass:s.journeyFareClass,handBag:m.handBag,checkedBag:m.checkedBag,seatRemain:s.fareInfos[0].seatRemain,cabin:null===(f=s.fareInfos[0].cabin)||void 0===f?void 0:f.description,cabinName:(null===(x=s.fareInfos[0].cabin)||void 0===x?void 0:x.name)||"undefined",isLowestFare:!1,isLowestFareAvailable:!1,leg:a.leg,departure:{scheduleTime:h(1e3*a.departure.scheduleTime).toDate(),airport:a.departure.airport.code,localTime:h(a.departure.localTime).toDate()},arrival:{scheduleTime:h(1e3*a.arrival.scheduleTime).toDate(),airport:a.arrival.airport.code,localTime:h(a.arrival.localTime).toDate()},journeyKey:a.key,fareOptionKey:s.key,segments:a.segments.map((p,y)=>{var _;const A=p.getDelayString();return{segmentKey:p.key,fareClass:s.fareInfos[y].fareClass,fareType:(null===(_=s.fareInfos[y].fareType)||void 0===_?void 0:_.description)||"",airline:p.airline,airlineName:p.airlineName,mobileAirlineLogo:["VJ","VN","QH"].includes(p.airline)?"assets/airline-logo/"+p.airline+"_small.png":"assets/airline-logo/"+p.airline+".png",operating:p.operating,operatingName:p.operatingName,airlineLogo:this._flightDataService.getAirlineLogoByCode(p.operating),jetCode:"N/A",startCode:p.departure.airport.code,endCode:p.arrival.airport.code,startPoint:this._locationDataService.getCityNameByCode(p.departure.airport.code),endPoint:this._locationDataService.getCityNameByCode(p.arrival.airport.code),departDate:h(p.departure.localTime).toDate(),arrivalDate:h(p.arrival.localTime).toDate(),flightNumber:p.flightNumber,duration:p.getDurationString(),modelAirplane:p.modelAirplane,modelAirplaneName:p.modelAirplaneName,delay:p.getDelayString(),stopPoint:A?`D\u1eebng t\u1ea1i: ${this._locationDataService.getAirportNameByCode(p.departure.airport.code)} (${p.departure.airport.code}). Th\u1eddi gian d\u1eebng: ${A}`:""}}),showSalePrice:this.ticketDisplayState.value.showSalePrice,showNetPrice:this.ticketDisplayState.value.showNetPrice,hideFareClass:this.ticketDisplayState.value.hideFareClass,showDuration:this.ticketDisplayState.value.showDuration,ticketDetail:this.getTicketDetail(s,a.airline)}}),l=V.groupBy(r,"cabinName");for(const s of Object.keys(l)){const c=Math.min(...l[s].map(f=>f.totalPrice));r.filter(f=>f.cabinName===s).forEach(f=>{f.isLowestFare=f.totalPrice===c})}const o=Math.min(...r.filter(s=>s.seatRemain).map(s=>s.totalPrice));return r.forEach(s=>{s.isLowestFareAvailable=s.totalPrice===o}),r})).sort((i,a)=>i.totalPrice-a.totalPrice).sort((i,a)=>i.stopStatus-a.stopStatus),console.log(this.listTicket),this.listTicketDisplay=this.listTicket}convertAgentTicket(t=""){this.listTicketAgent=this.searchFlightData.flightOptions.flatMap((i,a)=>i.journeys.flatMap((r,l)=>({indexForTracking:`${r.airline}_${a}_${l}`,provider:i.provider,airline:r.airline,airlineName:this._flightDataService.getAirlineNameByCode(r.airline),airlineLogo:this._flightDataService.getAirlineLogoByCode(r.airline),mobileAirlineLogo:["VJ","VN","QH"].includes(r.airline)?"assets/airline-logo/"+r.airline+"_small.png":"assets/airline-logo/"+r.airline+".png",operating:r.operating,operatingName:r.operatingName,flightNumber:`${r.airline} ${r.segments[0].flightNumber}`,departure:{scheduleTime:h(1e3*r.departure.scheduleTime).toDate(),airport:r.departure.airport.code,localTime:h(r.departure.localTime).toDate()},arrival:{scheduleTime:h(1e3*r.arrival.scheduleTime).toDate(),airport:r.arrival.airport.code,localTime:h(r.arrival.localTime).toDate()},startPoint:r.departure.airport.code,endPoint:r.arrival.airport.code,duration:r.duration,expireTime:r.expireTime,durationStr:r.getDurationString(),numOfStop:r.numOfStops,numberOfSegment:r.segments.length,leg:r.leg,journeyKey:r.key,lookupSeatReamin:"VN"===r.airline,fareRule:this.listFareRule.find(o=>o.airline===r.airline)||null,segmentDetails:r.segments.map((o,s,u)=>{const c=o.getDelayString();return{segmentKey:o.key,airline:o.airline,airlineName:this._flightDataService.getAirlineNameByCode(o.airline),airlineLogo:this._flightDataService.getAirlineLogoByCode(r.airline),mobileAirlineLogo:["VJ","VN","QH"].includes(o.airline)?"assets/airline-logo/"+o.airline+"_small.png":"assets/airline-logo/"+o.airline+".png",jetCode:"N/A",startCode:o.departure.airport.code,endCode:o.arrival.airport.code,startPoint:this._locationDataService.getCityNameByCode(o.departure.airport.code),endPoint:this._locationDataService.getCityNameByCode(o.arrival.airport.code),departDate:h(o.departure.localTime).toDate(),arrivalDate:h(o.arrival.localTime).toDate(),flightNumber:o.flightNumber,duration:o.duration,durationStr:o.getDurationString(),modelAirplane:o.modelAirplane,modelAirplaneName:o.modelAirplaneName,operating:o.operating,operatingName:o.operatingName,stopPoint:c?`D\u1eebng t\u1ea1i: ${this._locationDataService.getAirportNameByCode(o.departure.airport.code)} (${o.departure.airport.code}). Th\u1eddi gian d\u1eebng: ${c}`:""}}),segmentsDisplay:["VJ","QH","VU"].includes(r.airline)?[{airline:r.airline,airlineLogo:this._flightDataService.getAirlineLogoByCode(r.airline),flightNumber:`${r.airline} ${r.segments[0].flightNumber}`,jetCode:"N/A",operating:r.operating,startPoint:r.departure.airport.code,endPoint:r.arrival.airport.code,segmentKey:void 0,fareClasses:r.fareOptions.map(o=>({totalPrice:o.getTotalAmount(),isExistPrice:!0,currency:o.currency?o.currency.code:"VN\u0110",segmentIndex:0,fareType:o.fareInfos[0].fareType.description,seatRemain:o.fareInfos[0].seatRemain,fareClass:o.fareInfos[0].fareClass,isSelected:!1,fareOptionKey:o.key,ticketPriceDetail:this.getTicketDetail(o,r.airline)})),departure:{scheduleTime:h(1e3*r.departure.scheduleTime).toDate(),airport:r.departure.airport.code,localTime:h(r.departure.localTime).toDate()},arrival:{scheduleTime:h(1e3*r.arrival.scheduleTime).toDate(),airport:r.arrival.airport.code,localTime:h(r.arrival.localTime).toDate()}}]:r.segments.map(o=>{var s;return{airline:o.airline,airlineLogo:this._flightDataService.getAirlineLogoByCode(o.airline),flightNumber:`${o.airline} ${o.flightNumber}`,jetCode:"N/A",operating:o.operating,startPoint:o.departure.airport.code,endPoint:o.arrival.airport.code,segmentKey:o.key,fareClasses:(null===(s=o.bookingClassArr)||void 0===s?void 0:s.reverse().map(u=>{const c=r.fareOptions&&r.fareOptions.length?r.fareOptions.find(f=>{var x;return(null===(x=f.fareInfos[0])||void 0===x?void 0:x.fareClass)===u.fareClass}):null;return{totalPrice:r.fareOptions&&-1!=r.fareOptions.findIndex(f=>f.fareInfos[0].fareClass===u.fareClass)?r.fareOptions.find(f=>f.fareInfos[0].fareClass===u.fareClass).getTotalAmount():0,isExistPrice:!(!r.fareOptions||-1==r.fareOptions.findIndex(f=>f.fareInfos[0].fareClass===u.fareClass)),currency:r.fareOptions?r.fareOptions[0].currency.code:"VN\u0110",fareType:"",segmentIndex:o.index,seatRemain:u.available,fareClass:u.fareClass,isSelected:!1,fareOptionKey:c?c.key:""}}))||[],departure:{scheduleTime:h(1e3*o.departure.scheduleTime).toDate(),airport:o.departure.airport.code,localTime:h(o.departure.localTime).toDate()},arrival:{scheduleTime:h(1e3*o.arrival.scheduleTime).toDate(),airport:o.arrival.airport.code,localTime:h(o.arrival.localTime).toDate()}}})}))),this.listTicketAgentDisplay=this.listTicketAgent,console.log(this.listTicketAgentDisplay)}getFareRuleClass(t,i,a){let r;r=this.listFareRuleClasses.find(s=>{var u;return t===s.airline&&(null==a?void 0:a.toLocaleUpperCase())===(null===(u=s.fareClass)||void 0===u?void 0:u.toLocaleUpperCase())})||null;const l=(null==r?void 0:r.rules.find(s=>"HAND_BAGGAGE"===s.cate))||null,o=(null==r?void 0:r.rules.find(s=>"CHECKED_BAGGAGE"===s.cate))||null;return{handBag:null==l?void 0:l.value,checkedBag:null==o?void 0:o.value}}getTicketDetail(t,i){const a=[];if(this.numberOfPassenger.adult){const l={type:"Ng\u01b0\u1eddi l\u1edbn (ADT)",quantity:this.numberOfPassenger.adult,baseFare:t.getBaseFare("ADULT",i),surCharge:t.getSurCharge("ADULT",i),totalFare:t.getTotalAmountByType("ADULT")*this.numberOfPassenger.adult};a.push(l)}if(this.numberOfPassenger.child){const l={type:"Tr\u1ebb em (CHD)",quantity:this.numberOfPassenger.child,baseFare:t.getBaseFare("CHILD",i),surCharge:t.getSurCharge("CHILD",i),totalFare:t.getTotalAmountByType("CHILD")*this.numberOfPassenger.child};a.push(l)}if(this.numberOfPassenger.infant){const l={type:"Em b\xe9 (INF)",quantity:this.numberOfPassenger.infant,baseFare:t.getBaseFare("INFANT",i),surCharge:t.getSurCharge("INFANT",i),totalFare:t.getTotalAmountByType("INFANT")*this.numberOfPassenger.infant};a.push(l)}return{totalCharge:a.reduce((l,o)=>l+o.totalFare,0),details:a}}loadTicketFilter(){this.listTicketDisplay=this.listTicket.filter(t=>0===this.ticketFilterState.value.showAirline.length||this.ticketFilterState.value.showAirline.includes(t.airline)).filter(t=>!!(!this.ticketFilterState.value.direct&&!this.ticketFilterState.value.oneRoute&&!this.ticketFilterState.value.moreRoute||this.ticketFilterState.value.direct&&0===t.stopStatus||this.ticketFilterState.value.oneRoute&&1===t.stopStatus||this.ticketFilterState.value.moreRoute&&t.stopStatus>1)).filter(t=>{if(0===t.leg){const i=60*t.departure.localTime.getHours()+t.departure.localTime.getMinutes();if(i<this.ticketFilterState.value.comboTime.departStartTime.from||i>this.ticketFilterState.value.comboTime.departStartTime.to)return!1;const a=60*t.arrival.localTime.getHours()+t.arrival.localTime.getMinutes();if(a<this.ticketFilterState.value.comboTime.departEndTime.from||a>this.ticketFilterState.value.comboTime.departEndTime.to)return!1}if(1===t.leg){const i=60*t.departure.localTime.getHours()+t.departure.localTime.getMinutes(),a=60*t.arrival.localTime.getHours()+t.arrival.localTime.getMinutes();if(i<this.ticketFilterState.value.comboTime.arriveStartTime.from||i>this.ticketFilterState.value.comboTime.arriveStartTime.to||a<this.ticketFilterState.value.comboTime.arriveEndTime.from||a>this.ticketFilterState.value.comboTime.arriveEndTime.to)return!1}return!0}).filter(t=>{var i,a;return this.ticketFilterState.value.fareclass.length>0&&"GDS"!==t.provider?this.ticketFilterState.value.fareclass.indexOf(null===(i=t.cabinName)||void 0===i?void 0:i.toUpperCase())>=0&&t.isLowestFare:null!==(a=this.ticketFilterState.value.fareclass)&&void 0!==a&&a.length||"GDS"===t.provider?t.isLowestFare:t.isLowestFareAvailable}).filter(t=>!(this.ticketFilterState.value.plane.length>0)||t.segments.map(i=>this.ticketFilterState.value.plane.indexOf(i.modelAirplane.toUpperCase())>=0).reduce((i,a)=>i||a,!1)).filter(t=>!(this.ticketFilterState.value.bookingSystem.length>0)||this.ticketFilterState.value.bookingSystem.map(i=>"GDS"===i?i===t.provider:"DOMESTIC"===i&&("VN"===t.provider||"VJ"===t.provider||"QH"===t.provider)).reduce((i,a)=>i||a,!1)).map(t=>Object.assign(Object.assign({},t),{showSalePrice:this.ticketDisplayState.value.showSalePrice,showNetPrice:this.ticketDisplayState.value.showNetPrice,hideFareClass:this.ticketDisplayState.value.hideFareClass,showDuration:this.ticketDisplayState.value.showDuration})),this.listTicketAgentDisplay=this.listTicketAgent.filter(t=>{const i=this.airlineList.map(a=>a.code.toLocaleLowerCase());return 0===i.length||i.includes(t.airline.toLowerCase())}).filter(t=>0===this.ticketFilterState.value.showAirline.length||this.ticketFilterState.value.showAirline.includes(t.airline)).filter(t=>!!(!this.ticketFilterState.value.direct&&!this.ticketFilterState.value.oneRoute&&!this.ticketFilterState.value.moreRoute||this.ticketFilterState.value.direct&&0===t.numOfStop||this.ticketFilterState.value.oneRoute&&1===t.numOfStop||this.ticketFilterState.value.moreRoute&&t.numOfStop>1)).filter(t=>{if(0===t.leg){const i=60*t.departure.localTime.getHours()+t.departure.localTime.getMinutes();if(i<this.ticketFilterState.value.comboTime.departStartTime.from||i>this.ticketFilterState.value.comboTime.departStartTime.to)return!1;const a=60*t.arrival.localTime.getHours()+t.arrival.localTime.getMinutes();if(a<this.ticketFilterState.value.comboTime.departEndTime.from||a>this.ticketFilterState.value.comboTime.departEndTime.to)return!1}if(1===t.leg){const i=60*t.departure.localTime.getHours()+t.departure.localTime.getMinutes(),a=60*t.arrival.localTime.getHours()+t.arrival.localTime.getMinutes();if(i<this.ticketFilterState.value.comboTime.arriveStartTime.from||i>this.ticketFilterState.value.comboTime.arriveStartTime.to||a<this.ticketFilterState.value.comboTime.arriveEndTime.from||a>this.ticketFilterState.value.comboTime.arriveEndTime.to)return!1}return!0}).filter(t=>{if(!this.ticketFilterState.value.plane.length)return!0;const i=t.segmentDetails.map(r=>r.modelAirplane);return!!this.ticketFilterState.value.plane.some(r=>i.includes(r))}),this.listTicketAgentDisplay=[...this.listTicketAgentDisplay],this.ticketInfiniteScrollCount=this.TICKET_INFINITE_SCROLL_DEFAULT}chooseTicket(t){console.log(t),this.getFareRuleClass(t.airline,t.fareClass,t.fareType),this.listTicketSelected=[{startPoint:t.startPoint,endPoint:t.endPoint,departDate:t.departDate,startCode:t.startCode,endCode:t.endCode,airlineLogo:t.airlineLogo,provider:t.provider,airline:t.airline,airlineName:t.airlineName,operating:t.operating,operatingName:t.operatingName,flight:t.flightNumber,startTime:t.startTime,endTime:t.endTime,expireTime:t.expireTime,duration:t.durationStr,highlight:!0,selected:!0,actived:!0,numOfStop:t.stopStatus,totalPrice:t.ticketDetail.totalCharge,journeyKey:t.journeyKey,journeyFareClass:t.journeyFareClass,fareOptionKey:t.fareOptionKey,sessionId:"",segments:t.segments,bookingType:"b2c",leg:t.leg,isHiddenTotalCharge:0===t.ticketDetail.totalCharge&&"VN"===t.airline&&"agency"===this.currentMode,bagCharge:0,seatCharge:0,comboRefs:[],ticketPrice:t.ticketDetail}],this.totalPrice=t.ticketDetail.totalCharge}chooseAgentTicket(t){var i,a;this.listTicketSelected=[{startPoint:t.startPoint,endPoint:t.endPoint,departDate:"",startCode:t.startPoint,endCode:t.endPoint,airlineLogo:t.airlineLogo,provider:t.provider,airline:t.airline,airlineName:t.airlineName,operating:t.operating,operatingName:t.operatingName,flight:t.segmentsDisplay[0].flightNumber,startTime:t.departure.localTime,endTime:t.arrival.localTime,expireTime:t.expireTime,duration:t.durationStr,highlight:!0,leg:t.leg,sessionId:"",actived:!0,numOfStop:t.numOfStop,ticketPrice:t.ticketDetail,selected:!0,bookingType:"b2b",fareRule:t.fareRule,journeyFareClass:(null===(i=null==t?void 0:t.fareRule)||void 0===i?void 0:i.fareClass)||"",totalPrice:(null===(a=t.ticketDetail)||void 0===a?void 0:a.totalCharge)||0,journeyKey:"",fareOptionKey:t.journeyKey,segments:t.segmentDetails.map((r,l)=>{var o,s;return{segmentKey:r.segmentKey,fareClass:"VJ"===t.airline||"QH"===t.airline?null===(o=t.segmentsDisplay[0].fareClasses.find(u=>u.isSelected))||void 0===o?void 0:o.fareClass:null===(s=t.segmentsDisplay[l].fareClasses.find(u=>u.isSelected))||void 0===s?void 0:s.fareClass,airline:r.airline,airlineName:r.airlineName,airlineLogo:this._flightDataService.getAirlineLogoByCode(r.airline),operating:r.operating,operatingName:r.operatingName,jetCode:r.jetCode,startCode:r.startCode,endCode:r.endCode,startPoint:r.startPoint,endPoint:r.endPoint,departDate:r.departDate,arrivalDate:r.arrivalDate,flightNumber:r.flightNumber,modelAirplane:r.modelAirplane,modelAirplaneName:r.modelAirplaneName,stopPoint:r.stopPoint,duration:r.durationStr}}),bagCharge:0,seatCharge:0}]}onReselected(t){this.listTicketSelected=[]}modeChange(t){this.currentMode=t}quotationUpdateJourney(){var t;console.log(this.listTicketSelected),this.isLoading=!0;const i={airline:this.bookingDetailReroutingData.airline,bookingCode:this.bookingDetailReroutingData.bookingCode,flightUpdate:{departDate:h(this.listTicketSelected[0].startTime).format("YYYY-MM-DD"),startPoint:this.listTicketSelected[0].startPoint,endPoint:this.listTicketSelected[0].endPoint},journeyUpdateInfo:{newFareOptionKey:this.listTicketSelected[0].fareOptionKey||"",oldJourneyKey:(null===(t=this.reroutingJourneySeleceted)||void 0===t?void 0:t.journeyKey)||""}};console.log(i),this._reroutingService.quotationJourneyUpdate(i).pipe((0,k.x)(()=>this.isLoading=!1)).subscribe({next:a=>{console.log(a),this.step=3,this.quotationData=a.data,"BOOKED"===this.bookingDetailReroutingData.status?this.paymentDetailBooked={newJourneyCharge:a.data.newJourney.charge.total,serviceFee:a.data.serviceFeeInfo.totalService,modifyCharge:a.data.modifyCharge.total,totalCharge:a.data.totalCharge.total+a.data.serviceFeeInfo.totalService}:this.paymentDetailIssued={newJourneyCharge:a.data.newJourney.charge.total,oldJourneyCharge:a.data.newJourney.charge.total-(a.data.totalCharge.total-a.data.modifyCharge.total),gapCharge:a.data.totalCharge.total-a.data.modifyCharge.total,modifyCharge:a.data.modifyCharge.total,totalCharge:a.data.totalCharge.total}}})}updateJourneyReservation(){var t,i,a;this.isLoading=!0;const r={airline:(null===(t=this.bookingDetailReroutingData)||void 0===t?void 0:t.airline)||"",bookingCode:(null===(i=this.bookingDetailReroutingData)||void 0===i?void 0:i.bookingCode)||"",updateJourney:{oldJourneyKey:(null===(a=this.reroutingJourneySeleceted)||void 0===a?void 0:a.journeyKey)||"",newFareOptionKey:this.listTicketSelected[0].fareOptionKey||""},confirmCharge:this.quotationData.totalCharge.total};this._reroutingService.updateJourney(r).pipe((0,k.x)(()=>this.isLoading=!1)).subscribe({next:l=>{console.log(l),"OK"===l.status&&(this._toastService.add({severity:"success",summary:"Thay \u0111\u1ed5i h\xe0nh tr\xecnh th\xe0nh c\xf4ng",detail:"",sticky:!1}),this._router.navigate([`admin/booking-detail/${r.airline}/${r.bookingCode}`]))}})}showJourneyModify(t){var i,a,r;const l=this.listTicketSelected[0],o={airline:l.airline,airlineName:l.airlineName,airlineLogo:l.airlineLogo,operating:l.operating,operatingName:l.operatingName,flightNumber:l.flight,journeyName:`Chuy\u1ebfn bay: ${l.startPoint} - ${l.endPoint}`,numOfStop:l.numOfStop,departureDate:h(l.startTime).format("HH:mm DD/MM/YYYY"),startPoint:l.startCode,startPointName:l.startPoint,endPoint:l.endCode,endPointName:l.endPoint,price:l.totalPrice,handBag:"Kh\xf4ng",segments:l.segments.map((u,c)=>({airline:u.airline,airlineSystem:u.airline,airlineName:u.airlineName,airlineLogo:u.airlineLogo,operating:u.operating,operatingName:u.operatingName,mobileAirlineLogo:["VJ","VN","QH"].includes(u.airline)?"assets/airline-logo/"+u.airline+"_small.png":"assets/airline-logo/"+u.airline+".png",flightNumber:u.airline+u.flightNumber,startTime:h(u.departDate).format("HH:mm"),startDate:h(u.departDate).format("DD/MM/YYYY"),startPoint:u.startCode,startPointName:u.startPoint,startAirport:this._locationDataService.getAirportNameByCode(u.startPoint),endTime:h(u.arrivalDate).format("HH:mm"),endDate:h(u.arrivalDate).format("DD/MM/YYYY"),endPoint:u.endCode,endPointName:u.endPoint,endAirport:this._locationDataService.getAirportNameByCode(u.endPoint),stopPoint:u.stopPoint,modelAirplane:u.modelAirplane,rules:[{name:"Th\u1eddi gian bay",value:u.duration},{name:"Lo\u1ea1i m\xe1y bay",value:u.modelAirplane},{name:"H\u1ea1ng ch\u1ed7",value:u.fareClass},{name:"H\xe0nh l\xfd k\xfd g\u1eedi",value:l.checkedBag||"N/A"},{name:"H\xe0nh l\xfd x\xe1ch tay",value:l.handBag||"N/A"}]})),ticketPrice:l.ticketPrice,fareRule:l.fareRule},s={oldJourney:{startPoint:null===(i=this.reroutingJourneySeleceted)||void 0===i?void 0:i.startPointCode,endPoint:null===(a=this.reroutingJourneySeleceted)||void 0===a?void 0:a.endPointCode,startTime:null===(r=this.reroutingJourneySeleceted)||void 0===r?void 0:r.startTime,redirectType:"2 ch\u1eb7ng",totalBaseFare:1e4,addonServiceFee:2e4,serviceFee:3e4,totalCharge:4e4,gapCharge:0},newJourney:{startPoint:o.startPoint,endPoint:o.endPoint,startTime:o.departureDate,redirectType:`${o.numOfStop+1} ch\u1eb7ng`,totalBaseFare:this.quotationData.newJourney.base,addonServiceFee:this.quotationData.newJourney.surCharge,serviceFee:this.quotationData.serviceFeeInfo.totalService,totalCharge:this.quotationData.totalCharge.total,gapCharge:4e4}};this._modal.open(re,{type:t,compareJourneyData:s,flightInfo:o})}filterChange(t){this.ticketFilterState.next(Object.assign(Object.assign({},this.ticketFilterState.value),t))}displayChange(t){this.ticketDisplayState.next(Object.assign(Object.assign({},this.ticketDisplayState.value),t))}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(v.KNP),e.Y36(C.qu),e.Y36(ne.h),e.Y36(ue),e.Y36(ce.v),e.Y36(de._),e.Y36(ge.G),e.Y36(I.oE),e.Y36(pe.BX),e.Y36(he.F0))},n.\u0275cmp=e.Xpm({type:n,selectors:[["rerouting-page"]],hostAttrs:[1,"w-full","h-full"],standalone:!0,features:[e.jDz],decls:54,vars:13,consts:[[1,"flex","flex-col","gap-y-6"],[1,"w-full","h-full","flex","justify-center","py-8","px-6"],[1,"w-[970px]","flex","flex-col","justify-center","gap-y-6",3,"ngClass"],[1,"w-full","flex","gap-x-5"],[1,"w-1","h-full","bg-primary-2-4"],[1,"md:text-heading-md","text-black"],[1,"w-full","bg-neutral-white","flex","flex-col","gap-y-6","p-6","rounded"],[1,"flex","items-baseline","justify-center"],[1,"flex","flex-col","item-between","gap-y-3"],[1,"flex","items-center"],[1,"w-[120px]"],[1,"w-10","h-10","flex","items-center","justify-center","rounded-full","border","border-yellow-4","bg-transparent","text-yellow-4"],[1,"w-[120px]","border-t","border-t-yellow-4"],[1,"text-center","text-body-md-short"],[1,"w-10","h-10","flex","items-center","justify-center","rounded-full","bg-yellow-4","text-white"],[1,"w-[120px]","border-t","border-t-neutral-gray-1"],[1,"w-10","h-10","flex","items-center","justify-center","rounded-full","border","border-neutral-gray-3","bg-transparent","text-neutral-gray-3"],["class","py-1.5 px-3 bg-functional-1-1 flex items-center gap-x-2",4,"ngIf"],["class","flex gap-x-4",4,"ngIf"],["class","px-3 py-1.5 gap-x-2 bg-secondary-7-1 flex items-center",4,"ngIf"],[1,"w-full","flex-1"],["class","flex flex-col gap-y-6",4,"ngIf"],["class","flex flex-col gap-y-6 h-full",4,"ngIf"],[1,"w-full","flex","justify-between","items-center","fixed","bottom-0","left-0","pl-[90px]","pr-[10px]","pb-[10px]"],["cf-button","","type","border",1,"min-w-[100px]","justify-center","bg-neutral-white",3,"click"],["icon","close","size","small",1,"mr-2.5"],[1,"flex","gap-x-4"],["cf-button","","type","secondary",1,"min-w-[100px]","justify-center","bg-neutral-white",3,"click"],["icon","arrow_left","size","small",1,"mr-2.5"],["class","min-w-[100px] justify-center","cf-button","",3,"click",4,"ngIf"],[4,"ngIf"],[1,"py-1.5","px-3","bg-functional-1-1","flex","items-center","gap-x-2"],["icon","grouping","size","small"],[1,"text-body-md-short"],[1,"flex","gap-x-2","items-center"],["icon","plane","size","small"],[1,"text-heading-xs"],[1,"px-3","py-1","bg-neutral-gray-1","rounded","flex","items-center","text-heading-sm"],["icon","arrow_right","size","small"],[1,"px-3","py-1.5","gap-x-2","bg-secondary-7-1","flex","items-center"],["width","16","height","16","viewBox","0 0 16 16","fill","none","xmlns","http://www.w3.org/2000/svg"],["d","M1.15219 12.4042L6.82252 3.58351C6.93579 3.40736 7.10527 3.25996 7.31274 3.15714C7.5202 3.05433 7.75781 3 8 3C8.24218 3 8.47979 3.05433 8.68726 3.15714C8.89472 3.25996 9.06421 3.40736 9.17747 3.58351L14.8478 12.4042C14.9542 12.5706 15.0065 12.7569 14.9994 12.9449C14.9923 13.1329 14.9261 13.3162 14.8074 13.4769C14.6886 13.6376 14.5212 13.7703 14.3216 13.8619C14.122 13.9536 13.897 14.0012 13.6684 14H2.32903C2.10067 14.0008 1.87593 13.953 1.67669 13.8612C1.47744 13.7694 1.31046 13.6367 1.19199 13.476C1.07352 13.3154 1.00759 13.1322 1.00062 12.9444C0.993643 12.7566 1.04586 12.5705 1.15219 12.4042Z","fill","#FCB40A"],["fill-rule","evenodd","clip-rule","evenodd","d","M8.0001 5.34998C8.35908 5.34998 8.6501 5.64099 8.6501 5.99998V8.99998C8.6501 9.35896 8.35908 9.64998 8.0001 9.64998C7.64111 9.64998 7.3501 9.35896 7.3501 8.99998V5.99998C7.3501 5.64099 7.64111 5.34998 8.0001 5.34998Z","fill","#2C2C2C"],["d","M8.0502 12.0999C8.51964 12.0999 8.9002 11.7193 8.9002 11.2499C8.9002 10.7805 8.51964 10.3999 8.0502 10.3999C7.58075 10.3999 7.2002 10.7805 7.2002 11.2499C7.2002 11.7193 7.58075 12.0999 8.0502 12.0999Z","fill","#2C2C2C"],[4,"ngFor","ngForOf"],[1,"p-4","bg-neutral-white","flex","gap-x-12"],[1,"flex","flex-col","items-center"],[1,"w-[80px]","h-[40px]","object-contain",3,"src"],[1,"text-express-sm","whitespace-nowrap"],[1,"w-full","flex","gap-x-4"],[1,"flex-1","flex","flex-col","gap-y-2"],[1,"flex","items-center","gap-x-2"],["icon","location","size","small"],[1,"flex","items-center","gap-x-2.5","text-express-xl"],["icon","calendar","size","small",1,"text-neutral-gray-4"],[1,"text-body-md-short","text-neutral-gray-4"],["icon","plane","size","small",1,"text-neutral-gray-4"],[1,"border-l","border-dashed","border-neutral-gray-3"],[1,"flex","gap-x-12"],[1,"text-body-md"],[1,"text-express-md","text-neutral-gray-6"],["size","medium",3,"checked","value","checkChange"],[1,"flex","flex-col","gap-y-6","h-full"],[1,"bg-neutral-white","p-6","rounded"],[1,"flex","gap-x-2"],[1,"flex-1"],[3,"formArray"],["cf-button","","size","medium","type","secondary",1,"w-[168px]","!py-[7px]","!h-auto","!max-h-14",3,"click"],["icon","search","size","small",1,"mr-2.5"],[1,"whitespace-nowrap"],[1,"flex-1","flex","gap-x-4"],[1,"w-[252px]","flex-shrink-0"],[3,"currentMode","airlineList","ticketFilter","ticketDisplay","fareclassList","planeModelList","selectedFare","departureTimeList","arrivalTimeList","durationFilter","minDuration","maxDuration","departTimeComboList","arriveTimeComboList","minFareClss","priceFilter","minPrice","maxPrice","bookingSystemList","ticketFilterChange","ticketDisplayChange"],[1,"mb-4"],[3,"modeView","disableAgencyMode","modeChange"],[1,"mt-[56px]","w-[302px]","flex-shrink-0","rounded","h-fit","md:hidden","sticky","top-0"],[1,"bg-neutral-white"],[1,"flex","justify-between","items-center","py-3","px-4"],[1,"text-espressive-sm","text-neutral-black"],[3,"ticketsSelected","reselect"],["class","flex justify-between items-center py-3 px-4",4,"ngIf"],["class","flex flex-col gap-y-3","infinite-scroll","",3,"infiniteScrollDistance","infiniteScrollThrottle","infiniteScrollContainer","scrollWindow","fromRoot","alwaysCallback","scrolled",4,"ngIf"],["infinite-scroll","",1,"flex","flex-col","gap-y-3",3,"infiniteScrollDistance","infiniteScrollThrottle","infiniteScrollContainer","scrollWindow","fromRoot","alwaysCallback","scrolled"],[4,"ngFor","ngForOf","ngForTrackBy"],[3,"ticket","listFareRule","listFareRuleClasses","ticketSelected",4,"ngIf"],[3,"ticket","listFareRule","listFareRuleClasses","ticketSelected"],[1,"text-heading-md","text-neutral-black"],[1,"py-6","flex","flex-col","gap-y-4","bg-neutral-white"],[1,"px-6","gap-x-2","flex","justify-between"],[1,"flex","items-center","gap-x-2","text-heading-sm"],["icon","money","size","small"],[1,"flex","gap-x-3"],["icon","external_link","size","small",1,"mr-2.5"],["icon","grouping","size","small",1,"mr-2.5"],[1,"px-3"],[1,"table-auto","w-full"],[1,"border-b","border-neutral-gray-1"],[1,"text-left","text-espressive-sm","text-neutral-gray-4","py-3"],[1,"text-right","text-espressive-sm","text-neutral-gray-4","py-3"],[1,"flex","justify-end","gap-x-4","items-center"],[1,"min-w-[120px]","text-heading-md","text-right"],[1,"bg-neutral-white","py-6","flex","flex-col","gap-y-4"],[1,"px-6","text-heading-sm","flex","gap-x-2","items-center"],["class","px-6 flex flex-col gap-y-3",4,"ngIf"],[1,"text-body-md","text-neutral-black","py-3"],[1,"text-right","text-body-md","text-neutral-black","py-3"],[1,"px-6","flex","flex-col","gap-y-3"],[1,"flex","justify-between","items-center"],[1,"flex","gap-x-2","items-center","text-body-md"],["icon","circle_information","size","small"],[1,"text-espressive-md-short"],[1,"flex","gap-x-2","items-center","text-express-md"],[1,"text-heading-lg","text-primary-1-4"],[1,"text-espressive-md-short","text-functional-2-3"],[1,"text-espressive-md-short","text-primary-1-4"],["cf-button","",1,"min-w-[100px]","justify-center",3,"click"],["icon","chevron_right","size","small",1,"ml-2.5"]],template:function(t,i){1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3),e._UZ(4,"div",4),e.TgZ(5,"div",5),e._uU(6,"\u0110\u1ed5i h\xe0nh tr\xecnh"),e.qZA()(),e.TgZ(7,"div",6)(8,"div")(9,"div",7)(10,"div",8)(11,"div",9),e._UZ(12,"div",10),e.TgZ(13,"div",11),e._uU(14," 1 "),e.qZA(),e._UZ(15,"div",12),e.qZA(),e.TgZ(16,"div",13),e._uU(17,"Ch\u1ecdn h\xe0nh tr\xecnh mu\u1ed1n thay \u0111\u1ed5i"),e.qZA()(),e.TgZ(18,"div",8)(19,"div",9),e._UZ(20,"div",12),e.TgZ(21,"div",14),e._uU(22," 2 "),e.qZA(),e._UZ(23,"div",15),e.qZA(),e.TgZ(24,"div",13),e._uU(25,"Ch\u1ecdn h\xe0nh tr\xecnh m\u1edbi"),e.qZA()(),e.TgZ(26,"div",8)(27,"div",9),e._UZ(28,"div",15),e.TgZ(29,"div",16),e._uU(30," 3 "),e.qZA(),e._UZ(31,"div",10),e.qZA(),e.TgZ(32,"div",13),e._uU(33,"X\xe1c nh\u1eadn thay \u0111\u1ed5i"),e.qZA()()()(),e.YNc(34,fe,4,0,"div",17),e.YNc(35,me,10,6,"div",18),e.YNc(36,ve,11,0,"div",19),e.qZA(),e.TgZ(37,"div",20),e.YNc(38,Te,2,2,"div",21),e.YNc(39,Se,26,27,"div",22),e.YNc(40,Ne,42,7,"div",21),e.qZA()()(),e.TgZ(41,"div",23)(42,"div")(43,"button",24),e.NdJ("click",function(){return i.onCancel()}),e._UZ(44,"cf-icon",25),e._uU(45," H\u1ee7y d\u1ecbch v\u1ee5 "),e.qZA()(),e.TgZ(46,"div",26)(47,"button",27),e.NdJ("click",function(){return i.onBack()}),e._UZ(48,"cf-icon",28),e._uU(49," Quay l\u1ea1i "),e.qZA(),e.YNc(50,Je,3,0,"button",29),e.YNc(51,we,3,0,"button",29),e.YNc(52,Re,3,0,"button",29),e.qZA()()(),e.YNc(53,qe,1,0,"cf-spinner",30)),2&t&&(e.xp6(2),e.Q6J("ngClass",e.VKq(11,Ie,2===i.step)),e.xp6(32),e.Q6J("ngIf",1===i.step),e.xp6(1),e.Q6J("ngIf",2===i.step),e.xp6(1),e.Q6J("ngIf",3===i.step),e.xp6(2),e.Q6J("ngIf",1===i.step),e.xp6(1),e.Q6J("ngIf",2===i.step),e.xp6(1),e.Q6J("ngIf",3===i.step),e.xp6(10),e.Q6J("ngIf",1===i.step),e.xp6(1),e.Q6J("ngIf",2===i.step),e.xp6(1),e.Q6J("ngIf",3===i.step),e.xp6(1),e.Q6J("ngIf",i.isLoading))},dependencies:[T.ez,T.mk,T.sg,T.O5,T.JJ,T.uU,v.AxE,v.Sm8,K.o,D.N8,D.Xq,Q.t3,Z.DW,b.a7,b.ZZ,w.Rq,w.Ry,b.Vz,b.qx,q.OR,b.AS,b.bM],encapsulation:2}),n})()}}]);