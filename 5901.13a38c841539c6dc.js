"use strict";(self.webpackChunkcheapflightclient=self.webpackChunkcheapflightclient||[]).push([[5901],{85901:(rt,K,v)=>{v.r(K),v.d(K,{BookingSuccessPageComponent:()=>it});var S=v(36895),L=v(37094),U=v(83700),w=v(87683),k=v(72506),$=v(44143),V=v(40529),C=v(45881),b=v(39840),q=v(20348),P=v(99251),N=v(89319),Y=v(26655),Q=v(31387),j=v(95911),D=v(88001),d=v(40899),G=v(89701),z=v(64190),F=v(44586),O=v(52013),Z=v(50494),T=v(15439),X=v(88996),W=v(95577),ee=v(54004),te=v(70262),R=v(39646),ie=v(57359),H=v(54482);const oe=(c,f)=>(c.push(f),c);var A=v(28746),J=v(17414),e=v(94650),se=v(3803),re=v(4520),le=v(36634),ce=v(86432),de=v(3193),he=v(62733),ge=v(28490),ue=v(97579),me=v(33486),pe=v(64425),ve=v(82761),fe=v(62331),be=v(45061),_e=v(90602),ke=v(9381),Ce=v(21505),Te=v(77492),ye=v(7644),Se=v(27849),Be=v(9497);function xe(c,f){1&c&&e._UZ(0,"cf-spinner")}function Ee(c,f){if(1&c&&(e.TgZ(0,"div",26)(1,"div",5),e._UZ(2,"div",6),e.TgZ(3,"div",7),e._uU(4,"Th\xf4ng tin h\xe0nh kh\xe1ch"),e.qZA()(),e._UZ(5,"booking-passenger-info",27),e.qZA()),2&c){const t=e.oxw();e.xp6(5),e.Q6J("passengerInfos",t.passengerInfos)}}const Ae=function(){return["BOOKED","ISSUED"]};function Pe(c,f){if(1&c){const t=e.EpF();e.TgZ(0,"booking-detail",28),e.NdJ("actionChange",function(i){const a=e.CHM(t).$implicit,s=e.oxw();return e.KtG(s.onActionChange(i,a))})("retryBooking",function(i){e.CHM(t);const o=e.oxw();return e.KtG(o.onRetryBooking(i))}),e.qZA()}if(2&c){const t=f.$implicit;e.Q6J("isShowMore",!0)("bookingDetail",t)("isBooked",e.DdM(3,Ae).includes(t.status))}}function De(c,f){if(1&c&&(e.TgZ(0,"tr")(1,"td",36),e._UZ(2,"img",37),e.qZA(),e.TgZ(3,"td",36),e._uU(4),e.qZA(),e.TgZ(5,"td",36),e._uU(6),e.qZA(),e.TgZ(7,"td",36),e._uU(8),e.qZA(),e.TgZ(9,"td",36),e._uU(10),e.qZA(),e.TgZ(11,"td",36),e._uU(12),e.ALo(13,"number"),e.qZA()()),2&c){const t=f.$implicit;e.xp6(2),e.Q6J("src",t.airlineLogo,e.LSH),e.xp6(2),e.Oqu(t.flight),e.xp6(2),e.Oqu(t.departDate),e.xp6(2),e.Oqu(t.passengerName),e.xp6(2),e.Oqu(t.serviceName),e.xp6(2),e.Oqu(e.lcZ(13,6,t.totalCharge))}}function Ie(c,f){if(1&c&&(e.TgZ(0,"div",29)(1,"div",30)(2,"span",31),e._uU(3,"H\xe0nh l\xfd & d\u1ecbch v\u1ee5 b\u1ed5 sung"),e.qZA()(),e.TgZ(4,"div")(5,"table",32)(6,"thead")(7,"tr",33)(8,"th",34),e._uU(9,"H\xe3ng bay"),e.qZA(),e.TgZ(10,"th",34),e._uU(11,"Chuy\u1ebfn bay"),e.qZA(),e.TgZ(12,"th",34),e._uU(13,"Ng\xe0y \u0111i"),e.qZA(),e.TgZ(14,"th",34),e._uU(15,"H\xe0nh kh\xe1ch"),e.qZA(),e.TgZ(16,"th",34),e._uU(17,"T\xean d\u1ecbch v\u1ee5"),e.qZA(),e.TgZ(18,"th",34),e._uU(19,"T\u1ed5ng gi\xe1"),e.qZA()()(),e.TgZ(20,"tbody"),e.YNc(21,De,14,8,"tr",35),e.qZA()()()()),2&c){const t=e.oxw();e.xp6(21),e.Q6J("ngForOf",t.listBaggage)}}function Ne(c,f){if(1&c&&(e.TgZ(0,"tr")(1,"td",36),e._UZ(2,"img",37),e.qZA(),e.TgZ(3,"td",36),e._uU(4),e.qZA(),e.TgZ(5,"td",36),e._uU(6),e.qZA(),e.TgZ(7,"td",36),e._uU(8),e.qZA(),e.TgZ(9,"td",36),e._uU(10),e.qZA(),e.TgZ(11,"td",36),e._uU(12),e.ALo(13,"number"),e.qZA()()),2&c){const t=f.$implicit;e.xp6(2),e.Q6J("src",t.airlineLogo,e.LSH),e.xp6(2),e.Oqu(t.flight),e.xp6(2),e.Oqu(t.departDate),e.xp6(2),e.Oqu(t.passengerName),e.xp6(2),e.Oqu(t.serviceName),e.xp6(2),e.Oqu(e.lcZ(13,6,t.totalCharge))}}function Fe(c,f){if(1&c&&(e.TgZ(0,"div",29)(1,"div",30)(2,"span",31),e._uU(3,"D\u1ecbch v\u1ee5"),e.qZA()(),e.TgZ(4,"div")(5,"table",32)(6,"thead")(7,"tr",33)(8,"th",34),e._uU(9,"H\xe3ng bay"),e.qZA(),e.TgZ(10,"th",34),e._uU(11,"Chuy\u1ebfn bay"),e.qZA(),e.TgZ(12,"th",34),e._uU(13,"Ng\xe0y \u0111i"),e.qZA(),e.TgZ(14,"th",34),e._uU(15,"H\xe0nh kh\xe1ch"),e.qZA(),e.TgZ(16,"th",34),e._uU(17,"T\xean d\u1ecbch v\u1ee5"),e.qZA(),e.TgZ(18,"th",34),e._uU(19,"T\u1ed5ng gi\xe1"),e.qZA()()(),e.TgZ(20,"tbody"),e.YNc(21,Ne,14,8,"tr",35),e.qZA()()()()),2&c){const t=e.oxw();e.xp6(21),e.Q6J("ngForOf",t.listService)}}function Ze(c,f){if(1&c){const t=e.EpF();e.TgZ(0,"div")(1,"button",46),e.NdJ("click",function(){e.CHM(t);const i=e.oxw(2);return e.KtG(i.getFareRule())}),e._uU(2," \u0110i\u1ec1u ki\u1ec7n gi\xe1 v\xe9 "),e.qZA()()}}function Me(c,f){if(1&c&&(e.TgZ(0,"div")(1,"div",38)(2,"div",39),e._UZ(3,"div",6),e.TgZ(4,"div",7),e._uU(5,"T\u1ed5ng chi ph\xed h\xe0nh tr\xecnh"),e.qZA()(),e.YNc(6,Ze,3,0,"div",0),e.qZA(),e.TgZ(7,"div",40),e._UZ(8,"price-detail",41),e.TgZ(9,"div",42)(10,"div",43)(11,"div",44),e._uU(12,"T\u1ed5ng chi ph\xed"),e.qZA(),e.TgZ(13,"div",45),e._uU(14),e.ALo(15,"replace"),e.ALo(16,"number"),e.qZA()()()()()),2&c){const t=e.oxw();e.xp6(6),e.Q6J("ngIf",t.hasInternationalFlight),e.xp6(2),e.Q6J("priceDetail",t.priceDetail),e.xp6(6),e.hij("",e.Dn7(15,3,e.lcZ(16,7,t.totalPrice),",",".")," \u0111")}}function Oe(c,f){1&c&&(e.TgZ(0,"div",47),e._UZ(1,"cf-icon",48),e.TgZ(2,"div")(3,"div",49),e._uU(4,"L\u01b0u \xfd:"),e.qZA(),e.TgZ(5,"ul",50)(6,"li",51),e._uU(7,"Gi\xe1 v\xe9 c\xf3 th\u1ec3 thay \u0111\u1ed5i t\xf9y theo th\u1eddi \u0111i\u1ec3m \u0111\u1eb7t v\xe9, t\u1ef7 gi\xe1 v\xe0 ch\xednh s\xe1ch c\u1ee7a h\xe3ng h\xe0ng kh\xf4ng. \u0110\u1ea1i l\xfd ch\xfa \xfd ki\u1ec3m tra l\u1ea1i gi\xe1 v\xe9 m\u1edbi nh\u1ea5t t\u1ea1i b\u01b0\u1edbc Xu\u1ea5t v\xe9"),e.qZA(),e.TgZ(8,"li",51),e._uU(9," H\xe0nh tr\xecnh kh\u1edfi h\xe0nh ngo\xe0i Vi\u1ec7t Nam ch\u1ec9 \u0111\u01b0\u1ee3c b\u1ea3o \u0111\u1ea3m gi\xe1 t\u1ea1i th\u1eddi \u0111i\u1ec3m \u0111\u1eb7t v\xe9 "),e.qZA()()()())}function Re(c,f){if(1&c){const t=e.EpF();e.TgZ(0,"booking-detail-mobile",55),e.NdJ("onDetailClick",function(){const o=e.CHM(t).$implicit,a=e.oxw(2);return e.KtG(a.mobileDetailClick(o))})("actionChange",function(i){const a=e.CHM(t).$implicit,s=e.oxw(2);return e.KtG(s.onActionChange(i,a))})("retryBooking",function(i){e.CHM(t);const o=e.oxw(2);return e.KtG(o.onRetryBooking(i))}),e.qZA()}2&c&&e.Q6J("bookingDetail",f.$implicit)}function Ke(c,f){1&c&&(e.TgZ(0,"div",60),e._uU(1,"H\xe0nh l\xfd & d\u1ecbch v\u1ee5 b\u1ed5 sung"),e.qZA())}function Le(c,f){if(1&c&&(e.TgZ(0,"div",61)(1,"div",62)(2,"div",63),e._uU(3,"H\xe3ng bay"),e.qZA(),e.TgZ(4,"div",64),e._uU(5),e.qZA()(),e.TgZ(6,"div",62)(7,"div",63),e._uU(8,"H\xe0nh kh\xe1ch"),e.qZA(),e.TgZ(9,"div",64),e._uU(10),e.qZA()(),e.TgZ(11,"div",62)(12,"div",63),e._uU(13,"Chuy\u1ebfn bay"),e.qZA(),e.TgZ(14,"div",64),e._uU(15),e.qZA()(),e.TgZ(16,"div",62)(17,"div",63),e._uU(18,"Ng\xe0y \u0111i"),e.qZA(),e.TgZ(19,"div",64),e._uU(20),e.qZA()(),e.TgZ(21,"div",62)(22,"div",63),e._uU(23,"T\xean d\u1ecbch v\u1ee5"),e.qZA(),e.TgZ(24,"div",64),e._uU(25),e.qZA()(),e.TgZ(26,"div",62)(27,"div",63),e._uU(28,"T\u1ed5ng gi\xe1"),e.qZA(),e.TgZ(29,"div",64),e._uU(30),e.ALo(31,"replace"),e.ALo(32,"number"),e.qZA()()()),2&c){const t=f.$implicit;e.xp6(5),e.Oqu(t.airlineName),e.xp6(5),e.Oqu(t.passengerName),e.xp6(5),e.Oqu(t.flight),e.xp6(5),e.Oqu(t.departDate),e.xp6(5),e.Oqu(t.serviceName),e.xp6(5),e.hij("",e.Dn7(31,6,e.lcZ(32,10,t.totalCharge),",","."),"\u0111")}}function Ue(c,f){if(1&c&&(e.TgZ(0,"div",56)(1,"cf-collapse",56)(2,"cf-collapse-panel",57),e.YNc(3,Ke,2,0,"ng-template",null,58,e.W1O),e.YNc(5,Le,33,12,"div",59),e.qZA()()()),2&c){const t=e.MAs(4),n=e.oxw(2);e.xp6(2),e.Q6J("title",t)("active",!1)("contentClass","!p-0 bg-transparent")("panelClass","!p-3 bg-neutral-white rounded-lg"),e.xp6(3),e.Q6J("ngForOf",n.listBaggage)}}function we(c,f){1&c&&(e.TgZ(0,"div",60),e._uU(1,"D\u1ecbch v\u1ee5"),e.qZA())}function Ve(c,f){if(1&c&&(e.TgZ(0,"div",61)(1,"div",62)(2,"div",63),e._uU(3,"H\xe3ng bay"),e.qZA(),e.TgZ(4,"div",64),e._uU(5),e.qZA()(),e.TgZ(6,"div",62)(7,"div",63),e._uU(8,"H\xe0nh kh\xe1ch"),e.qZA(),e.TgZ(9,"div",64),e._uU(10),e.qZA()(),e.TgZ(11,"div",62)(12,"div",63),e._uU(13,"Chuy\u1ebfn bay"),e.qZA(),e.TgZ(14,"div",64),e._uU(15),e.qZA()(),e.TgZ(16,"div",62)(17,"div",63),e._uU(18,"Ng\xe0y \u0111i"),e.qZA(),e.TgZ(19,"div",64),e._uU(20),e.qZA()(),e.TgZ(21,"div",62)(22,"div",63),e._uU(23,"T\xean d\u1ecbch v\u1ee5"),e.qZA(),e.TgZ(24,"div",64),e._uU(25),e.qZA()(),e.TgZ(26,"div",62)(27,"div",63),e._uU(28,"T\u1ed5ng gi\xe1"),e.qZA(),e.TgZ(29,"div",64),e._uU(30),e.ALo(31,"replace"),e.ALo(32,"number"),e.qZA()()()),2&c){const t=f.$implicit;e.xp6(5),e.Oqu(t.airlineName),e.xp6(5),e.Oqu(t.passengerName),e.xp6(5),e.Oqu(t.flight),e.xp6(5),e.Oqu(t.departDate),e.xp6(5),e.Oqu(t.serviceName),e.xp6(5),e.hij("",e.Dn7(31,6,e.lcZ(32,10,t.totalCharge),",","."),"\u0111")}}function qe(c,f){if(1&c&&(e.TgZ(0,"div",56)(1,"cf-collapse",56)(2,"cf-collapse-panel",57),e.YNc(3,we,2,0,"ng-template",null,58,e.W1O),e.YNc(5,Ve,33,12,"div",59),e.qZA()()()),2&c){const t=e.MAs(4),n=e.oxw(2);e.xp6(2),e.Q6J("title",t)("active",!1)("contentClass","!p-0 bg-transparent")("panelClass","!p-3 bg-neutral-white rounded-lg"),e.xp6(3),e.Q6J("ngForOf",n.listService)}}function je(c,f){if(1&c&&(e.TgZ(0,"div",52),e.YNc(1,Re,1,1,"booking-detail-mobile",53),e.YNc(2,Ue,6,5,"div",54),e.YNc(3,qe,6,5,"div",54),e.qZA()),2&c){const t=e.oxw();e.xp6(1),e.Q6J("ngForOf",t.bookingDetails),e.xp6(1),e.Q6J("ngIf",t.hasBaggageSelected),e.xp6(1),e.Q6J("ngIf",t.hasSeatSelected)}}function He(c,f){if(1&c&&(e.TgZ(0,"div",66)(1,"div",62)(2,"div",63),e._uU(3,"H\xe0nh kh\xe1ch"),e.qZA(),e.TgZ(4,"div",64),e._uU(5),e.qZA()(),e.TgZ(6,"div",62)(7,"div",63),e._uU(8,"Lo\u1ea1i h\xe0nh kh\xe1ch"),e.qZA(),e.TgZ(9,"div",64),e._uU(10),e.qZA()(),e.TgZ(11,"div",62)(12,"div",63),e._uU(13,"Ng\xe0y sinh"),e.qZA(),e.TgZ(14,"div",64),e._uU(15),e.qZA()(),e.TgZ(16,"div",62)(17,"div",63),e._uU(18,"Gi\u1edbi t\xednh"),e.qZA(),e.TgZ(19,"div",64),e._uU(20),e.qZA()()()),2&c){const t=f.$implicit;e.xp6(5),e.Oqu(t.name),e.xp6(5),e.Oqu(t.type),e.xp6(5),e.Oqu(t.birthday),e.xp6(5),e.Oqu(t.sex)}}function Je(c,f){if(1&c&&(e.TgZ(0,"div",52)(1,"div",60),e._uU(2,"Th\xf4ng tin kh\xe1ch h\xe0ng"),e.qZA(),e.YNc(3,He,21,4,"div",65),e.TgZ(4,"div",60),e._uU(5,"Th\xf4ng tin li\xean h\u1ec7"),e.qZA(),e.TgZ(6,"div",66)(7,"div",62)(8,"div",63),e._uU(9,"M\xe3 v\xf9ng"),e.qZA(),e.TgZ(10,"div",64),e._uU(11,"+84"),e.qZA()(),e.TgZ(12,"div",62)(13,"div",63),e._uU(14,"S\u1ed1 \u0111i\u1ec7n tho\u1ea1i"),e.qZA(),e.TgZ(15,"div",64),e._uU(16),e.qZA()(),e.TgZ(17,"div",62)(18,"div",63),e._uU(19,"Email"),e.qZA(),e.TgZ(20,"div",64),e._uU(21),e.qZA()()()()),2&c){const t=e.oxw();e.xp6(3),e.Q6J("ngForOf",t.passengerInfos),e.xp6(13),e.Oqu(t.bookingContact.phone),e.xp6(5),e.Oqu(t.bookingContact.email)}}function $e(c,f){if(1&c&&(e.TgZ(0,"div",66)(1,"div",62)(2,"div",63),e._uU(3,"H\xe0nh kh\xe1ch"),e.qZA(),e.TgZ(4,"div",64),e._uU(5),e.qZA()(),e.TgZ(6,"div",62)(7,"div",63),e._uU(8,"Lo\u1ea1i kh\xe1ch"),e.qZA(),e.TgZ(9,"div",64),e._uU(10),e.qZA()(),e.TgZ(11,"div",62)(12,"div",63),e._uU(13,"Gi\xe1 v\xe9"),e.qZA(),e.TgZ(14,"div",64),e._uU(15),e.ALo(16,"replace"),e.ALo(17,"number"),e.qZA()(),e.TgZ(18,"div",62)(19,"div",63),e._uU(20,"Thu\u1ebf ph\xed"),e.qZA(),e.TgZ(21,"div",64),e._uU(22),e.ALo(23,"replace"),e.ALo(24,"number"),e.qZA()(),e.TgZ(25,"div",62)(26,"div",63),e._uU(27,"T\u1ed5ng gi\xe1"),e.qZA(),e.TgZ(28,"div",64),e._uU(29),e.ALo(30,"replace"),e.ALo(31,"number"),e.qZA()()()),2&c){const t=f.$implicit;e.xp6(5),e.Oqu(t.name),e.xp6(5),e.Oqu(t.type),e.xp6(5),e.hij("",e.Dn7(16,5,e.lcZ(17,9,t.base),",","."),"\u0111 "),e.xp6(7),e.hij("",e.Dn7(23,11,e.lcZ(24,15,t.tax),",","."),"\u0111 "),e.xp6(7),e.hij("",e.Dn7(30,17,e.lcZ(31,21,t.total),",","."),"\u0111 ")}}function Ye(c,f){if(1&c&&(e.TgZ(0,"div",52),e.YNc(1,$e,32,23,"div",65),e.qZA()),2&c){const t=e.oxw();e.xp6(1),e.Q6J("ngForOf",null==t.priceDetail?null:t.priceDetail.passengers)}}function Qe(c,f){1&c&&e._UZ(0,"cf-icon",75)}function Ge(c,f){1&c&&e._UZ(0,"cf-icon",76)}function ze(c,f){if(1&c&&(e.TgZ(0,"div",77)(1,"div",78)(2,"div",79)(3,"div",80)(4,"div",81),e._uU(5," Gi\xe1 v\xe9 m\xe1y bay "),e.qZA(),e.TgZ(6,"div",81),e._uU(7," D\u1ecbch v\u1ee5 c\u1ed9ng th\xeam "),e.qZA(),e.TgZ(8,"div",81),e._uU(9," Ph\xed d\u1ecbch v\u1ee5 "),e.qZA()()(),e.TgZ(10,"div",82)(11,"div",83),e._uU(12),e.ALo(13,"replace"),e.ALo(14,"number"),e.qZA(),e.TgZ(15,"div",83),e._uU(16),e.ALo(17,"replace"),e.ALo(18,"number"),e.qZA(),e.TgZ(19,"div",83),e._uU(20),e.ALo(21,"replace"),e.ALo(22,"number"),e.qZA()()()()),2&c){const t=e.oxw(2);e.xp6(12),e.hij(" ",e.Dn7(13,3,e.lcZ(14,7,t.priceDetail.totalBasePrice),",","."),"\u0111 "),e.xp6(4),e.hij(" ",e.Dn7(17,9,e.lcZ(18,13,t.priceDetail.totalAddonService),",","."),"\u0111 "),e.xp6(4),e.hij(" ",e.Dn7(21,15,e.lcZ(22,19,t.priceDetail.totalServiceFee),",","."),"\u0111 ")}}function Xe(c,f){if(1&c){const t=e.EpF();e.TgZ(0,"div",67)(1,"div",68),e.NdJ("click",function(){e.CHM(t);const i=e.MAs(12),o=e.oxw();return e.KtG(o.togglePriceBottomSheet(i))}),e.TgZ(2,"div",69)(3,"div",70),e._uU(4," T\u1ed5ng chi ph\xed: "),e.qZA(),e.TgZ(5,"div",71),e._uU(6),e.ALo(7,"replace"),e.ALo(8,"number"),e.qZA()(),e.YNc(9,Qe,1,0,"cf-icon",72),e.YNc(10,Ge,1,0,"cf-icon",73),e.qZA(),e.YNc(11,ze,23,21,"ng-template",null,74,e.W1O),e.qZA()}if(2&c){const t=e.oxw();e.ekj("z-1000",t.zIndexPriceIncrease),e.xp6(6),e.hij(" ",e.Dn7(7,5,e.lcZ(8,9,t.totalPrice),",",".")," \u0111 "),e.xp6(3),e.Q6J("ngIf",!t.isShowTotalPriceBts),e.xp6(1),e.Q6J("ngIf",t.isShowTotalPriceBts)}}function We(c,f){if(1&c){const t=e.EpF();e.ynx(0),e.TgZ(1,"div",84)(2,"div",85),e.NdJ("click",function(){const o=e.CHM(t).$implicit,a=e.oxw(2);return e.KtG(a.onShare(o.airline))}),e._UZ(3,"cf-icon",86),e.TgZ(4,"div",87),e._uU(5," Sao ch\xe9p "),e.qZA()(),e._UZ(6,"booking-text-origin",88),e.qZA(),e.BQk()}if(2&c){const t=f.$implicit;e.xp6(6),e.Q6J("bookingText",t)}}function et(c,f){if(1&c&&(e.TgZ(0,"div",52),e.YNc(1,We,7,1,"ng-container",35),e.qZA()),2&c){const t=e.oxw();e.xp6(1),e.Q6J("ngForOf",t.listBookingText)}}function tt(c,f){if(1&c&&(e.TgZ(0,"div",52),e._UZ(1,"remark-booking-page",14),e.qZA()),2&c){const t=e.oxw();e.xp6(1),e.Q6J("listBookingCode",t.listBookingCode)}}let it=(()=>{class c{constructor(t,n,i,o,a,s,l,g,r,h,u,p,m,_,B,x,y,E,I,M,nt,ot,at,st){this._flightDataService=s,this._locationDataService=l,this._bookingResultDataProvider=g,this._modal=r,this._manageBookingService=h,this.clipboard=u,this._route=p,this._bookFlightService=m,this._permissionService=_,this._toastService=B,this._searchFlightService=x,this._bottomSheetService=y,this._bookingDetailService=E,this._detectMobileService=I,this._ticketLowFareService=M,this._eventLogService=nt,this._sockerService=ot,this._requestReroutingService=at,this._systemService=st,this.passengerInfos=[],this.bookingDetails=[],this.isSuccess=!1,this.dataBaggageInput=[],this.hasBaggageSelected=!1,this.dataSeatInput=[],this.hasSeatSelected=!1,this.listBaggage=[],this.listService=[],this.listJourneyBasic=[],this.isLoading=!1,this.listBookingText=[],this.listBookingTextExplain=[],this.modeBookingText="explain",this.listBookingCode=[],this.zIndexPriceIncrease=!1,this.firstLoad=!1,this.afterIssueBooking=!1,this.maxBag=10,this.isShowTotalPriceBts=!1,this.hasInternationalFlight=!1,this.mobileTabMode="BOOKING_DETAIL",i.registerIcons([k.xgX,k.Ey$,k.B2I,k.xgX,k.llu,k.bHT,k.QkI,k.ILM,k.tLH,k.xbi,k.NYs,k.okA,k.B2I,k.s5C,k.qDv,k.rks,k.Ffn,k._tC,k.fqi,k.n78,k.Hge,k.cnj]),this.ticketSelected=t.ticketSelectedData,this.bookFlightResult=(0,Z.yE)(P.aM,g.bookingResultData,{excludeExtraneousValues:!0}),this.firstLoad=g.firstBookingResult,g.firstBookingResult=!1,this.bookingRequest=n.bookingRequestData}ngOnInit(){this.isSuccess=this.bookFlightResult.data.some(t=>"OK"===t.status),this.isSuccess&&this.initPassenger(),this.initBookingDetail(),this.handleSocketTimoutEvent()}handleSocketTimoutEvent(){const n=this._permissionService.getCurrentUser().userId;this._sockerService.timeoutEvent$.subscribe({next:i=>{this.refTimoutModal&&this.refTimoutModal.close(),this.refTimoutBts&&this.refTimoutBts.dismiss(),i.receiverId===n&&(this._toastService.add({severity:"success",summary:"Xu\u1ea5t v\xe9 th\xe0nh c\xf4ng",detail:"M\xe3 \u0111\u1eb7t ch\u1ed7 \u0111\xe3 \u0111\u01b0\u1ee3c xu\u1ea5t v\xe9 th\xe0nh c\xf4ng!",sticky:!1}),this.gotoBookingDetail(i.airline,i.pnr))}})}getBookingContact(){const t=this.bookFlightResult.data.find(n=>"OK"===n.status);this.bookingContact=t?t.bookingResult.bookingContact:this.bookingRequest.data.bookingContact}getBooingText(){const t=this.bookFlightResult.data.filter(n=>"OK"===n.status);this.listBookingText=t.filter(n=>n.bookingResult.bookingText).map(n=>{var i;return Object.assign(Object.assign({},n.bookingResult.bookingText),{airline:n.bookingResult.airline,totalPrice:new Intl.NumberFormat("vi-VN",{style:"currency",currency:"VND"}).format(n.bookingResult.bookingText.totalPrice||0),timeLimit:null!==(i=n.bookingResult.bookDetail)&&void 0!==i&&i.timeHoldBooking?T(n.bookingResult.bookDetail.timeHoldBooking).format("HH:mm, DD/MM/YYYY"):""})}),this.listBookingTextExplain=t.filter(n=>n.bookingResult.bookingTextExplain).map(n=>n.bookingResult.bookingTextExplain)}getAirlineLogo(t){return this._flightDataService.getAirlineLogoByCode(t)}initPassenger(){const t=this.bookFlightResult.data.find(n=>"OK"==n.status);t&&(this.passengerInfos=t.bookingResult.passengers.map(n=>({name:n.getName(),type:n.getType(),sex:n.getGender(),birthday:n.getBirthday()})),this.passengers=t.bookingResult.passengers.map(n=>({name:n.getName(),type:n.type,typeName:n.getType(),key:n.key})))}initBookingDetail(){this.isLoading=!0,(0,X.D)(this.bookFlightResult.data).pipe((0,W.z)(t=>{if("OK"==t.status){const n=t.bookingResult;return this.listBookingCode.push({bookingCode:n.bookingCode}),this.firstLoad||this.afterIssueBooking?(0,R.of)(this.parseBookingResult(t.bookingResult)):this._bookingDetailService.getBookingDetail(n.bookingCode,n.airline).pipe((0,ee.U)(i=>{if(i.success){const o=t.bookingResult,a=Object.create(Object.getPrototypeOf(o));return Object.assign(a,o,i.data),t.bookingResult=a,this.parseBookingResult(t.bookingResult)}return this.parseBookingResult(t.bookingResult)}),(0,te.K)(i=>(0,R.of)(this.parseBookingResult(t.bookingResult))))}{const n=t.bookingResult.journeys.flatMap(a=>a),i=[];let o;return n.forEach(a=>{const s=this.ticketSelected.find(l=>a.key===l.journeyKey);s&&(o=s,i.push(s))}),(0,R.of)({agentId:"",coOwnerId:"",bookingCode:"",holdLimitTime:"",codeAirline:"",provider:"",bookingCodeDisplay:"",airline:(null==o?void 0:o.airline)||"",airlineLogo:this._flightDataService.getAirlineLogoByCode(o.airline),mobileAirlineLogo:o&&["VJ","VN","QH","VU"].includes(o.airline)?"assets/airline-logo/"+o.airline+"_small.png":"assets/airline-logo/"+o.airline+".png",airlineName:this._flightDataService.getAirlineSystemNameByCode(o.airline),airlineSystem:(null==o?void 0:o.airline)||"",startPoint:(null==o?void 0:o.startCode)||"",endPoint:(null==o?void 0:o.endCode)||"",status:t.bookingResult.state,issued:!1,statusText:t.bookingResult.getStatusText(),statusDesc:t.error.errorDescription.vi?t.error.errorDescription.vi:t.error.errorDescription.en,caCode:"N/A",timeHoldBooking:new Date,timeHoldPricing:new Date,tourCode:"N/A",totalFare:0,totalCharge:0,totalServiceFee:0,targetPriceOrder:0,flightNumber:"",journeys:i.map(a=>({airline:a.airline,airlineLogo:this._flightDataService.getAirlineLogoByCode(a.airline),airlineName:this._flightDataService.getAirlineSystemNameByCode(a.airline),operating:a.operating,operatingName:a.operatingName,startPoint:a.startCode,startPointName:this._locationDataService.getCityNameByCode(a.startCode),endPoint:a.endCode,endPointName:this._locationDataService.getCityNameByCode(a.endCode),startTime:T(a.startTime).toDate(),endTime:T(a.endTime).toDate(),flightNumber:a.flight,duration:a.duration,key:a.journeyKey,numOfStops:0,segments:a.segments.map(s=>({airline:s.airline,airlineLogo:s.airlineLogo,airlineName:s.airlineName,startPoint:s.startCode,startPointName:s.startPointName,endPoint:s.endCode,endPointName:s.endPointName,startTime:T(s.departDate).toDate(),endTime:T(s.arrivalDate).toDate(),flightNumber:s.flightNumber,duration:s.duration,key:s.segmentKey,operating:s.operating,operatingName:s.operatingName,checkedBaggage:s.checkedBaggage||"",fareClass:s.fareClass||"",handBaggage:s.handBaggage||"",modelAirplane:s.modelAirplane||"",stopPoint:s.stopPoint})),journeyStatus:{active:!1,cancelled:!1,disrupted:!1}})),passengers:[],canRetry:t.error.canRetry,serviceFeeDetail:{adtFee:0,chdFee:0,infFee:0},isVJCancelAllJourney:!1,ticketingAllowed:!1})}}),function ae(){return(0,H.e)((c,f)=>{(function ne(c,f){return(0,H.e)((0,ie.U)(c,f,arguments.length>=2,!1,!0))})(oe,[])(c).subscribe(f)})}()).subscribe(t=>{this.bookingDetails=t,this.hasInternationalFlight=this.bookingDetails.some(n=>"BSP,AIR_1G".includes(n.provider)),this._getSeatCharge(),this._getBaggageCharge(),this.isSuccess&&this.initPriceDetail(),this.isSuccess&&this.initTotalPrice(),this.mappingJourneyBasic(),this.getBookingContact(),this.getBooingText(),this.isLoading=!1})}syncDelayPoint(t){for(let n=0;n<t.length-1;n++)t[n+1].delay=t[n].delay,t[n].delay=0;return t}parseBookingResult(t){var n,i,o,a;return t.journeys.forEach(s=>{"VN"===s.airline&&(s.segments=this.syncDelayPoint(s.segments))}),{agentId:t.agentId,coOwnerId:t.coOwnerId,bookingCode:t.bookingCode,holdLimitTime:t.bookingTextExplain.holdLimitTime,provider:t.provider,bookingCodeDisplay:t.bookingCode,airline:t.airline,airlineLogo:this._flightDataService.getAirlineLogoByCode(t.airline),mobileAirlineLogo:["VJ","VN","QH"].includes(t.airline)?"assets/airline-logo/"+t.airline+"_small.png":"assets/airline-logo/"+t.airline+".png",airlineName:["VJ","VN","QH"].includes(t.airline)?this._flightDataService.getAirlineSystemNameByCode(t.airline):t.airlineName,airlineSystem:t.airline,startPoint:t.journeys[0].departure.airport.code,endPoint:1===t.journeys.length?t.journeys[0].arrival.airport.code:t.journeys[t.journeys.length-1].departure.airport.code,status:t.state,issued:t.issued,statusText:this.getStatusText(t.state),statusDesc:"N/A",caCode:"N/A",timeHoldBooking:null!==(n=t.bookDetail)&&void 0!==n&&n.timeHoldBooking?T(t.bookDetail.timeHoldBooking).format("HH:mm, DD/MM/YYYY"):"",timeHoldPricing:null!==(i=t.bookDetail)&&void 0!==i&&i.timeKeepPrice?T(t.bookDetail.timeKeepPrice).format("HH:mm, DD/MM/YYYY"):"N/A",tourCode:"N/A",totalFare:t.fareCharges.total?t.fareCharges.total.total:null,totalServiceFee:t.totalCharges.total?t.totalCharges.total.totalServiceFee:null,totalCharge:t.totalCharges.total.total,targetPriceOrder:null===(o=t.fareCharges)||void 0===o?void 0:o.getTotalChargeOrder(),flightNumber:`${t.journeys[0].segments[0].airline}${t.journeys[0].segments[0].flightNumber}`,journeys:t.journeys.map(s=>{var l,g,r,h,u,p;return{airline:s.airline,airlineLogo:this._flightDataService.getAirlineLogoByCode(s.airline),airlineName:this._flightDataService.getAirlineSystemNameByCode(s.airline),operating:s.operating,operatingName:s.operatingName,startPoint:s.departure.airport.code,startPointName:this._locationDataService.getCityNameByCode(s.departure.airport.code),endPoint:s.arrival.airport.code,endPointName:this._locationDataService.getCityNameByCode(s.arrival.airport.code),startTime:T(s.departure.localTime).toDate(),endTime:T(s.arrival.localTime).toDate(),key:s.key,segments:s.segments.map(m=>{var _,B,x,y,E,I;const M=m.getDelayString();return{airline:m.airline,airlineLogo:this._flightDataService.getAirlineLogoByCode(m.operating||m.airline),airlineName:this._flightDataService.getAirlineSystemNameByCode(m.operatingName),startPoint:m.departure.airport.code,startPointName:this._locationDataService.getCityNameByCode(m.departure.airport.code),endPoint:m.arrival.airport.code,endPointName:this._locationDataService.getCityNameByCode(m.arrival.airport.code),startTime:T(m.departure.localTime).toDate(),endTime:T(m.arrival.localTime).toDate(),flightNumber:m.flightNumber,duration:m.getDurationString(),shortDuration:(0,G.N)(m.duration),key:m.key,operating:m.operating,operatingName:m.operatingName,codeAirline:m.codeAirline,checkedBaggage:(null===(_=m.bookedInfo)||void 0===_?void 0:_.checkedBaggage)||"",fareClass:(null===(B=m.bookedInfo)||void 0===B?void 0:B.fareClass)||"",fareType:(null===(x=m.bookedInfo)||void 0===x?void 0:x.fareType)||(null===(y=m.bookedInfo)||void 0===y?void 0:y.fareClass)||"",fareBasic:(null===(E=m.bookedInfo)||void 0===E?void 0:E.fareBasic)||"",handBaggage:(null===(I=m.bookedInfo)||void 0===I?void 0:I.handBaggage)||"",accompaniedService:t.getAccompaniedService(s.key),modelAirplane:m.modelAirplane,stopPoint:M?`D\u1eebng t\u1ea1i: ${this._locationDataService.getAirportNameByCode(m.departure.airport.code)} (${m.departure.airport.code}). Th\u1eddi gian d\u1eebng: ${M}`:""}}),journeyStatus:{active:null!==(g=null===(l=s.status)||void 0===l?void 0:l.active)&&void 0!==g&&g,cancelled:null!==(h=null===(r=s.status)||void 0===r?void 0:r.cancelled)&&void 0!==h&&h,disrupted:null!==(p=null===(u=s.status)||void 0===u?void 0:u.disrupted)&&void 0!==p&&p}}}),passengers:t.passengers.map(s=>{var l,g,r,h,u;return{index:s.index,name:s.getName(),firstName:s.firstName,lastName:s.lastName,type:s.getType(),farePrice:t.fareCharges.getBaseCharge(s.type)-t.fareCharges.getDiscount(s.type),tax:t.fareCharges.getTaxCharge(s.type),vat:t.fareCharges.getVATCharge(s.type),total:t.fareCharges.getTotalCharge(s.type),key:s.key,parentKey:s.parentKey,birthday:s.birthday,namePrefix:s.namePrefix,gender:s.gender,documentType:(null===(l=s.document)||void 0===l?void 0:l.documentType)||"",expiryDate:(null===(g=s.document)||void 0===g?void 0:g.expiryDate)||"",issuanceCountry:(null===(r=s.document)||void 0===r?void 0:r.issuanceCountry)||"",nationality:(null===(h=s.document)||void 0===h?void 0:h.nationality)||"",number:(null===(u=s.document)||void 0===u?void 0:u.number)||""}}),actions:this.getListTicketAction(t.state,t.provider),bookingTextExplain:t.bookingTextExplain,serviceFeeDetail:t.serviceFeeDetail,isVJCancelAllJourney:"VJ"==t.airline&&0==t.journeys.length,ticketingAllowed:null!==(a=t.bookDetail.ticketingAllowed)&&void 0!==a&&a}}getStatusText(t){switch(t){case"BOOKED":return"\u0110\xe3 gi\u1eef ch\u1ed7";case"ISSUED":return"\u0110\xe3 xu\u1ea5t v\xe9";case"REFUND":return"\u0110\xe3 ho\xe0n";case"CANCEL":return"\u0110\xe3 h\u1ee7y";case"EXPIRED":return"H\u1ebft h\u1ea1n";case"INVALID":return"Kh\xf4ng c\xf2n gi\xe1 tr\u1ecb";case"VOID":return"\u0110\xe3 void";default:return"\u0110\u1eb7t ch\u1ed7 l\u1ed7i"}}initPriceDetail(){this.priceDetail={provider:this.bookFlightResult.data.filter(t=>"OK"==t.status).map(t=>t.bookingResult.provider),totalBasePrice:this.bookFlightResult.data.filter(t=>"OK"==t.status).flatMap(t=>t.bookingResult.totalCharges?t.bookingResult.totalCharges.total.totalFareCharge:0).reduce((t,n)=>t+n,0),totalServiceFee:this.bookFlightResult.data.filter(t=>"OK"==t.status).flatMap(t=>t.bookingResult.totalCharges?t.bookingResult.totalCharges.total.totalServiceFee:0).reduce((t,n)=>t+n,0),totalAddonService:this.computeTotalChargeAddOn(),totalOthersCharge:this.bookFlightResult.data.filter(t=>"OK"==t.status).flatMap(t=>t.bookingResult.totalCharges?t.bookingResult.totalCharges.total.totalOthersCharge:0).reduce((t,n)=>t+n,0),passengers:this.passengers.map(t=>({name:t.name,type:t.typeName,base:this.bookFlightResult.data.filter(n=>"OK"==n.status).flatMap(n=>n.bookingResult.fareCharges.getBaseCharge(t.type)-n.bookingResult.fareCharges.getDiscount(t.type)).reduce((n,i)=>n+i,0),tax:this.bookFlightResult.data.filter(n=>"OK"==n.status).flatMap(n=>n.bookingResult.fareCharges.getTaxAndVat(t.type)).reduce((n,i)=>n+i,0),total:this.bookFlightResult.data.filter(n=>"OK"==n.status).flatMap(n=>n.bookingResult.fareCharges.getTotalCharge(t.type)).reduce((n,i)=>n+i,0)}))}}initTotalPrice(){this.totalPrice=this.bookFlightResult.data.filter(t=>"OK"==t.status).flatMap(t=>t.bookingResult.totalCharges.total?t.bookingResult.totalCharges.total.totalFareCharge+t.bookingResult.totalCharges.total.totalServiceFee:-1).reduce((t,n)=>t+n,0)+this.computeTotalChargeAddOn()}onActionChange(t,n){const i={airline:n.airlineSystem,bookingCode:n.bookingCode,payNow:"ISSUED"===n.status,bookingStatus:n.status,provider:n.provider};switch(t){case"booking_detail":return this.gotoBookingDetail(i.airline,i.bookingCode);case"addon_baggage":return this.onAddonBaggage(i);case"addon_seat":return this.onAddonSeat(i);case"void":return this.onVoidBooking(i);case"issue":return this.onIssueBooking(i);case"boarding_pass":return this.onShowBoardingPass(n);case"delete_segments":return this.onDeleteSegment(n);case"delete_each_journey":return this.onDeleteEachJourney(n);case"register_order":return this._eventLogService.captureOpenFormDownFare({hasPNR:1,source:0}),this.onRegisterOrder(n);case"send_email":return this.onSendEmail(n);case"rerouting":return this.onRerouting(n);case"add_journey":return this.onAddonJourney(n);case"separate_passengers":return this.onSeparatePassengers(n);case"open_audit_log":return this.onOpenAuditLog(n);case"check_in_online":return this.onCheckInOnline(n);case"update_pax_info":return this.onUpdatePaxInfo(n);default:return}}gotoBookingDetail(t,n){this._route.navigate([`admin/booking-detail/${t}/${n}`])}gotoDownFareDetail(t){this._route.navigate([`admin/pnr-order-detail/${t}`])}onAddonBaggage(t){var n;if(D.PY&&"VN"===(null===(n=t.airline)||void 0===n?void 0:n.toUpperCase()))return void this._modal.open(b.z5,{title:"Th\xf4ng b\xe1o",content:"H\u1ec7 th\u1ed1ng m\u1edbi Vietnam Airlines ch\u01b0a h\u1ed7 tr\u1ee3 t\xednh n\u0103ng n\xe0y. Xin li\u1ec7n h\u1ec7 booker \u0111\u1ec3 \u0111\u01b0\u1ee3c h\u1ed7 tr\u1ee3",status:"error",cancelText:"\u0110\xf3ng"});if(this.dataBaggageInput=this.mappingDataBaggageInput(t),!this.dataBaggageInput.length||this.dataBaggageInput.every(o=>!o.journeys.length))return void this._toastService.add({severity:"error",summary:"Th\xeam h\xe0nh l\xfd th\u1ea5t b\u1ea1i",detail:"H\xe0nh l\xfd \u0111\xe3 c\xf3",sticky:!1});const i=Object.assign({},t);if(this._detectMobileService.isMobile()){const o=this._bottomSheetService.open(N.AddOnBaggageModalComponent,{headerTitle:"Th\xeam h\xe0nh l\xfd",leftButtonIcon:"arrow_left",leftButtonIconClass:"text-neutral-gray-4",rightButtonIcon:"",containerFullHeigh:!0,data:{dataBaggageInput:this.dataBaggageInput,addonBaggageReq:i,type:"baggage_addon",bookingInfo:t}});o.containerInstance._leftButtonClick.subscribe(a=>o.dismiss()),o.afterDismissed().subscribe(a=>{this.processAddonBaggage({type:"",data:a})})}else this._modal.open(N.AddOnBaggageModalComponent,{dataBaggageInput:this.dataBaggageInput,addonBaggageReq:i,type:"baggage_addon",bookingInfo:t}).afterClosed$.subscribe({next:a=>{this.processAddonBaggage(a)}})}processAddonBaggage(t){if("backdropClick"==t.type)return;const n=t.data;if(n&&n.success){const i=n.data,o=i.bookingCode,a=this.bookFlightResult.data.find(l=>l.bookingResult.bookingCode===o),s=i.addOnCharges.map(l=>({charge:Object.assign({},l.charge.charge),ssrInfo:{category:{name:l.ancillaryItem.category,description:l.ancillaryItem.description},code:"",description:l.ancillaryItem.description,journeyKey:l.ancillaryItem.journeyKey,name:l.ancillaryItem.name,passengerKey:l.ancillaryItem.passengerKey,segmentKey:"",unit:"",weight:""}}));if(a&&(a.bookingResult.ssrCharges.push(...s),this._bookingResultDataProvider.bookingResultData=this.bookFlightResult,this.priceDetail.totalServiceFee+=i.derivativeFee,this._getBaggageCharge(),this.initPriceDetail(),this.initTotalPrice(),this.getShortRetrieve(a.bookingResult.airline,i.bookingCode)),this._detectMobileService.isMobile()){const l=this._bottomSheetService.open(b.z5,{headerTitle:"",rightButtonIcon:"close",rightButtonIconClass:"text-neutral-gray-4",leftButtonIcon:"",data:{title:"Th\xeam h\xe0nh l\xfd th\xe0nh c\xf4ng!",content:"<div>\u0110\xe3 th\xeam h\xe0nh l\xfd cho booking code:</div>",status:"success",okText:"OK",extraText:`${o}`}});l.containerInstance._rightButtonClick.subscribe(g=>l.dismiss())}else this._modal.open(b.z5,{title:"Th\xeam h\xe0nh l\xfd th\xe0nh c\xf4ng!",content:"<div>\u0110\xe3 th\xeam h\xe0nh l\xfd cho booking code:</div>",status:"success",okText:"OK",extraText:`${o}`})}else if(n&&!n.success){const i=n.objectError.errorDescription.vi?n.objectError.errorDescription.vi:n.objectError.errorDescription.en;if(this._detectMobileService.isMobile()){const o=this._bottomSheetService.open(b.z5,{headerTitle:"",rightButtonIcon:"close",rightButtonIconClass:"text-neutral-gray-4",leftButtonIcon:"",data:{title:"Th\xeam h\xe0nh l\xfd th\u1ea5t b\u1ea1i",content:`<div>\n                        <div>${i}</div>\n                        <div>Vui l\xf2ng th\u1eed l\u1ea1i sau!</div>\n                    </div>`,status:"error",okText:"Th\u1eed l\u1ea1i",cancelText:"\u0110\xf3ng"}});o.containerInstance._rightButtonClick.subscribe(a=>o.dismiss())}else this._modal.open(b.z5,{title:"Th\xeam h\xe0nh l\xfd th\u1ea5t b\u1ea1i",content:`<div>\n                      <div>${i}</div>\n                      <div>Vui l\xf2ng th\u1eed l\u1ea1i sau!</div>\n                  </div>`,status:"error",okText:"Th\u1eed l\u1ea1i",cancelText:"\u0110\xf3ng"})}}onAddonSeat(t){this.dataSeatInput=this.mappingDataSeatInput(t);const n=Object.assign({},t);if(this._detectMobileService.isMobile()){const i=this._bottomSheetService.open(N.AddOnSeatModalComponent,{headerTitle:"Th\xeam ch\u1ed7 ng\u1ed3i",leftButtonIcon:"arrow_left",leftButtonIconClass:"text-neutral-gray-4",rightButtonIcon:"",containerFullHeigh:!0,data:{dataSeatInput:this.dataSeatInput,addonSeatReq:n,type:"seat_addon",bookingInfo:t}});i.containerInstance._leftButtonClick.subscribe(o=>i.dismiss()),i.afterDismissed().subscribe(o=>{this.processAddonSeat(o)})}else this._modal.open(N.AddOnSeatModalComponent,{dataSeatInput:this.dataSeatInput,addonSeatReq:n,type:"seat_addon",bookingInfo:t}).afterClosed$.subscribe({next:o=>{this.processAddonSeat(o.data)}})}processAddonSeat(t){let n=t;if(!t.data.addOnCharges&&t.data.data&&(n=t.data),n&&n.success){const i=n.data,o=i.bookingCode,a=this.bookFlightResult.data.find(l=>l.bookingResult.bookingCode===o),s=i.addOnCharges.map(l=>({charge:Object.assign({},l.charge.charge),seatInfos:{journeyKey:l.seatItem.journeyKey,mapCell:Object.assign({},l.seatItem.mapCell),passengerKey:l.seatItem.passengerKey,segmentKey:l.seatItem.segmentKey}}));if(a&&(a.bookingResult.seatCharges.push(...s),this._bookingResultDataProvider.bookingResultData=this.bookFlightResult,this.priceDetail.totalServiceFee+=i.derivativeFee,this._getSeatCharge(),this.initPriceDetail(),this.initTotalPrice(),this.getShortRetrieve(a.bookingResult.airline,i.bookingCode)),this._detectMobileService.isMobile()){const l=this._bottomSheetService.open(b.z5,{headerTitle:"",rightButtonIcon:"close",rightButtonIconClass:"text-neutral-gray-4",leftButtonIcon:"",data:{title:"Th\xeam ch\u1ed7 ng\u1ed3i th\xe0nh c\xf4ng!",content:"<div>\u0110\xe3 th\xeam ch\u1ed7 ng\u1ed3i cho booking code:</div>",status:"success",okText:"OK",extraText:`${o}`}});l.containerInstance._rightButtonClick.subscribe(g=>l.dismiss())}else this._modal.open(b.z5,{title:"Th\xeam ch\u1ed7 ng\u1ed3i th\xe0nh c\xf4ng!",content:"<div>\u0110\xe3 th\xeam ch\u1ed7 ng\u1ed3i cho booking code:</div>",status:"success",okText:"OK",extraText:`${o}`})}if(n&&!n.success){const i=n.objectError.errorDescription.vi?n.objectError.errorDescription.vi:n.objectError.errorDescription.en;if(this._detectMobileService.isMobile()){const o=this._bottomSheetService.open(b.z5,{headerTitle:"",rightButtonIcon:"close",rightButtonIconClass:"text-neutral-gray-4",leftButtonIcon:"",data:{title:"Th\xeam ch\u1ed7 ng\u1ed3i th\u1ea5t b\u1ea1i",content:`<div>\n                      <div>${i}</div>\n                      <div>Vui l\xf2ng th\u1eed l\u1ea1i sau!</div>\n                  </div>`,status:"error",okText:"Th\u1eed l\u1ea1i",cancelText:"\u0110\xf3ng"}});o.containerInstance._rightButtonClick.subscribe(a=>o.dismiss())}else this._modal.open(b.z5,{title:"Th\xeam ch\u1ed7 ng\u1ed3i th\u1ea5t b\u1ea1i",content:`<div>\n                      <div>${i}</div>\n                      <div>Vui l\xf2ng th\u1eed l\u1ea1i sau!</div>\n                  </div>`,status:"error",okText:"Th\u1eed l\u1ea1i",cancelText:"\u0110\xf3ng"})}}mappingDataBaggageInput(t){var n,i;let o=[];const a=null===(i=null===(n=this.bookFlightResult.data)||void 0===n?void 0:n.find(s=>s.bookingResult.bookingCode===t.bookingCode))||void 0===i?void 0:i.bookingResult;return a&&(o=a.passengers.filter(s=>"INFANT"!==s.type).map(s=>{var l;return{passengerKey:s.key,passengerType:s.type,passengerName:s.lastName+" "+s.firstName,addBaggageFee:(null===(l=s.passengerDerivativeFee)||void 0===l?void 0:l.addBaggageFee)||0,journeys:a.journeys.filter(g=>{const r=a.ssrCharges?a.ssrCharges.filter(h=>"baggage"===h.ssrInfo.category.name.toLowerCase()&&h.ssrInfo.journeyKey===g.key&&h.ssrInfo.passengerKey===s.key):[];return!("VN"===g.airline&&r.length>=this.maxBag||"VN"!==g.airline&&r.length)&&g}).map(g=>{const r=T(g.departure.localTime).toDate();return{flight:g.segments[0].airline.concat(" ",g.segments[0].flightNumber),flightNumber:g.segments[0].flightNumber,airlineName:this._flightDataService.getAirlineSystemNameByCode(g.airline),airlineLogo:this.getAirlineLogo(g.airline),journeyKey:g.key,journeyName:`D\u1ecbch v\u1ee5 b\u1ed5 sung ${g.departure.airport.code}-${g.arrival.airport.code}, ${(0,S.p6)(r,"EEEE, ","vi-VN")} ${r.getDate()} th\xe1ng ${r.getMonth()+1}, ${r.getFullYear()}`,leg:g.leg,fareOptionKey:"",startCode:g.departure.airport.code,endCode:g.arrival.airport.code,startTime:(0,S.p6)(new Date(g.departure.localTime),"EEEE, dd/MM/yyyy","vi-VN"),baggageOptions:[],baggageSelected:{baggageName:"",baggageKey:"",containerKey:"",totalCharge:0}}})}})),o=o.filter(s=>s.journeys.length),o}mappingDataSeatInput(t){var n,i;const o=null===(i=null===(n=this.bookFlightResult.data)||void 0===n?void 0:n.find(s=>s.bookingResult.bookingCode===t.bookingCode))||void 0===i?void 0:i.bookingResult;let a=[];return o&&(a=o.journeys.map(s=>({segments:s.segments.map(l=>{var g;const r=T(l.departure.localTime).toDate(),h=`${(0,S.p6)(r,"EEEE, ","vi-VN")} ${r.getDate()} th\xe1ng ${r.getMonth()+1}, ${r.getFullYear()}`;return{airline:l.airline,flightNumber:l.flightNumber,modelAirplaneName:"",bookingCode:null!==(g=o.bookingCode)&&void 0!==g?g:"",serviceName:`Th\xeam ch\u1ed7 ng\u1ed3i tr\xean chuy\u1ebfn bay ${l.departure.airport.code}-${l.arrival.airport.code}, ${h}`,mobileServiceName:`${l.departure.airport.code}-${l.arrival.airport.code}, ${h}`,airlineLogo:this._flightDataService.getAirlineLogoByCode(l.airline),jetCode:"N/A",startCode:l.departure.airport.code,endCode:l.arrival.airport.code,departDate:h,passengers:o.passengers.filter(u=>"INFANT"!==u.type).map(u=>{var p;const m=o.seatCharges.find(_=>_.seatInfos.passengerKey===u.key&&_.seatInfos.journeyKey===s.key&&_.seatInfos.segmentKey===l.key);return{passengerName:`${u.lastName} ${u.firstName}`,passengerType:u.type.toLowerCase(),passengerKey:u.key,addSeatFee:(null===(p=u.passengerDerivativeFee)||void 0===p?void 0:p.addSeatFee)||0,seatSelected:{containerKey:"",seat:m?m.seatInfos.mapCell.row+m.seatInfos.mapCell.identifier:"",seatKey:"",totalPrice:m?m.charge.total:0}}}),segmentKey:l.key,segmentIndex:l.index,journeyKey:s.key,leg:s.leg,active:!1,seatSegment:{rows:[],cols:[],containerKey:"",seatMaps:[]},available:!(o.seatCharges&&o.seatCharges.some(u=>u.seatInfos.journeyKey===s.key&&u.seatInfos.segmentKey===l.key))}})})).flatMap(s=>s.segments)),a.map((s,l)=>Object.assign(Object.assign({},s),{active:0===l}))}mappingJourneyBasic(){this.listJourneyBasic=this.bookingDetails.filter(t=>"INVALID"!==t.status).map(t=>({journeyInfo:t.journeys.map(n=>({airlineLogo:n.airlineLogo,flight:`${n.startPoint} - ${n.endPoint}`,startTime:(0,S.p6)(n.startTime?new Date(n.startTime):new Date,"dd/MM/yyyy","vi-VN"),journeyKey:n.key}))})).flatMap(t=>t.journeyInfo)}computeTotalChargeAddOn(){return this.listBaggage.reduce((i,o)=>i+o.totalCharge,0)+this.listService.reduce((i,o)=>i+o.totalCharge,0)}_getSeatCharge(){this.listService.length=0,this.bookFlightResult.data.filter(n=>"ERROR"!==n.bookingResult.state&&n.bookingResult.seatCharges&&n.bookingResult.seatCharges.length).forEach(n=>{const i=n.bookingResult,o=i.journeys.flatMap(l=>l.segments),a=i.passengers,s=n.bookingResult.seatCharges.map(l=>{const g=a.find(h=>h.key===l.seatInfos.passengerKey),r=o.find(h=>h.key===l.seatInfos.segmentKey);return{airline:(null==r?void 0:r.airline)||"",airlineName:r?this._flightDataService.getAirlineNameByCode(r.airline):"",airlineLogo:r?this.getAirlineLogo(r.airline):"",journeyKey:"",flight:r?r.departure.airport.code+" - "+r.arrival.airport.code:"",flightName:r?this._locationDataService.getCityNameByCode(r.departure.airport.code)+" - "+this._locationDataService.getCityNameByCode(r.arrival.airport.code):"",flightNumber:r?`${r.airline}${r.flightNumber}`:"",departDate:r?(0,S.p6)(new Date(r.departure.localTime),"dd/MM/yyyy","vi-VN"):"",passengerKey:g?g.key:"",passengerName:g?g.lastName+" "+g.firstName:"",serviceKey:"",totalCharge:l.charge.total,serviceName:l.seatInfos.mapCell.seatNumber?l.seatInfos.mapCell.seatNumber:l.seatInfos.mapCell.row+l.seatInfos.mapCell.identifier,categoryName:"seat"}});this.listService.push(...s)}),this.hasSeatSelected=this.listService.some(n=>n)}_getBaggageCharge(){const t=this.bookFlightResult.data.filter(i=>"ERROR"!==i.bookingResult.state&&i.bookingResult.ssrCharges&&i.bookingResult.ssrCharges.length),n=[];t.forEach(i=>{const o=i.bookingResult,a=o.journeys,s=o.passengers,l=i.bookingResult.ssrCharges.map(g=>{const r=s.find(u=>u.key===g.ssrInfo.passengerKey),h=a.find(u=>u.key===g.ssrInfo.journeyKey);return{airline:(null==h?void 0:h.airline)||"",airlineName:h?this._flightDataService.getAirlineNameByCode(h.airline):"",airlineLogo:h?this.getAirlineLogo(h.airline):"",journeyKey:h?h.key:"",flight:h?h.departure.airport.code+" - "+h.arrival.airport.code:"",flightName:h?this._locationDataService.getCityNameByCode(h.departure.airport.code)+" - "+this._locationDataService.getCityNameByCode(h.arrival.airport.code):"",flightNumber:"",departDate:h?(0,S.p6)(new Date(h.departure.localTime),"dd/MM/yyyy","vi-VN"):"",passengerKey:r?r.key:"",passengerName:r?r.lastName+" "+r.firstName:"",serviceKey:"",totalCharge:g.charge.total,serviceName:g.ssrInfo.name,categoryName:g.ssrInfo.category.name.toLowerCase()}});n.push(...l)}),this.listBaggage=n,this.hasBaggageSelected=this.listBaggage.some(i=>i)}onVoidBooking(t){this._modal.open(C.hF,{bookingCode:t.bookingCode,airline:t.airline})}onIssueBooking(t){var n,i;if("ISSUED"===t.status&&D.PY&&"VN"===(null===(n=t.airline)||void 0===n?void 0:n.toUpperCase()))return void this._modal.open(b.z5,{title:"Th\xf4ng b\xe1o",content:"H\u1ec7 th\u1ed1ng m\u1edbi Vietnam Airlines ch\u01b0a h\u1ed7 tr\u1ee3 t\xednh n\u0103ng n\xe0y. Xin li\u1ec7n h\u1ec7 booker \u0111\u1ec3 \u0111\u01b0\u1ee3c h\u1ed7 tr\u1ee3",status:"error",cancelText:"\u0110\xf3ng"});const o={title:"Xu\u1ea5t v\xe9 th\xe0nh c\xf4ng",content:"<div>V\xe9 \u0111\xe3 \u0111\u01b0\u1ee3c xu\u1ea5t th\xe0nh c\xf4ng!</div>",status:"success",okText:"X\xe1c nh\u1eadn"},a={title:"Xu\u1ea5t v\xe9 th\u1ea5t b\u1ea1i",content:"<div>Xu\u1ea5t s\u1ed1 v\xe9 kh\xf4ng th\xe0nh c\xf4ng. Vui l\xf2ng th\u1eed l\u1ea1i ho\u1eb7c li\xean h\u1ec7 booker \u0111\u1ec3 \u0111\u01b0\u1ee3c h\u1ed7 tr\u1ee3!</div>",status:"error"},s={agentId:"",airline:t.airline,bookingCode:t.bookingCode,bookingPrice:0,internal:!0,provider:t.provider,passengers:[]};if("BSP"===(null===(i=t.provider)||void 0===i?void 0:i.toUpperCase())){const l=g=>{s.passengers=this.bookingDetails[0].passengers.map(r=>{const h=g.find(u=>u.index==u.index);return{documentInfo:[{documentType:"PASSPORT",expiryDate:null!=h&&h.expiryDate&&T(null==h?void 0:h.expiryDate).format("YYYY-MM-DD")||"",issuanceCountry:(null==h?void 0:h.issuanceCountry)||"",nationality:(null==h?void 0:h.nationality)||"",number:(null==h?void 0:h.number)||""}],index:r.index}}),this.isLoading=!0,this._manageBookingService.issueTicket(s).pipe((0,A.x)(()=>this.isLoading=!1)).subscribe({next:r=>{if(r.success&&r.data){this.afterIssueBooking=!0,this._modal.open(b.z5,o);const h=this.bookFlightResult.data.find(u=>u.bookingResult.bookingCode===t.bookingCode);h&&(h.bookingResult=Object.assign(Object.assign({},r.data),{passengers:h.bookingResult.passengers}),this._bookingResultDataProvider.bookingResultData=this.bookFlightResult,this.bookFlightResult=(0,Z.yE)(P.aM,this._bookingResultDataProvider.bookingResultData,{excludeExtraneousValues:!0}),this.initBookingDetail(),this.initPriceDetail(),this.getShortRetrieve(s.airline,s.bookingCode))}else if("DS-EL005"===r.objectError.errorCode){const h=r.objectError.errorData.priceInfo.newPrice-r.objectError.errorData.priceInfo.oldPrice,u={newPrice:r.objectError.errorData.priceInfo.newPrice,oldPrice:r.objectError.errorData.priceInfo.oldPrice,priceGap:Math.abs(h),type:h>0?"+":"-"};this._modal.open(q.EH,{priceChangeData:u}).afterClosed$.subscribe({next:m=>{m.data&&(this.isLoading=!0,this._manageBookingService.issueTicket(s).pipe((0,A.x)(()=>this.isLoading=!1)).subscribe({next:_=>{_.success?this._modal.open(b.z5,o).afterClosed$.subscribe({next:x=>{if(x.data){const y=this.bookFlightResult.data.find(E=>E.bookingResult.bookingCode===t.bookingCode);y&&(y.bookingResult.state=_.data.state,y.bookingResult.issued=_.data.issued,this._bookingResultDataProvider.bookingResultData=this.bookFlightResult,this.initBookingDetail())}}}):(a.content=_.objectError.errorDescription.vi?_.objectError.errorDescription.vi:_.objectError.errorDescription.en,this._modal.open(b.z5,a))}}))}})}else"DS-EH001"===r.objectError.errorCode?this.hanldeTimeoutIssue():(a.content=r.objectError.errorDescription.vi?r.objectError.errorDescription.vi:r.objectError.errorDescription.en,this._modal.open(b.z5,a))},error:r=>{r instanceof J.W?this.hanldeTimeoutIssue():this._modal.open(b.z5,a)}})};if(this._detectMobileService.isMobile()){const g=this._bottomSheetService.open(b.V0,{headerTitle:"Kh\xf4ng th\u1ec3 ti\u1ebfp t\u1ee5c",rightButtonIcon:"close",rightButtonIconClass:"text-neutral-gray-4",data:{title:"",body:"C\u1ea7n b\u1ed5 sung \u0111\u1ea7y \u0111\u1ee7 th\xf4ng tin h\u1ed9 chi\u1ebfu c\u1ee7a h\xe0nh kh\xe1ch tr\u01b0\u1edbc khi xu\u1ea5t v\xe9",okText:"B\u1ed5 sung",cancelText:"\u0110\xf3ng",hasIcon:!0}});g.containerInstance._rightButtonClick.subscribe(()=>{g.dismiss()}),g.afterDismissed().subscribe({next:r=>{if(r){const h=[];this.bookingDetails[0].passengers.forEach((p,m)=>{h.push({index:p.index,key:p.key||"",name:p.lastName+" "+p.firstName,parentKey:"N/A"==p.parentKey||null==p.parentKey?"":p.parentKey,type:p.type,child:"N/A",selected:0==m,gender:p.gender,firstName:p.firstName,lastName:p.lastName,dayOfBirth:p.birthday?p.birthday:"",parentName:"",fullType:p.type,expiryDate:p.expiryDate,issuanceCountry:p.issuanceCountry,nationality:p.nationality,number:p.number})});const u=this._bottomSheetService.open(C.vj,{headerTitle:"Ch\u1ec9nh s\u1eeda h\u1ed9 chi\u1ebfu",rightButtonIcon:"close",rightButtonIconClass:"text-neutral-gray-4",containerFullHeigh:!0,data:{listPaxUpdate:h}});u.containerInstance._rightButtonClick.subscribe(()=>{u.dismiss()}),u.afterDismissed().subscribe({next:p=>{p&&l(p)}})}}})}else this._modal.open(b.V0,{title:"Kh\xf4ng th\u1ec3 ti\u1ebfp t\u1ee5c",body:"C\u1ea7n b\u1ed5 sung \u0111\u1ea7y \u0111\u1ee7 th\xf4ng tin h\u1ed9 chi\u1ebfu c\u1ee7a h\xe0nh kh\xe1ch tr\u01b0\u1edbc khi xu\u1ea5t v\xe9",status:"error",okText:"B\u1ed5 sung",cancelText:"\u0110\xf3ng"}).afterClosed$.subscribe({next:r=>{if(r.data){const h=[];this.bookingDetails[0].passengers.forEach((p,m)=>{h.push({index:p.index,key:p.key||"",name:p.lastName+" "+p.firstName,parentKey:"N/A"==p.parentKey||null==p.parentKey?"":p.parentKey,type:p.type,child:"N/A",selected:0==m,gender:p.gender,firstName:p.firstName,lastName:p.lastName,dayOfBirth:p.birthday?p.birthday:"",parentName:"",fullType:p.type,expiryDate:p.expiryDate,issuanceCountry:p.issuanceCountry,nationality:p.nationality,number:p.number})}),this._modal.open(C.vj,{listPaxUpdate:h}).afterClosed$.subscribe({next:p=>{p.data&&l(p.data)}})}}})}else this._modal.open(b.V0,{title:"X\xe1c nh\u1eadn xu\u1ea5t v\xe9",body:"B\u1ea1n c\xf3 ch\u1eafc ch\u1eafn mu\u1ed1n xu\u1ea5t v\xe9 n\xe0y kh\xf4ng."}).afterClosed$.subscribe({next:g=>{g.data&&(this.isLoading=!0,this._manageBookingService.issueTicket(s).pipe((0,A.x)(()=>this.isLoading=!1)).subscribe({next:r=>{if(r.success&&r.data){this.afterIssueBooking=!0,this._modal.open(b.z5,o);const h=this.bookFlightResult.data.find(u=>u.bookingResult.bookingCode===t.bookingCode);h&&(h.bookingResult=Object.assign(Object.assign({},r.data),{passengers:h.bookingResult.passengers}),this._bookingResultDataProvider.bookingResultData=this.bookFlightResult,this.bookFlightResult=(0,Z.yE)(P.aM,this._bookingResultDataProvider.bookingResultData,{excludeExtraneousValues:!0}),this.initBookingDetail(),this.initPriceDetail(),this.getShortRetrieve(s.airline,s.bookingCode))}else if("DS-EL005"===r.objectError.errorCode){const h=r.objectError.errorData.priceInfo.newPrice-r.objectError.errorData.priceInfo.oldPrice,u={newPrice:r.objectError.errorData.priceInfo.newPrice,oldPrice:r.objectError.errorData.priceInfo.oldPrice,priceGap:Math.abs(h),type:h>0?"+":"-"};this._modal.open(q.EH,{priceChangeData:u}).afterClosed$.subscribe({next:m=>{m.data&&(this.isLoading=!0,this._manageBookingService.issueTicket(s).pipe((0,A.x)(()=>this.isLoading=!1)).subscribe({next:_=>{_.success?this._modal.open(b.z5,o).afterClosed$.subscribe({next:x=>{if(x.data){const y=this.bookFlightResult.data.find(E=>E.bookingResult.bookingCode===t.bookingCode);y&&(y.bookingResult.state=_.data.state,y.bookingResult.issued=_.data.issued,this._bookingResultDataProvider.bookingResultData=this.bookFlightResult,this.initBookingDetail())}}}):(a.content=_.objectError.errorDescription.vi?_.objectError.errorDescription.vi:_.objectError.errorDescription.en,this._modal.open(b.z5,a))}}))}})}else"DS-EH001"===r.objectError.errorCode?this.hanldeTimeoutIssue():(a.content=r.objectError.errorDescription.vi?r.objectError.errorDescription.vi:r.objectError.errorDescription.en,this._modal.open(b.z5,a))},error:r=>{r instanceof J.W?this.hanldeTimeoutIssue():this._modal.open(b.z5,a)}}))}})}onShare(t){const n="origin"===this.modeBookingText?this.getOriginText(t):this.getExplaneText(t);this.clipboard.copy(n)}getOriginText(t){var n,i,o,a,s,l,g,r,h,u,p;if(this.listBookingText){let m="";const _=this.listBookingText.find(B=>B.airline===t);return _&&("VN"===_.airline?(m+=`${_.bookingCodeText}\r\n`,m+=(null!==(n=_.passengerTexts)&&void 0!==n?n:[]).join("\r\n")+"\r\n",m+=(null!==(i=_.segmentTexts)&&void 0!==i?i:[]).join("\r\n ")+"\r\n",m+="TKT/TIME LIMIT\r\n ",m+=(null!==(o=_.ticketTexts)&&void 0!==o?o:[]).join("\r\n ")+"\r\n",m+="VCR COUPON DATA EXISTS *VI TO DISPLAY\r\n",m+="PHONES\r\n ",m+=(null!==(a=_.contactTexts)&&void 0!==a?a:[]).join("\r\n ")+"\r\n",m+="PASSENGER EMAIL DATA EXISTS *PE TO DISPLAY ALL\r\n",m+="PRICE QUOTE RECORD EXISTS - *PQS\r\n",m+="FREQUENT TRAVELER\r\n",m+=(null!==(s=_.frequentTexts)&&void 0!==s?s:[]).join("\r\n ")+"\r\n",m+="TICKETED RETAINED REISSUE EXISTS - *PQS\r\n",m+="VN FACTS\r\n ",m+=(null!==(l=_.ssrTexts)&&void 0!==l?l:[]).join("\r\n ")+"\r\n",_.remarkTexts&&(m+="REMARKS\r\n ",m+=(null!==(g=_.remarkTexts)&&void 0!==g?g:[]).join("\r\n ")),m+=(null!==(r=_.agentTexts)&&void 0!==r?r:[]).join("\r\n")):(m+=`${_.bookingCodeText}\r\n`,m+=(null===(h=_.passengerTexts)||void 0===h?void 0:h.join(" "))+"\r\n",m+=(null===(u=_.segmentTexts)||void 0===u?void 0:u.join("\r\n"))+"\r\n",m+=`TOTAL PRICE: ${_.totalPrice} VND\r\n`,m+=`TIME LIMIT: ${_.timeLimit}\r\n`,m+=(null!==(p=_.contactTexts)&&void 0!==p?p:[]).join("\r\n"))),m||""}return""}getExplaneText(t){var n;if(this.listBookingTextExplain){let i="";const o=this.listBookingTextExplain.find(a=>a.airline===t);return o&&(i+=(0,z.K)(o),i+="NOTE:\r\n",i+=null===(n=o.warning)||void 0===n?void 0:n.join("\r\n")),i||""}return""}changeModeBookingText(t){this.modeBookingText=t}onShowBoardingPass(t){if(this._detectMobileService.isMobile()){const n=this._bottomSheetService.open(V.G,{headerTitle:"M\u1eb7t v\xe9",rightButtonIcon:"",leftButtonIcon:"close",leftButtonIconClass:"text-neutral-gray-4",containerFullHeigh:!0,data:{bookingDetail:t,listBaggage:this.listBaggage.filter(i=>i.airline===t.airline),listService:this.listService.filter(i=>i.airline===t.airline),totalPrice:this.totalPrice}});n.containerInstance._leftButtonClick.subscribe(i=>n.dismiss())}else this._modal.open(V.G,{bookingDetail:t,listBaggage:this.listBaggage.filter(n=>n.airline===t.airline),listService:this.listService.filter(n=>n.airline===t.airline),totalPrice:this.totalPrice})}getListTicketAction(t,n){switch(t){case"BOOKED":if("VJ"===n)return[{value:"booking_detail",name:"M\u1edf booking",icon:"external_link",enabled:[d.or.ViewAllFlightBookingDetail,d.or.ViewOwnFlightBookingDetail].some(i=>this._permissionService.hasPermission(i))},{value:"issue",name:"Xu\u1ea5t v\xe9",icon:"grouping",enabled:[d.or.CanIssuedFlightTicket].some(i=>this._permissionService.hasPermission(i))},{value:"boarding_pass",name:"M\u1eb7t v\xe9",icon:"coupon",enabled:[d.or.CreateFlightTicketFace].some(i=>this._permissionService.hasPermission(i))},{value:"addon_baggage",name:"Th\xeam h\xe0nh l\xfd",icon:"",enabled:[d.or.CanAddonFlightBaggage].some(i=>this._permissionService.hasPermission(i))},{value:"addon_seat",name:"Th\xeam ch\u1ed7 ng\u1ed3i",icon:"",enabled:[d.or.CanAddonFlightSeat].some(i=>this._permissionService.hasPermission(i))},{value:"register_order",name:"Canh v\xe9 r\u1ebb",icon:"price_down",enabled:[d.or.CanMonitorLowFareTicket].some(i=>this._permissionService.hasPermission(i))},{value:"add_journey",name:"Th\xeam h\xe0nh tr\xecnh",icon:"",enabled:[d.or.CanAddFlightJourney].some(i=>this._permissionService.hasPermission(i))},{value:"other",name:"Kh\xe1c",icon:"options_vertical",enabled:[d.or.CanAddonFlightBaggage,d.or.CanAddonFlightSeat,d.or.CanUpdateFlightJourney].some(i=>this._permissionService.hasPermission(i)),items:[{value:"rerouting",name:"\u0110\u1ed5i h\xe0nh tr\xecnh",icon:"",enabled:[d.or.CanUpdateFlightJourney].some(i=>this._permissionService.hasPermission(i))},{value:"delete_each_journey",name:"H\u1ee7y h\xe0nh tr\xecnh",icon:"delete",enabled:[d.or.CanDeleteFlightSegment].some(i=>this._permissionService.hasPermission(i))},{value:"separate_passengers",name:"T\xe1ch h\xe0nh kh\xe1ch",icon:"",enabled:[d.or.CanSplitPassengerVJ].some(i=>this._permissionService.hasPermission(i))&&this._systemService.isFeatureEnabled(D.Ke.Web_Features_SplitPassenger_SplitPassengerVJ_Enable)},{value:"update_pax_info",name:"S\u1eeda h\xe0nh kh\xe1ch",icon:"",enabled:[d.or.CanUpdatePaxInfoVJ].some(i=>this._permissionService.hasPermission(i))},{value:"send_email",name:"G\u1eedi email",icon:"email",enabled:[d.or.CanSendEmail].some(i=>this._permissionService.hasPermission(i))},{value:"open_audit_log",name:"Ki\u1ec3m to\xe1n \u0111\u1eb7t ch\u1ed7",icon:"",enabled:[d.or.CanViewAuditLogVJ].some(i=>this._permissionService.hasPermission(i))}]}];if("VN"===n)return[{value:"booking_detail",name:"M\u1edf booking",icon:"external_link",enabled:[d.or.ViewAllFlightBookingDetail,d.or.ViewOwnFlightBookingDetail].some(i=>this._permissionService.hasPermission(i))},{value:"issue",name:"Xu\u1ea5t v\xe9",icon:"grouping",enabled:[d.or.CanIssuedFlightTicket].some(i=>this._permissionService.hasPermission(i))},{value:"boarding_pass",name:"M\u1eb7t v\xe9",icon:"coupon",enabled:[d.or.CreateFlightTicketFace].some(i=>this._permissionService.hasPermission(i))},{value:"delete_segments",name:"H\u1ee7y h\xe0nh tr\xecnh",icon:"delete",enabled:[d.or.CanDeleteFlightSegment].some(i=>this._permissionService.hasPermission(i))},{value:"separate_passengers",name:"T\xe1ch h\xe0nh kh\xe1ch",icon:"",enabled:[d.or.CanSplitPassengerVN].some(i=>this._permissionService.hasPermission(i))},{value:"register_order",name:"Canh v\xe9 r\u1ebb",icon:"price_down",enabled:[d.or.CanMonitorLowFareTicket].some(i=>this._permissionService.hasPermission(i))},{value:"send_email",name:"G\u1eedi email",icon:"email",enabled:[d.or.CanSendEmail].some(i=>this._permissionService.hasPermission(i))}];if("GDS"===n)return[{value:"booking_detail",name:"M\u1edf booking",icon:"external_link",enabled:[d.or.ViewAllFlightBookingDetail,d.or.ViewOwnFlightBookingDetail].some(i=>this._permissionService.hasPermission(i))},{value:"boarding_pass",name:"M\u1eb7t v\xe9",icon:"coupon",enabled:[d.or.CreateFlightTicketFace].some(i=>this._permissionService.hasPermission(i))}];if("QH"===n)return[{value:"booking_detail",name:"M\u1edf booking",icon:"external_link",enabled:[d.or.ViewAllFlightBookingDetail,d.or.ViewOwnFlightBookingDetail].some(i=>this._permissionService.hasPermission(i))},{value:"issue",name:"Xu\u1ea5t v\xe9",icon:"grouping",enabled:[d.or.CanIssuedFlightTicket].some(i=>this._permissionService.hasPermission(i))},{value:"boarding_pass",name:"M\u1eb7t v\xe9",icon:"coupon",enabled:[d.or.CreateFlightTicketFace].some(i=>this._permissionService.hasPermission(i))},{value:"register_order",name:"Canh v\xe9 r\u1ebb",icon:"price_down",enabled:[d.or.CanMonitorLowFareTicket].some(i=>this._permissionService.hasPermission(i))},{value:"send_email",name:"G\u1eedi email",icon:"email",enabled:[d.or.CanSendEmail].some(i=>this._permissionService.hasPermission(i))}];{const i=[{value:"booking_detail",name:"M\u1edf booking",icon:"external_link",enabled:[d.or.ViewAllFlightBookingDetail,d.or.ViewOwnFlightBookingDetail].some(o=>this._permissionService.hasPermission(o))},{value:"boarding_pass",name:"M\u1eb7t v\xe9",icon:"coupon",enabled:[d.or.CreateFlightTicketFace].some(o=>this._permissionService.hasPermission(o))}];return[d.or.CanIssuedFlightTicket].some(o=>this._permissionService.hasPermission(o))&&("BSP"===(null==n?void 0:n.toUpperCase())&&this._permissionService.hasPermission(d.or.CanIssuedFlightTicketBSP)&&i.push({value:"issue",name:"Xu\u1ea5t v\xe9",icon:"grouping",enabled:!0}),"AIR_1G"===(null==n?void 0:n.toUpperCase())&&this._permissionService.hasPermission(d.or.CanIssuedFlightTicket1G)&&i.push({value:"issue",name:"Xu\u1ea5t v\xe9",icon:"grouping",enabled:!0})),i}case"ISSUED":if("VN"===n)return[{value:"booking_detail",name:"M\u1edf booking",icon:"external_link",enabled:[d.or.ViewAllFlightBookingDetail,d.or.ViewOwnFlightBookingDetail].some(i=>this._permissionService.hasPermission(i))},{value:"boarding_pass",name:"M\u1eb7t v\xe9",icon:"coupon",enabled:[d.or.CreateFlightTicketFace].some(i=>this._permissionService.hasPermission(i))},{value:"addon_baggage",name:"Th\xeam h\xe0nh l\xfd",icon:"",enabled:[d.or.CanAddonFlightBaggage].some(i=>this._permissionService.hasPermission(i))},{value:"send_email",name:"G\u1eedi email",icon:"email",enabled:[d.or.CanSendEmail].some(i=>this._permissionService.hasPermission(i))},{value:"void",name:"Void v\xe9",icon:"coupon_slash",enabled:[d.or.CanVoidFlightTicket].some(i=>this._permissionService.hasPermission(i))},{value:"register_order",name:"Canh v\xe9 r\u1ebb",icon:"price_down",enabled:[d.or.CanMonitorLowFareTicket].some(i=>this._permissionService.hasPermission(i))},{value:"delete_segments",name:"H\u1ee7y h\xe0nh tr\xecnh",icon:"delete",enabled:[d.or.CanDeleteFlightSegment].some(i=>this._permissionService.hasPermission(i))},{value:"separate_passengers",name:"T\xe1ch h\xe0nh kh\xe1ch",icon:"",enabled:[d.or.CanSplitPassengerVN].some(i=>this._permissionService.hasPermission(i))},{value:"check_in_online",name:"Check in",icon:"",enabled:!0}];if("GDS"===n)return[{value:"booking_detail",name:"M\u1edf booking",icon:"external_link",enabled:[d.or.ViewAllFlightBookingDetail,d.or.ViewOwnFlightBookingDetail].some(i=>this._permissionService.hasPermission(i))},{value:"boarding_pass",name:"M\u1eb7t v\xe9",icon:"coupon",enabled:[d.or.CreateFlightTicketFace].some(i=>this._permissionService.hasPermission(i))}];if("QH"===n){const i=[{value:"booking_detail",name:"M\u1edf booking",icon:"external_link",enabled:[d.or.ViewAllFlightBookingDetail,d.or.ViewOwnFlightBookingDetail].some(o=>this._permissionService.hasPermission(o))},{value:"boarding_pass",name:"M\u1eb7t v\xe9",icon:"coupon",enabled:[d.or.CreateFlightTicketFace].some(o=>this._permissionService.hasPermission(o))},{value:"addon_baggage",name:"Th\xeam h\xe0nh l\xfd",icon:"",enabled:[d.or.CanAddonFlightBaggage].some(o=>this._permissionService.hasPermission(o))},{value:"send_email",name:"G\u1eedi email",icon:"email",enabled:[d.or.CanSendEmail].some(o=>this._permissionService.hasPermission(o))},{value:"check_in_online",name:"Check in",icon:"",enabled:!0}];return D.kp.qh&&i.push({value:"addon_seat",name:"Th\xeam ch\u1ed7 ng\u1ed3i",icon:"",enabled:[d.or.CanAddonFlightSeat].some(o=>this._permissionService.hasPermission(o))}),i}return"VJ"===n?[{value:"booking_detail",name:"M\u1edf booking",icon:"external_link",enabled:[d.or.ViewAllFlightBookingDetail,d.or.ViewOwnFlightBookingDetail].some(i=>this._permissionService.hasPermission(i))},{value:"boarding_pass",name:"M\u1eb7t v\xe9",icon:"coupon",enabled:[d.or.CreateFlightTicketFace].some(i=>this._permissionService.hasPermission(i))},{value:"addon_baggage",name:"Th\xeam h\xe0nh l\xfd",icon:"",enabled:[d.or.CanAddonFlightBaggage].some(i=>this._permissionService.hasPermission(i))},{value:"addon_seat",name:"Th\xeam ch\u1ed7 ng\u1ed3i",icon:"",enabled:[d.or.CanAddonFlightSeat].some(i=>this._permissionService.hasPermission(i))},{value:"add_journey",name:"Th\xeam h\xe0nh tr\xecnh",icon:"",enabled:[d.or.CanAddFlightJourney].some(i=>this._permissionService.hasPermission(i))},{value:"rerouting",name:"\u0110\u1ed5i h\xe0nh tr\xecnh",icon:"",enabled:[d.or.CanUpdateFlightJourney].some(i=>this._permissionService.hasPermission(i))},{value:"delete_each_journey",name:"H\u1ee7y h\xe0nh tr\xecnh",icon:"delete",enabled:[d.or.CanDeleteFlightSegment].some(i=>this._permissionService.hasPermission(i))},{value:"separate_passengers",name:"T\xe1ch h\xe0nh kh\xe1ch",icon:"",enabled:[d.or.CanSplitPassengerVJ].some(i=>this._permissionService.hasPermission(i))&&this._systemService.isFeatureEnabled(D.Ke.Web_Features_SplitPassenger_SplitPassengerVJ_Enable)},{value:"update_pax_info",name:"S\u1eeda h\xe0nh kh\xe1ch",icon:"",enabled:[d.or.CanUpdatePaxInfoVJ].some(i=>this._permissionService.hasPermission(i))},{value:"send_email",name:"G\u1eedi email",icon:"email",enabled:[d.or.CanSendEmail].some(i=>this._permissionService.hasPermission(i))},{value:"open_audit_log",name:"Ki\u1ec3m to\xe1n \u0111\u1eb7t ch\u1ed7",icon:"",enabled:[d.or.CanViewAuditLogVJ].some(i=>this._permissionService.hasPermission(i))},{value:"check_in_online",name:"Check in",icon:"",enabled:!0}]:[{value:"booking_detail",name:"M\u1edf booking",icon:"external_link",enabled:[d.or.ViewAllFlightBookingDetail,d.or.ViewOwnFlightBookingDetail].some(i=>this._permissionService.hasPermission(i))},{value:"boarding_pass",name:"M\u1eb7t v\xe9",icon:"coupon",enabled:[d.or.CreateFlightTicketFace].some(i=>this._permissionService.hasPermission(i))},{value:"check_in_online",name:"Check in",icon:"",enabled:!0}];case"VOID":return"VJ"===n?[{value:"booking_detail",name:"M\u1edf booking",icon:"external_link",enabled:[d.or.ViewAllFlightBookingDetail,d.or.ViewOwnFlightBookingDetail].some(i=>this._permissionService.hasPermission(i))},{value:"issue",name:"Xu\u1ea5t v\xe9",icon:"grouping",enabled:[d.or.CanIssuedFlightTicket].some(i=>this._permissionService.hasPermission(i))},{value:"boarding_pass",name:"M\u1eb7t v\xe9",icon:"coupon",enabled:[d.or.CreateFlightTicketFace].some(i=>this._permissionService.hasPermission(i))},{value:"other",name:"Kh\xe1c",icon:"options_vertical",enabled:[d.or.CanAddonFlightBaggage,d.or.CanAddonFlightSeat].some(i=>this._permissionService.hasPermission(i)),items:[{value:"addon_baggage",name:"Th\xeam h\xe0nh l\xfd",icon:"",enabled:[d.or.CanAddonFlightBaggage].some(i=>this._permissionService.hasPermission(i))},{value:"addon_seat",name:"Th\xeam ch\u1ed7 ng\u1ed3i",icon:"",enabled:[d.or.CanAddonFlightSeat].some(i=>this._permissionService.hasPermission(i))},{value:"open_audit_log",name:"Ki\u1ec3m to\xe1n \u0111\u1eb7t ch\u1ed7",icon:"",enabled:[d.or.CanViewAuditLogVJ].some(i=>this._permissionService.hasPermission(i))}]}]:"GDS"===n?[{value:"booking_detail",name:"M\u1edf booking",icon:"external_link",enabled:[d.or.ViewAllFlightBookingDetail,d.or.ViewOwnFlightBookingDetail].some(i=>this._permissionService.hasPermission(i))},{value:"boarding_pass",name:"M\u1eb7t v\xe9",icon:"coupon",enabled:[d.or.CreateFlightTicketFace].some(i=>this._permissionService.hasPermission(i))}]:[{value:"booking_detail",name:"M\u1edf booking",icon:"external_link",enabled:[d.or.ViewAllFlightBookingDetail,d.or.ViewOwnFlightBookingDetail].some(i=>this._permissionService.hasPermission(i))},{value:"issue",name:"Xu\u1ea5t v\xe9",icon:"grouping",enabled:[d.or.CanIssuedFlightTicket].some(i=>this._permissionService.hasPermission(i))},{value:"boarding_pass",name:"M\u1eb7t v\xe9",icon:"coupon",enabled:[d.or.CreateFlightTicketFace].some(i=>this._permissionService.hasPermission(i))}];default:return[]}}onRetryBooking(t){const n=this.bookingRequest.data.bookingFlights.bookingOptions.filter(o=>t.includes(o.journeyKey)),i=Object.assign(Object.assign({},this.bookingRequest),{data:Object.assign(Object.assign({},this.bookingRequest.data),{bookingFlights:{mode:this.bookingRequest.data.bookingFlights.mode,bookingOptions:n.map((o,a)=>Object.assign(Object.assign({},o),{leg:a}))},bookingPassengers:this.bookingRequest.data.bookingPassengers.map(o=>Object.assign(Object.assign({},o),{bookingBaggages:o.bookingBaggages.filter(a=>t.includes(a.journeyKey)),bookingSeats:o.bookingSeats.filter(a=>t.includes(a.journeyKey))}))})});this.isLoading=!0,this._bookFlightService.bookFlight(i).pipe((0,A.x)(()=>this.isLoading=!1)).subscribe({next:o=>{}})}getShortRetrieve(t,n){this._searchFlightService.getShortRetrieve({airline:t,bookingCode:n}).subscribe({next:o=>{if(o.success){const a=this.bookFlightResult.data.find(l=>l.bookingResult.bookingCode===n),s=this.bookingDetails.find(l=>l.bookingCode===n);s&&(s.bookingTextExplain=o.data.bookingTextExplain),a&&(a.bookingResult.bookingText=o.data.bookingText,a.bookingResult.bookingTextExplain=o.data.bookingTextExplain,this._bookingResultDataProvider.bookingResultData=this.bookFlightResult,this.bookFlightResult=(0,Z.yE)(P.aM,this._bookingResultDataProvider.bookingResultData,{excludeExtraneousValues:!0}),this.getBooingText())}}})}togglePriceBottomSheet(t){this.isShowTotalPriceBts=!this.isShowTotalPriceBts,this.isShowTotalPriceBts?(this.showTotalPriceBts=this._bottomSheetService.open(t,{headerTitle:"Gi\xe1 v\xe9",rightButtonIcon:"close",rightButtonIconClass:"text-neutral-gray-4"}),this.zIndexPriceIncrease=!0,this.showTotalPriceBts.afterDismissed().subscribe(n=>{this.isShowTotalPriceBts=!1,this.zIndexPriceIncrease=!1}),this.showTotalPriceBts.containerInstance._rightButtonClick.subscribe(n=>{this.showTotalPriceBts.dismiss(),this.zIndexPriceIncrease=!1})):this.showTotalPriceBts&&this.showTotalPriceBts.dismiss()}mobileDetailClick(t){const n=this._bottomSheetService.open(C.iU,{headerTitle:"Chi ti\u1ebft \u0111\u1eb7t ch\u1ed7",rightButtonIcon:"",leftButtonIcon:"close",leftButtonIconClass:"text-neutral-gray-4",containerFullHeigh:!0,data:{flightInfos:[this.getFlightInfoDetail(t)]}});n.containerInstance._leftButtonClick.subscribe(i=>{n.dismiss()})}mobileTabChange(t,n){this.mobileTabMode=t,n.scrollIntoView({behavior:"smooth",inline:"center"})}getFlightInfoDetail(t){var n,i,o,a,s,l;return{segments:t.journeys.flatMap((r,h)=>r.segments.map((u,p)=>({airline:u.airline,airlineSystem:u.airline,airlineName:u.airlineName,airlineLogo:u.airlineLogo,mobileAirlineLogo:["VJ","VN","QH"].includes(u.airline)?"assets/airline-logo/"+u.airline+"_small.png":"assets/airline-logo/"+u.airline+".png",flightNumber:u.airline+u.flightNumber,startTime:T(u.startTime).format("HH:mm"),startDate:T(u.startTime).format("DD/MM/YYYY"),startPoint:u.startPoint,startPointName:u.startPointName,startAirport:this._locationDataService.getAirportNameByCode(u.startPoint),endTime:T(u.endTime).format("HH:mm"),endDate:T(u.endTime).format("DD/MM/YYYY"),endPoint:u.endPoint,endPointName:u.endPointName,endAirport:this._locationDataService.getAirportNameByCode(u.endPoint),stopPoint:u.stopPoint,modelAirplane:u.modelAirplane,badge:0===h?"Chi\u1ec1u \u0111i":"Chi\u1ec1u v\u1ec1",rules:[{name:"Th\u1eddi gian bay",value:u.duration},{name:"Lo\u1ea1i m\xe1y bay",value:u.modelAirplane},{name:"H\u1ea1ng ch\u1ed7",value:u.fareClass},{name:"H\xe0nh l\xfd k\xfd g\u1eedi",value:u.checkedBaggage||"N/A"},{name:"H\xe0nh l\xfd x\xe1ch tay",value:u.handBaggage||"N/A"}]}))),statusDesc:t.statusDesc,timeHoldBooking:t.timeHoldBooking,timeHoldPricing:t.timeHoldPricing,airlineSystem:t.airlineSystem,airlineName:t.airlineName,totalFare:t.totalFare,passengers:t.passengers.map(r=>({name:r.name,type:r.type,farePrice:r.farePrice,tax:r.tax,vat:r.vat,total:r.total})),status:t.status,journeyStatus:{active:null!==(i=null===(n=t.journeys[0].journeyStatus)||void 0===n?void 0:n.active)&&void 0!==i&&i,cancelled:null!==(a=null===(o=t.journeys[0].journeyStatus)||void 0===o?void 0:o.cancelled)&&void 0!==a&&a,disrupted:null!==(l=null===(s=t.journeys[0].journeyStatus)||void 0===s?void 0:s.disrupted)&&void 0!==l&&l}}}onDeleteSegment(t){const n=t.journeys.flatMap(o=>o.segments).map((o,a)=>({order:a+1,segmentKey:o.key,journey:`${o.startPointName} (${o.startPoint}) - ${o.endPointName} (${o.endPoint})`,startTime:T(o.startTime).format("HH:mm DD/MM/YYYY"),flightNumber:`${o.airline}${o.flightNumber}`,status:""})),i={airline:t.airline,bookingCode:t.bookingCode};if(this._detectMobileService.isMobile()){const o=this._bottomSheetService.open(C.df,{headerTitle:"H\u1ee7y h\xe0nh tr\xecnh",rightButtonIcon:"",leftButtonIcon:"close",leftButtonIconClass:"text-neutral-gray-4",containerFullHeigh:!0,data:{listSegmentData:n,bookingInfo:i}});o.containerInstance._leftButtonClick.subscribe(a=>o.dismiss()),o.afterDismissed().subscribe(a=>{a&&(t.status="CANCEL",t.statusText="\u0110\xe3 h\u1ee7y",t.actions=this.getListTicketAction("CANCEL",t.provider))})}else this._modal.open(C.df,{listSegmentData:n,bookingInfo:i}).afterClosed$.subscribe({next:a=>{a.data&&(t.status="CANCEL",t.statusText="\u0110\xe3 h\u1ee7y",t.actions=this.getListTicketAction("CANCEL",t.provider))}})}onDeleteEachJourney(t){this.isLoading=!0,this._manageBookingService.validateBeforeModifyJourney(t.bookingCode,"CANCEL_JOURNEY").subscribe({next:n=>{this.isLoading=!1,n.status&&(1==n.data.canModify?(this.journeyForDeletes=t.journeys.map((i,o)=>({index:o,pnr:t.bookingCode,journeyKey:i.key,airlineLogoUrl:`assets/airline-logo/${i.airline}_short_logo.png`,airlineCode:i.airline,airlineName:i.airlineName,startPointCode:i.startPoint,endPointCode:i.endPoint,startPointName:i.startPointName,endPointName:i.endPointName,startDate:i.startTime,journeyType:i.segments.length>1?i.segments.length-1+" ch\u1eb7ng d\u1eebng":"Bay th\u1eb3ng",status:t.status,isSelected:0==o})),this.openSelectJourneyForCancel()):"DOWN_FARE"==n.data.type&&this._modal.open(b.V0,{title:"V\xe9 \u0111ang \u0111\u01b0\u1ee3c canh",body:"Kh\xf4ng th\u1ec3 h\u1ee7y h\xe0nh tr\xecnh khi \u0111ang canh v\xe9 r\u1ebb. Vui l\xf2ng h\u1ee7y canh v\xe9 h\xe0nh tr\xecnh n\xe0y tr\u01b0\u1edbc khi ti\u1ebfp t\u1ee5c",okText:"M\u1edf canh v\xe9",cancelText:"\u0110\xf3ng",hasIcon:!0}).afterClosed$.subscribe({next:o=>{o.data&&this.gotoDownFareDetail(n.data.orderId)}}))},error:n=>{this.isLoading=!1,console.log(n)}})}openSelectJourneyForCancel(){if(this._detectMobileService.isMobile()){const t=this._bottomSheetService.open(C.Xg,{headerTitle:"Ch\u1ecdn h\xe0nh tr\xecnh c\u1ea7n h\u1ee7y",rightButtonIcon:"",leftButtonIcon:"close",leftButtonIconClass:"text-neutral-gray-4",containerFullHeigh:!0,data:{journeys:this.journeyForDeletes}});t.containerInstance._leftButtonClick.subscribe(n=>t.dismiss()),t.afterDismissed().subscribe(n=>{n&&this.onDeleteJourneyConfirm(n.journey,n.quotation)})}else this._modal.open(C.Xg,{journeys:this.journeyForDeletes}).afterClosed$.subscribe({next:n=>{n.data&&this.onDeleteJourneyConfirm(n.data.journey,n.data.quotation)}})}onDeleteJourneyConfirm(t,n){let i={airline:t.airlineCode,journeyKey:t.journeyKey,pnr:t.pnr,startPointCode:t.startPointCode,endPointCode:t.endPointCode,startDate:t.startDate,journeyType:t.journeyType,status:t.status,currentJourneyPrice:n.data.cancelJourney.charge.total,paid:"BOOKED"==t.status?0:"ISSUED"==t.status?n.data.cancelJourney.charge.total:0,cancelFee:n.data.cancelCharge.total,totalFee:"BOOKED"==t.status?n.data.totalCharge.total:void 0,noGiveBack:"ISSUED"==t.status?n.data.nonRefund.total:void 0,reservePrice:"ISSUED"==t.status?n.data.refund.total:void 0,totalCharge:n.data.totalCharge.total};if(this._detectMobileService.isMobile()){const o=this._bottomSheetService.open(C.mO,{headerTitle:"X\xe1c nh\u1eadn chi ph\xed",rightButtonIcon:"",leftButtonIcon:"close",leftButtonIconClass:"text-neutral-gray-4",containerFullHeigh:!0,data:{journeyConfirm:i}});o.containerInstance._leftButtonClick.subscribe(a=>o.dismiss()),o.afterDismissed().subscribe(a=>{a&&a&&("OK"==a.type&&(this._toastService.add({severity:"success",summary:"H\u1ee7y h\xe0nh tr\xecnh th\xe0nh c\xf4ng",detail:"H\xe0nh tr\xecnh \u0111\xe3 \u0111\u01b0\u1ee3c h\u1ee7y th\xe0nh c\xf4ng!",sticky:!1}),this.gotoBookingDetail(t.airlineCode,t.pnr)),"FAILED"==a.type&&"BE-EA019"==a.data&&this._modal.open(b.V0,{title:"Qu\xe1 th\u1eddi h\u1ea1n h\u1ee7y h\xe0nh tr\xecnh",body:"B\u1ea1n ch\u1ec9 c\xf3 th\u1ec3 th\u1ef1c hi\u1ec7n H\u1ee7y h\xe0nh tr\xecnh tr\u01b0\u1edbc gi\u1edd bay 24 ti\u1ebfng",okText:"\u0110\xf3ng",hasIcon:!0,hasCancel:!1}),"BACK"==a.type&&this.openSelectJourneyForCancel())})}else this._modal.open(C.mO,{journeyConfirm:i}).afterClosed$.subscribe({next:a=>{a.data&&"OK"==a.data.type&&(this._toastService.add({severity:"success",summary:"H\u1ee7y h\xe0nh tr\xecnh th\xe0nh c\xf4ng",detail:"H\xe0nh tr\xecnh \u0111\xe3 \u0111\u01b0\u1ee3c h\u1ee7y th\xe0nh c\xf4ng!",sticky:!1}),this.gotoBookingDetail(t.airlineCode,t.pnr)),"FAILED"==a.data.type&&"BE-EA019"==a.data.data&&this._modal.open(b.V0,{title:"Qu\xe1 th\u1eddi h\u1ea1n h\u1ee7y h\xe0nh tr\xecnh",body:"B\u1ea1n ch\u1ec9 c\xf3 th\u1ec3 th\u1ef1c hi\u1ec7n H\u1ee7y h\xe0nh tr\xecnh tr\u01b0\u1edbc gi\u1edd bay 24 ti\u1ebfng",okText:"\u0110\xf3ng",hasIcon:!0,hasCancel:!1}),"BACK"==a.data.type&&this.openSelectJourneyForCancel()}})}onShowIdentityReservation(){let t={pnr:"ABCDEF",expirationDate:new Date,passengers:[{name:"Nguyen Thanh Duong",type:"ADT",price:1e6},{name:"Nguyen Thanh Duong 2",type:"ADT",price:2e6}]};if(this._detectMobileService.isMobile()){this.zIndexPriceIncrease=!1;const n=this._bottomSheetService.open(C.$u,{headerTitle:"B\u1ea3o l\u01b0u \u0111\u1ecbnh danh h\xe0nh kh\xe1ch",rightButtonIcon:"",leftButtonIcon:"close",leftButtonIconClass:"text-neutral-gray-4",containerFullHeigh:!0,data:{info:t}});n.containerInstance._leftButtonClick.subscribe(i=>{this.zIndexPriceIncrease=!0,n.dismiss()}),n.afterDismissed().subscribe(i=>this.zIndexPriceIncrease=!0)}else this._modal.open(C.$u,{info:t})}onRegisterOrder(t){const n={airline:t.airline,pnr:t.bookingCode};this.isLoading=!0,this._ticketLowFareService.canMonitorLowFare(n).pipe((0,A.x)(()=>this.isLoading=!1)).subscribe({next:i=>{var o,a,s,l;if("OK"===i.status&&null!==(o=i.data.canMonitor)&&void 0!==o&&o.enable)if(this._detectMobileService.isMobile()){const g=this._bottomSheetService.open(F.g,{headerTitle:"T\u1ea1o y\xeau c\u1ea7u canh v\xe9 r\u1ebb",rightButtonIcon:"close",rightButtonIconClass:"text-neutral-gray-4",leftButtonIcon:"",containerFullHeigh:!0,data:{bookingDetail:t,sourceEvent:"BOOKING_SUCCESS"}});g.containerInstance._rightButtonClick.subscribe(r=>g.dismiss())}else{const g=this._modal.open(F.g,{bookingDetail:t,sourceEvent:"BOOKING_SUCCESS"});g.afterClosed$.subscribe({next:r=>{r.data||g.close(!1)}})}else if("OK"!==i.status||null!==(a=i.data.canMonitor)&&void 0!==a&&a.enable){const g=null===(l=null===(s=i.objectError)||void 0===s?void 0:s.errorDescription)||void 0===l?void 0:l.vi;this._modal.open(O.V,{title:"M\xe3 \u0111\u1eb7t ch\u1ed7 kh\xf4ng h\u1ee3p l\u1ec7",content:g,status:"error",cancelText:"\u0110\xf3ng",okText:"Canh v\xe9 kh\xe1c",secondaryAction:!0}).afterClosed$.subscribe({next:h=>{h.data&&this.onRegisterNewPnrOrder()}})}else{let g="Xem danh s\xe1ch";g="TPS-TLF006"===i.data.canMonitor.reason.errorCode?"Qu\u1ea3n l\xfd canh v\xe9":"Canh v\xe9 kh\xe1c";const r=i.data.canMonitor.reason.desc;if(this._detectMobileService.isMobile()){const h=this._bottomSheetService.open(b.Q4,{headerTitle:"",rightButtonIcon:"close",rightButtonIconClass:"text-neutral-gray-4",data:{title:"M\xe3 \u0111\u1eb7t ch\u1ed7 kh\xf4ng h\u1ee3p l\u1ec7",body:r,okText:g,cancelText:"\u0110\xf3ng",hasIcon:!0,status:"error"}});h.containerInstance._rightButtonClick.subscribe(()=>{h.dismiss()}),h.afterDismissed().subscribe(u=>{u&&this.onRegisterNewPnrOrder()})}else this._modal.open(O.V,{title:"M\xe3 \u0111\u1eb7t ch\u1ed7 kh\xf4ng h\u1ee3p l\u1ec7",content:r,status:"error",cancelText:"\u0110\xf3ng",okText:g,secondaryAction:!0}).afterClosed$.subscribe({next:u=>{u.data&&("TPS-TLF006"===i.data.canMonitor.reason.errorCode?this._route.navigate(["admin/manage-pnr-orders"]):this.onRegisterNewPnrOrder())}})}},error:()=>{const i="Canh v\xe9 kh\xe1c";if(this._detectMobileService.isMobile()){const o=this._bottomSheetService.open(b.Q4,{headerTitle:"",rightButtonIcon:"close",rightButtonIconClass:"text-neutral-gray-4",data:{title:"M\xe3 \u0111\u1eb7t ch\u1ed7 kh\xf4ng h\u1ee3p l\u1ec7",body:`M\xe3 \u0111\u1eb7t ch\u1ed7 <strong>${t.bookingCode}</strong> kh\xf4ng h\u1ee3p l\u1ec7 \u0111\u1ec3 t\u1ea1o y\xeau c\u1ea7u canh v\xe9. Vui l\xf2ng canh v\xe9 v\u1edbi m\xe3 \u0111\u1eb7t ch\u1ed7 kh\xe1c.`,okText:i,cancelText:"\u0110\xf3ng",hasIcon:!0,status:"error"}});o.containerInstance._rightButtonClick.subscribe(()=>{o.dismiss()}),o.afterDismissed().subscribe(a=>{a&&this.onRegisterNewPnrOrder()})}else this._modal.open(O.V,{title:"M\xe3 \u0111\u1eb7t ch\u1ed7 kh\xf4ng h\u1ee3p l\u1ec7",content:`M\xe3 \u0111\u1eb7t ch\u1ed7 <strong>${t.bookingCode}</strong> kh\xf4ng h\u1ee3p l\u1ec7 \u0111\u1ec3 t\u1ea1o y\xeau c\u1ea7u canh v\xe9. Vui l\xf2ng canh v\xe9 v\u1edbi m\xe3 \u0111\u1eb7t ch\u1ed7 kh\xe1c.`,status:"error",cancelText:"\u0110\xf3ng",okText:i,secondaryAction:!0}).afterClosed$.subscribe({next:a=>{a.data&&this.onRegisterNewPnrOrder()}})}})}onRegisterNewPnrOrder(){if(this._eventLogService.captureOpenFormDownFare({hasPNR:0,source:0}),this._detectMobileService.isMobile()){const t=this._bottomSheetService.open(F.g,{headerTitle:"T\u1ea1o y\xeau c\u1ea7u canh v\xe9 r\u1ebb",rightButtonIcon:"close",rightButtonIconClass:"text-neutral-gray-4",leftButtonIcon:"",containerFullHeigh:!0,data:{isSuggest:!0,sourceEvent:"SUGGEST"}});t.containerInstance._rightButtonClick.subscribe(n=>t.dismiss())}else this._modal.open(F.g,{isSuggest:!0,sourceEvent:"SUGGEST"})}onSendEmail(t){if(this._detectMobileService.isMobile()){const n=this._bottomSheetService.open(j.B,{headerTitle:"Th\xf4ng tin m\u1eb7t v\xe9",leftButtonIcon:"close",leftButtonIconClass:"text-neutral-gray-4",rightButtonIcon:"",containerFullHeigh:!1,data:{emailInfo:{bookingCode:t.bookingCode,airline:t.airline,email:this.bookingContact.email}}});n.containerInstance._leftButtonClick.subscribe(i=>n.dismiss())}else this._modal.open(j.B,{emailInfo:{bookingCode:t.bookingCode,airline:t.airline,email:this.bookingContact.email}})}hanldeTimeoutIssue(){this._detectMobileService.isMobile()?(this.refTimoutBts=this._bottomSheetService.open(b.NK,{headerTitle:"",leftButtonIcon:"",rightButtonIcon:"close",rightButtonIconClass:"text-neutral-gray-4",containerFullHeigh:!1,data:{title:"\u0110ang x\u1eed l\xfd xu\u1ea5t v\xe9",body:"Qu\xfd \u0111\u1ea1i l\xfd vui l\xf2ng \u0111\u1ee3i trong gi\xe2y l\xe1t ho\u1eb7c ch\u1ee7 \u0111\u1ed9ng theo d\xf5i tr\u1ea1ng th\xe1i v\xe9 \u1edf m\u1ee5c Qu\u1ea3n l\xfd \u0111\u1eb7t ch\u1ed7",cancelText:"\u0110\xf3ng",okText:"M\u1edf qu\u1ea3n l\xfd \u0111\u1eb7t ch\u1ed7"}}),this.refTimoutBts.containerInstance._leftButtonClick.subscribe(t=>this.refTimoutBts.dismiss()),this.refTimoutBts.afterDismissed().subscribe({next:t=>{t&&this._route.navigate(["admin/manage-booking"])}})):(this.refTimoutModal=this._modal.open(b.NK,{title:"\u0110ang x\u1eed l\xfd xu\u1ea5t v\xe9",body:"Qu\xfd \u0111\u1ea1i l\xfd vui l\xf2ng \u0111\u1ee3i trong gi\xe2y l\xe1t ho\u1eb7c ch\u1ee7 \u0111\u1ed9ng theo d\xf5i tr\u1ea1ng th\xe1i v\xe9 \u1edf m\u1ee5c Qu\u1ea3n l\xfd \u0111\u1eb7t ch\u1ed7",cancelText:"\u0110\xf3ng",okText:"M\u1edf qu\u1ea3n l\xfd \u0111\u1eb7t ch\u1ed7"}),this.refTimoutModal.afterClosed$.subscribe({next:t=>{t.data&&this._route.navigate(["admin/manage-booking"])}}))}onRerouting(t){var n;const i=a=>{switch(a){case"ADULT":default:return"ADT";case"CHILD":return"CHD";case"INFANT":return"INF"}},o={airline:t.airline,airlineName:t.airlineName,status:t.status,bookingCode:t.bookingCode,journeys:(null===(n=t.journeys)||void 0===n?void 0:n.map((a,s)=>{var l;return{journeyKey:a.key||"",airline:a.airline||"N/A",airlineName:a.airlineName||"N/A",airlineLogo:a.airlineLogo||"",startPointCode:a.startPoint||"N/A",startPointName:a.startPointName||"N/A",endPointCode:a.endPoint||"N/A",endPointName:a.endPointName||"N/A",startTime:null!==(l=a.startTime)&&void 0!==l?l:new Date,redirectType:a.segments.length>1?"N\u1ed1i chuy\u1ebfn":"Bay th\u1eb3ng",statusText:t.statusText,selected:0===s}}))||[],passengers:this.passengers.map(a=>({name:a.name,type:a.type,typeDisplay:i(a.type),baseFare:0,taxFee:0,totalPrice:0}))};this._requestReroutingService.setBookingDetailReroutingData(o),this._route.navigate(["admin/rerouting"])}onAddonJourney(t){var n;const i=a=>{switch(a){case"ADULT":default:return"ADT";case"CHILD":return"CHD";case"INFANT":return"INF"}},o={airline:t.airline,airlineName:t.airlineName,status:t.status,bookingCode:t.bookingCode,journeys:(null===(n=t.journeys)||void 0===n?void 0:n.map((a,s)=>{var l;return{journeyKey:a.key||"",airline:a.airline||"N/A",airlineName:a.airlineName||"N/A",airlineLogo:a.airlineLogo||"",startPointCode:a.startPoint||"N/A",startPointName:a.startPointName||"N/A",endPointCode:a.endPoint||"N/A",endPointName:a.endPointName||"N/A",startTime:null!==(l=a.startTime)&&void 0!==l?l:new Date,redirectType:a.segments.length>1?"N\u1ed1i chuy\u1ebfn":"Bay th\u1eb3ng",statusText:t.statusText,selected:0===s}}))||[],passengers:this.passengers.map(a=>({name:a.name,type:a.type,typeDisplay:i(a.type),baseFare:0,taxFee:0,totalPrice:0}))};this._requestReroutingService.setBookingDetailReroutingData(o),this._route.navigate(["admin/add-journey"])}onSeparatePassengers(t){const n=[];if(t.passengers.filter(i=>"INF"!==i.type).forEach(i=>{n.push({index:i.index,key:i.key||"",name:i.name,parentKey:i.parentKey||"",type:i.type,child:"N/A",selected:!1})}),t.passengers.filter(i=>"INF"===i.type).forEach(i=>{const o=n.find(a=>a.key===i.parentKey);o&&(o.child=i.name)}),n.length>=2)if(this._detectMobileService.isMobile()){const i=this._bottomSheetService.open(C.zb,{headerTitle:"Ch\u1ecdn h\xe0nh kh\xe1ch c\u1ea7n t\xe1ch",rightButtonIcon:"",leftButtonIcon:"close",leftButtonIconClass:"text-neutral-gray-4",containerFullHeigh:!0,data:{listPassengers:n,bookingDetail:t}});i.containerInstance._leftButtonClick.subscribe(()=>{i.dismiss()}),i.afterDismissed().subscribe({next:o=>{o&&this._route.navigate([`admin/booking-detail/${t.airline}/${o}`])}})}else this._modal.open(C.zb,{listPassengers:n,bookingDetail:t}).afterClosed$.subscribe({next:o=>{o.data&&this._route.navigate([`admin/booking-detail/${t.airline}/${o.data}`])}});else if(this._detectMobileService.isMobile()){const i=this._bottomSheetService.open(b.Q4,{headerTitle:"Kh\xf4ng th\u1ec3 ti\u1ebfp t\u1ee5c",rightButtonIcon:"close",rightButtonIconClass:"text-neutral-gray-4",data:{title:"",body:"V\xe9 ph\u1ea3i c\xf3 t\u1ed1i thi\u1ec3u 2 kh\xe1ch \u0111\u1ec3 th\u1ef1c hi\u1ec7n thao t\xe1c t\xe1ch.",okText:"\u0110\xf3ng",cancelText:"",hasIcon:!0,status:"info"}});i.containerInstance._rightButtonClick.subscribe(()=>{i.dismiss()})}else this._modal.open(b.V0,{title:"Kh\xf4ng th\u1ec3 ti\u1ebfp t\u1ee5c",body:"V\xe9 ph\u1ea3i c\xf3 t\u1ed1i thi\u1ec3u 2 kh\xe1ch \u0111\u1ec3 th\u1ef1c hi\u1ec7n thao t\xe1c t\xe1ch.",okText:"\u0110\xf3ng",hasCancel:!1})}onOpenAuditLog(t){this.isLoading=!0,this._manageBookingService.getAuditLog(t.airline,t.bookingCode).subscribe({next:n=>{if(this.isLoading=!1,"OK"===n.status){let i=n.data.auditLogs.map(o=>({dateTime:o.dateAndTime,reservation:o.reservation,user:o.user,description:o.description,oldValue:o.oldValue,newValue:o.newValue}));if("VJ"==t.airline)if(this._detectMobileService.isMobile()){const o=this._bottomSheetService.open(C.z_,{headerTitle:"Ki\u1ec3m to\xe1n \u0111\u1eb7t ch\u1ed7",rightButtonIcon:"",leftButtonIcon:"close",leftButtonIconClass:"text-neutral-gray-4",containerFullHeigh:!0,data:{auditLogs:i,pnr:t.bookingCode}});o.containerInstance._leftButtonClick.subscribe(()=>{o.dismiss()}),o.afterDismissed().subscribe({next:a=>{}})}else this._modal.open(C.z_,{auditLogs:i,pnr:t.bookingCode}).afterClosed$.subscribe({next:a=>{}})}},error:n=>{this.isLoading=!1}})}onCheckInOnline(t){switch(t.airline){case"QH":window.open("https://digital.bambooairways.com/ssci/identification");break;case"VN":window.open("https://booking.vietnamairlines.com/ssci/identification");break;case"VJ":window.open("https://www.vietjetair.com/vi/checkin");break;case"VU":window.open("https://booking.vietravelairlines.com/vi/checkin")}}onUpdatePaxInfo(t){const n=[];t.passengers.forEach((i,o)=>{n.push({index:i.index,key:i.key||"",name:i.lastName+" "+i.firstName,parentKey:"N/A"==i.parentKey||null==i.parentKey?"":i.parentKey,type:i.type,child:"N/A",selected:0==o,gender:i.gender,firstName:i.firstName,lastName:i.lastName,dayOfBirth:i.birthday?i.birthday:"",parentName:"",fullType:i.type})}),t.passengers.filter(i=>"INF"===i.type).forEach(i=>{const o=n.find(a=>a.key===i.parentKey);o&&(o.child=i.name)}),n.filter(i=>"INF"===i.type).forEach(i=>{const o=t.passengers.find(a=>a.key===i.parentKey);o&&(i.parentName=o.lastName+" "+o.firstName)}),this.isLoading=!0,this._manageBookingService.checkCurrentTimeBeforeDeparture(t.airline,t.bookingCode,3).subscribe({next:i=>{if("OK"===i.status&&i.data.isCurrentTimeBeforeDeparture)this._ticketLowFareService.checkProcessingDownFare(t.bookingCode).pipe((0,A.x)(()=>this.isLoading=!1)).subscribe({next:o=>{if("OK"===o.status)if(o.data.checkProcessingDownFare)if(this._detectMobileService.isMobile()){const a=this._bottomSheetService.open(b.Q4,{headerTitle:"Kh\xf4ng th\u1ec3 ti\u1ebfp t\u1ee5c",rightButtonIcon:"close",rightButtonIconClass:"text-neutral-gray-4",data:{title:"",body:"Kh\xf4ng th\u1ec3 ch\u1ec9nh s\u1eeda h\xe0nh kh\xe1ch khi \u0111ang canh v\xe9 r\u1ebb. Vui l\xf2ng h\u1ee7y canh v\xe9 h\xe0nh tr\xecnh n\xe0y tr\u01b0\u1edbc khi ti\u1ebfp t\u1ee5c.",okText:"M\u1edf canh v\xe9",cancelText:"\u0110\xf3ng",hasIcon:!0,status:"info"}});a.containerInstance._rightButtonClick.subscribe(()=>{a.dismiss()}),a.afterDismissed().subscribe({next:s=>{s&&this._route.navigate([`admin/pnr-order-detail/${o.data.orderId}`],{state:{isUpdated:!1,isUpdatedFail:!1}})}})}else this._modal.open(b.V0,{title:"Kh\xf4ng th\u1ec3 ti\u1ebfp t\u1ee5c",body:"Kh\xf4ng th\u1ec3 ch\u1ec9nh s\u1eeda h\xe0nh kh\xe1ch khi \u0111ang canh v\xe9 r\u1ebb. Vui l\xf2ng h\u1ee7y canh v\xe9 h\xe0nh tr\xecnh n\xe0y tr\u01b0\u1edbc khi ti\u1ebfp t\u1ee5c.",okText:"M\u1edf canh v\xe9",cancelText:"\u0110\xf3ng"}).afterClosed$.subscribe({next:s=>{s.data&&this._route.navigate([`admin/pnr-order-detail/${o.data.orderId}`],{state:{isUpdated:!1,isUpdatedFail:!1}})}});else if(this._detectMobileService.isMobile()){const a=this._bottomSheetService.open(C.Pt,{headerTitle:"Ch\u1ecdn h\xe0nh kh\xe1ch c\u1ea7n ch\u1ec9nh s\u1eeda",rightButtonIcon:"",leftButtonIcon:"close",leftButtonIconClass:"text-neutral-gray-4",containerFullHeigh:!0,data:{listPassengers:n,bookingDetail:t}});a.containerInstance._leftButtonClick.subscribe(()=>{a.dismiss()}),a.afterDismissed().subscribe({next:s=>{"OK"==s.type&&(this._toastService.add({severity:"success",summary:"S\u1eeda th\xf4ng tin kh\xe1ch th\xe0nh c\xf4ng",detail:"Th\xf4ng tin h\xe0nh kh\xe1ch \u0111\u01b0\u1ee3c s\u1eeda th\xe0nh c\xf4ng!",sticky:!1}),this.gotoBookingDetail(t.airline,t.bookingCode)),"FAILED"==s.type&&this._modal.open(b.V0,{title:"S\u1eeda h\xe0nh kh\xe1ch th\u1ea5t b\u1ea1i",body:s.data.errorDescription.vi,okText:"\u0110\xf3ng",hasIcon:!0,hasCancel:!1})}})}else this._modal.open(C.Pt,{listPassengers:n,bookingDetail:t}).afterClosed$.subscribe({next:s=>{"OK"==s.data.type&&(this._toastService.add({severity:"success",summary:"S\u1eeda th\xf4ng tin kh\xe1ch th\xe0nh c\xf4ng",detail:"Th\xf4ng tin h\xe0nh kh\xe1ch \u0111\u01b0\u1ee3c s\u1eeda th\xe0nh c\xf4ng!",sticky:!1}),this.gotoBookingDetail(t.airline,t.bookingCode)),"FAILED"==s.data.type&&this._modal.open(b.V0,{title:"S\u1eeda h\xe0nh kh\xe1ch th\u1ea5t b\u1ea1i",body:s.data.data.errorDescription.vi,okText:"\u0110\xf3ng",hasIcon:!0,hasCancel:!1})}})},error:()=>{if(this._detectMobileService.isMobile()){const o=this._bottomSheetService.open(b.Q4,{headerTitle:"Kh\xf4ng th\u1ec3 ti\u1ebfp t\u1ee5c",rightButtonIcon:"close",rightButtonIconClass:"text-neutral-gray-4",data:{title:"",body:"Kh\xf4ng th\u1ec3 ch\u1ec9nh s\u1eeda h\xe0nh kh\xe1ch. Vui l\xf2ng th\u1eed l\u1ea1i sau",okText:"\u0110\xf3ng",cancelText:"",hasIcon:!0,status:"info"}});o.containerInstance._rightButtonClick.subscribe(()=>{o.dismiss()})}else this._modal.open(b.V0,{title:"Kh\xf4ng th\u1ec3 ti\u1ebfp t\u1ee5c",body:"Kh\xf4ng th\u1ec3 ch\u1ec9nh s\u1eeda h\xe0nh kh\xe1ch. Vui l\xf2ng th\u1eed l\u1ea1i sau",okText:"\u0110\xf3ng",hasCancel:!1})}});else if(this.isLoading=!1,this._detectMobileService.isMobile()){const o=this._bottomSheetService.open(b.Q4,{headerTitle:"Qu\xe1 th\u1eddi h\u1ea1n s\u1eeda h\xe0nh kh\xe1ch",rightButtonIcon:"close",rightButtonIconClass:"text-neutral-gray-4",data:{title:"",body:"B\u1ea1n ch\u1ec9 c\xf3 th\u1ec3 th\u1ef1c hi\u1ec7n S\u1eeda h\xe0nh kh\xe1ch tr\u01b0\u1edbc gi\u1edd bay 3 ti\u1ebfng",okText:"\u0110\xf3ng",cancelText:"",hasIcon:!0,status:"info"}});o.containerInstance._rightButtonClick.subscribe(()=>{o.dismiss()})}else this._modal.open(b.V0,{title:"Qu\xe1 th\u1eddi h\u1ea1n s\u1eeda h\xe0nh kh\xe1ch",body:"B\u1ea1n ch\u1ec9 c\xf3 th\u1ec3 th\u1ef1c hi\u1ec7n S\u1eeda h\xe0nh kh\xe1ch tr\u01b0\u1edbc gi\u1edd bay 3 ti\u1ebfng",okText:"\u0110\xf3ng",hasCancel:!1})},error:i=>{this.isLoading=!1}})}getFareRule(){const t={journeyInfo:[{provider:"bsp",journeyKey:this.bookingDetails[0].journeys[0].key||"",bookingCode:this.bookingDetails[0].bookingCode||""}]};let n;this.isLoading=!0,this._searchFlightService.getFareRule(t).pipe((0,A.x)(()=>this.isLoading=!1)).subscribe({next:i=>{console.log(i),"OK"===i.status&&(n=i.data,this._detectMobileService.isMobile()||this._modal.open(C.a7,{fareRuleBsp:n,isBsp:!0}))}})}}return c.\u0275fac=function(t){return new(t||c)(e.Y36(se.h),e.Y36(re.J),e.Y36(k.KNP),e.Y36(le.U),e.Y36(ce.h),e.Y36(he.G),e.Y36(ge._),e.Y36(de.m),e.Y36(ue.oE),e.Y36(me.fB),e.Y36(pe.TU),e.Y36(ve.F0),e.Y36(P.Fj),e.Y36(d.$A),e.Y36(fe.BX),e.Y36(be.t7),e.Y36(L.a2),e.Y36(_e.P3),e.Y36(ke.L),e.Y36(Ce.s),e.Y36(Te.x),e.Y36(ye.$),e.Y36(Se.h),e.Y36(Be.o))},c.\u0275cmp=e.Xpm({type:c,selectors:[["booking-success-page"]],standalone:!0,features:[e.jDz],decls:47,vars:60,consts:[[4,"ngIf"],[1,"w-full","h-full","flex","gap-x-4","justify-center","p-4","md:hidden"],[1,"w-[764px]","h-full","flex","flex-col","gap-2"],["class","mb-2",4,"ngIf"],[1,""],[1,"flex","gap-x-[20px]","mb-4"],[1,"w-1","bg-primary-2-4"],[1,"text-heading-md","text-neutral-black"],[1,"flex","flex-col","gap-y-2"],[3,"isShowMore","bookingDetail","isBooked","actionChange","retryBooking",4,"ngFor","ngForOf"],["class","bg-white rounded shadow-cf-md p-6",4,"ngIf"],["class","py-1.5 px-3 bg-functional-1-1 flex gap-x-2 mt-2 rounded",4,"ngIf"],[1,"mt-12","w-[340px]","h-fit","flex","flex-col","gap-y-4"],[3,"listBookingText","modeBookingText","bookingContact","listBookingTextExplain","actionShare","modeChange"],[3,"listBookingCode"],[1,"py-2","px-4","md:flex","hidden","whitespace-nowrap","overflow-x-scroll","bg-neutral-white","sticky","top-0","z-[1]","shadow-cf-sm"],[1,"px-4","py-1.5","rounded-full","text-espressive-md","text-neutral-gray-4","border","border-transparent",3,"click"],["bookingDetailTab",""],["paxInfoTab",""],["totalPriceTab",""],["ticketPriceTab",""],["ticketNumberTab",""],["remarkTab",""],["historyTab",""],["class","p-4 gap-y-3 md:flex md:flex-col hidden w-full",4,"ngIf"],["class","bg-neutral-white pt-3 pr-4 pb-3 pl-4 flex-row gap-0 items-end justify-end w-full fixed bottom-0 hidden md:flex",3,"z-1000",4,"ngIf"],[1,"mb-2"],[3,"passengerInfos"],[3,"isShowMore","bookingDetail","isBooked","actionChange","retryBooking"],[1,"bg-white","rounded","shadow-cf-md","p-6"],[1,"mb-4","flex","items-center","gap-x-3"],[1,"text-heading-sm","text-neutral-black"],[1,"table-auto","w-full"],[1,"border-b","border-neutral-gray-1"],[1,"text-left","text-espressive-sm","text-neutral-gray-4","py-3"],[4,"ngFor","ngForOf"],[1,"text-body-md","text-neutral-black","py-3"],[1,"w-[48px]","h-[24px]","object-contain",3,"src"],[1,"flex","justify-between","items-center"],[1,"flex","gap-x-[20px]","my-4"],[1,"bg-white","rounded","shadow-cf-md"],[3,"priceDetail"],[1,"p-6","flex","flex-col","items-end","gap-[6px]"],[1,"flex","items-center","gap-4"],[1,"text-espressive-md","text-neutral-black"],[1,"min-w-[140px]","text-end","text-heading-lg","text-secondary-3-4"],["cf-button","","size","medium","type","secondary",1,"justify-center","gap-x-2","button-md","bg-neutral-white",3,"click"],[1,"py-1.5","px-3","bg-functional-1-1","flex","gap-x-2","mt-2","rounded"],["icon","info",1,"text-functional-1-3"],[1,"text-express-md"],[1,"ml-6"],[1,"text-body-md-short","list-disc"],[1,"p-4","gap-y-3","md:flex","md:flex-col","hidden","w-full"],[3,"bookingDetail","onDetailClick","actionChange","retryBooking",4,"ngFor","ngForOf"],["class"," w-full",4,"ngIf"],[3,"bookingDetail","onDetailClick","actionChange","retryBooking"],[1,"w-full"],[3,"title","active","contentClass","panelClass"],["titleTemplate",""],["class","flex flex-col mt-3 rounded-lg bg-neutral-white p-3 gap-y-2",4,"ngFor","ngForOf"],[1,"text-espressive-sm","text-neutral-black"],[1,"flex","flex-col","mt-3","rounded-lg","bg-neutral-white","p-3","gap-y-2"],[1,"flex","items-center","gap-x-5"],[1,"text-body-sm","text-neutral-gray-4","w-[104px]"],[1,"text-espressive-md","text-neutral-gray-6"],["class","flex flex-col rounded-lg bg-neutral-white p-3 gap-y-2",4,"ngFor","ngForOf"],[1,"flex","flex-col","rounded-lg","bg-neutral-white","p-3","gap-y-2"],[1,"bg-neutral-white","pt-3","pr-4","pb-3","pl-4","flex-row","gap-0","items-end","justify-end","w-full","fixed","bottom-0","hidden","md:flex"],[1,"flex","flex-row","gap-1","items-center","justify-start","shrink-0","relative",3,"click"],[1,"flex","flex-row","gap-1","items-center","justify-start","shrink-0","relative"],[1,"text-neutral-gray-4","text-left","relative","text-espressive-xs"],[1,"text-secondary-3-4","text-center","relative","text-heading-sm"],["icon","chevron_up","size","small",4,"ngIf"],["icon","chevron_down","size","small",4,"ngIf"],["totalPriceBottomSheet",""],["icon","chevron_up","size","small"],["icon","chevron_down","size","small"],[1,"flex","flex-col","gap-4","items-start","justify-start","w-full","relative","p-4","pb-12"],[1,"flex","flex-row","gap-6","items-center","justify-start","self-stretch","shrink-0","relative"],[1,"flex","flex-row","gap-3","items-center","justify-start","flex-1","relative"],[1,"flex","flex-col","gap-1","items-start","justify-start","shrink-0","relative"],[1,"text-neutral-gray-4","text-left","relative","text-body-sm"],[1,"flex","flex-col","gap-1","items-end","justify-center","shrink-0","relative"],[1,"text-neutral-gray-4","text-right","relative","text-body-sm"],[1,"bg-neutral-white","rounded-lg","border-solid","p-4","flex","flex-col","gap-2","items-end","justify-start","shrink-0","w-full","relative","overflow-hidden"],[1,"flex","flex-row","gap-1.5","items-center","justify-start","shrink-0","relative",3,"click"],["size","small","icon","copy"],[1,"text-neutral-gray-6","text-center","relative","flex","items-center","justify-center","text-body-md"],[1,"text-body-sm","w-full",3,"bookingText"]],template:function(t,n){if(1&t){const i=e.EpF();e.YNc(0,xe,1,0,"cf-spinner",0),e.TgZ(1,"div")(2,"div",1)(3,"div",2),e.YNc(4,Ee,6,1,"div",3),e.TgZ(5,"div",4)(6,"div",5),e._UZ(7,"div",6),e.TgZ(8,"div",7),e._uU(9,"Chi ti\u1ebft \u0111\u1eb7t ch\u1ed7"),e.qZA()(),e.TgZ(10,"div",8),e.YNc(11,Pe,1,4,"booking-detail",9),e.qZA()(),e.YNc(12,Ie,22,1,"div",10),e.YNc(13,Fe,22,1,"div",10),e.YNc(14,Me,17,9,"div",0),e.YNc(15,Oe,10,0,"div",11),e.qZA(),e.TgZ(16,"div",12)(17,"cf-booking-text",13),e.NdJ("actionShare",function(a){return n.onShare(a)})("modeChange",function(a){return n.changeModeBookingText(a)}),e.qZA(),e._UZ(18,"remark-booking-page",14),e.qZA()(),e.TgZ(19,"div",15)(20,"div",16,17),e.NdJ("click",function(){e.CHM(i);const a=e.MAs(21);return e.KtG(n.mobileTabChange("BOOKING_DETAIL",a))}),e._uU(22," Chi ti\u1ebft \u0111\u1eb7t ch\u1ed7 "),e.qZA(),e.TgZ(23,"div",16,18),e.NdJ("click",function(){e.CHM(i);const a=e.MAs(24);return e.KtG(n.mobileTabChange("PAX_INFO",a))}),e._uU(25," Th\xf4ng tin h\xe0nh kh\xe1ch "),e.qZA(),e.TgZ(26,"div",16,19),e.NdJ("click",function(){e.CHM(i);const a=e.MAs(27);return e.KtG(n.mobileTabChange("TOTAL_PRICE",a))}),e._uU(28," T\u1ed5ng chi ph\xed "),e.qZA(),e.TgZ(29,"div",16,20),e.NdJ("click",function(){e.CHM(i);const a=e.MAs(30);return e.KtG(n.mobileTabChange("TICKET_FACE",a))}),e._uU(31," M\u1eb7t v\xe9 "),e.qZA(),e.TgZ(32,"div",16,21),e.NdJ("click",function(){e.CHM(i);const a=e.MAs(33);return e.KtG(n.mobileTabChange("TICKET_NUMBER",a))}),e._uU(34," S\u1ed1 v\xe9 "),e.qZA(),e.TgZ(35,"div",16,22),e.NdJ("click",function(){e.CHM(i);const a=e.MAs(36);return e.KtG(n.mobileTabChange("REMARK",a))}),e._uU(37," Remark "),e.qZA(),e.TgZ(38,"div",16,23),e.NdJ("click",function(){e.CHM(i);const a=e.MAs(39);return e.KtG(n.mobileTabChange("HISTORY",a))}),e._uU(40," L\u1ecbch s\u1eed "),e.qZA()(),e.YNc(41,je,4,3,"div",24),e.YNc(42,Je,22,3,"div",24),e.YNc(43,Ye,2,1,"div",24),e.YNc(44,Xe,13,11,"div",25),e.YNc(45,et,2,1,"div",24),e.YNc(46,tt,2,1,"div",24),e.qZA()}2&t&&(e.Q6J("ngIf",n.isLoading),e.xp6(4),e.Q6J("ngIf",n.isSuccess),e.xp6(7),e.Q6J("ngForOf",n.bookingDetails),e.xp6(1),e.Q6J("ngIf",n.hasBaggageSelected),e.xp6(1),e.Q6J("ngIf",n.hasSeatSelected),e.xp6(1),e.Q6J("ngIf",n.isSuccess),e.xp6(1),e.Q6J("ngIf",n.hasInternationalFlight),e.xp6(2),e.Q6J("listBookingText",n.listBookingText)("modeBookingText",n.modeBookingText)("bookingContact",n.bookingContact)("listBookingTextExplain",n.listBookingTextExplain),e.xp6(1),e.Q6J("listBookingCode",n.listBookingCode),e.xp6(2),e.ekj("text-secondary-3-4","BOOKING_DETAIL"===n.mobileTabMode)("!border-secondary-3-4","BOOKING_DETAIL"===n.mobileTabMode)("bg-secondary-3-1","BOOKING_DETAIL"===n.mobileTabMode),e.xp6(3),e.ekj("text-secondary-3-4","PAX_INFO"===n.mobileTabMode)("!border-secondary-3-4","PAX_INFO"===n.mobileTabMode)("bg-secondary-3-1","PAX_INFO"===n.mobileTabMode),e.xp6(3),e.ekj("text-secondary-3-4","TOTAL_PRICE"===n.mobileTabMode)("!border-secondary-3-4","TOTAL_PRICE"===n.mobileTabMode)("bg-secondary-3-1","TOTAL_PRICE"===n.mobileTabMode),e.xp6(3),e.ekj("text-secondary-3-4","TICKET_FACE"===n.mobileTabMode)("!border-secondary-3-4","TICKET_FACE"===n.mobileTabMode)("bg-secondary-3-1","TICKET_FACE"===n.mobileTabMode),e.xp6(3),e.ekj("text-secondary-3-4","TICKET_NUMBER"===n.mobileTabMode)("!border-secondary-3-4","TICKET_NUMBER"===n.mobileTabMode)("bg-secondary-3-1","TICKET_NUMBER"===n.mobileTabMode),e.xp6(3),e.ekj("text-secondary-3-4","REMARK"===n.mobileTabMode)("!border-secondary-3-4","REMARK"===n.mobileTabMode)("bg-secondary-3-1","REMARK"===n.mobileTabMode),e.xp6(3),e.ekj("text-secondary-3-4","HISTORY"===n.mobileTabMode)("!border-secondary-3-4","HISTORY"===n.mobileTabMode)("bg-secondary-3-1","HISTORY"===n.mobileTabMode),e.xp6(3),e.Q6J("ngIf","BOOKING_DETAIL"===n.mobileTabMode),e.xp6(1),e.Q6J("ngIf","PAX_INFO"===n.mobileTabMode),e.xp6(1),e.Q6J("ngIf","TOTAL_PRICE"===n.mobileTabMode),e.xp6(1),e.Q6J("ngIf","TOTAL_PRICE"===n.mobileTabMode),e.xp6(1),e.Q6J("ngIf","TICKET_FACE"===n.mobileTabMode),e.xp6(1),e.Q6J("ngIf","REMARK"===n.mobileTabMode))},dependencies:[S.O5,S.ax,Q.AS,S.JJ,C.Js,C.AT,C.Cg,k.AxE,k.Sm8,b.OR,$.j$,U.N8,U.Xq,b.bY,Y.N,C.CY,w.B,w.K,L.DW,b.gx],encapsulation:2}),c})()}}]);