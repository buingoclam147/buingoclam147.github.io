"use strict";(self.webpackChunkcheapflightclient=self.webpackChunkcheapflightclient||[]).push([[2678],{42678:(ye,ne,l)=>{l.d(ne,{yL:()=>W,u1:()=>de,I5:()=>k,FH:()=>ue});var Z=l(80529),oe=l(44500),B=l(54004),k=(()=>{return(o=k||(k={})).JOURNEY="JOURNEY",o.PASSENGER="PASSENGER",o.CONFIGURATION="CONFIGURATION",k;var o})(),t=l(97582),z=l(97380),i=l(87067),S=l(43429);class A{}(0,t.gn)([(0,i.C)()],A.prototype,"status",void 0),(0,t.gn)([(0,S.D)(()=>ae),(0,i.C)()],A.prototype,"data",void 0),(0,t.gn)([(0,i.C)()],A.prototype,"objectError",void 0),(0,t.gn)([(0,i.C)()],A.prototype,"success",void 0);class ae extends z.VP{}class x{}(0,t.gn)([(0,i.C)()],x.prototype,"airline",void 0),(0,t.gn)([(0,i.C)()],x.prototype,"flightType",void 0),(0,t.gn)([(0,S.D)(()=>f),(0,i.C)()],x.prototype,"journeys",void 0),(0,t.gn)([(0,S.D)(()=>m),(0,i.C)()],x.prototype,"passengers",void 0);class f{}(0,t.gn)([(0,i.C)()],f.prototype,"leg",void 0),(0,t.gn)([(0,i.C)()],f.prototype,"startPoint",void 0),(0,t.gn)([(0,i.C)()],f.prototype,"endPoint",void 0),(0,t.gn)([(0,i.C)()],f.prototype,"departTime",void 0),(0,t.gn)([(0,i.C)()],f.prototype,"arrivalTime",void 0),(0,t.gn)([(0,i.C)()],f.prototype,"duration",void 0),(0,t.gn)([(0,i.C)()],f.prototype,"segments",void 0),(0,t.gn)([(0,i.C)()],f.prototype,"rangeTime",void 0);class m{}(0,t.gn)([(0,i.C)()],m.prototype,"birthday",void 0),(0,t.gn)([(0,i.C)()],m.prototype,"firstName",void 0),(0,t.gn)([(0,i.C)()],m.prototype,"lastName",void 0),(0,t.gn)([(0,i.C)()],m.prototype,"type",void 0),(0,t.gn)([(0,i.C)()],m.prototype,"key",void 0),(0,t.gn)([(0,i.C)()],m.prototype,"parentKey",void 0),(0,t.gn)([(0,i.C)()],m.prototype,"namePrefix",void 0),(0,t.gn)([(0,i.C)()],m.prototype,"gender",void 0),(0,t.gn)([(0,i.C)()],m.prototype,"index",void 0);class F{}(0,t.gn)([(0,i.C)()],F.prototype,"timeCreate",void 0),(0,t.gn)([(0,i.C)()],F.prototype,"timeExpire",void 0),(0,t.gn)([(0,i.C)()],F.prototype,"timeUpdate",void 0),(0,t.gn)([(0,i.C)()],F.prototype,"timeFinished",void 0),(0,t.gn)([(0,S.D)(()=>D),(0,i.C)()],F.prototype,"fareMonitors",void 0),(0,t.gn)([(0,i.C)()],F.prototype,"notifyBeforeExpired",void 0),(0,t.gn)([(0,i.C)()],F.prototype,"targetPrice",void 0);class D{}(0,t.gn)([(0,i.C)()],D.prototype,"onlyCareLowerFare",void 0),(0,t.gn)([(0,i.C)()],D.prototype,"expectLowerFareClass",void 0),(0,t.gn)([(0,i.C)()],D.prototype,"specifyFareClass",void 0),(0,t.gn)([(0,i.C)()],D.prototype,"currentFareClass",void 0),(0,t.gn)([(0,i.C)()],D.prototype,"specifyFareClassInfo",void 0);class C{}(0,t.gn)([(0,i.C)()],C.prototype,"airline",void 0),(0,t.gn)([(0,i.C)()],C.prototype,"originalPnr",void 0),(0,t.gn)([(0,i.C)()],C.prototype,"detectedPnr",void 0),(0,t.gn)([(0,i.C)()],C.prototype,"originalFare",void 0),(0,t.gn)([(0,i.C)()],C.prototype,"detectedFare",void 0),(0,t.gn)([(0,i.C)()],C.prototype,"originalFareClass",void 0),(0,t.gn)([(0,i.C)()],C.prototype,"detectedFareClass",void 0),(0,t.gn)([(0,i.C)()],C.prototype,"higherFare",void 0),(0,t.gn)([(0,i.C)()],C.prototype,"lastTimeUpdate",void 0);class O{}(0,t.gn)([(0,i.C)()],O.prototype,"status",void 0),(0,t.gn)([(0,S.D)(()=>P),(0,i.C)()],O.prototype,"data",void 0),(0,t.gn)([(0,i.C)()],O.prototype,"objectError",void 0),(0,t.gn)([(0,i.C)()],O.prototype,"success",void 0);class P{}(0,t.gn)([(0,i.C)()],P.prototype,"orderId",void 0),(0,t.gn)([(0,i.C)()],P.prototype,"canUpdate",void 0),(0,t.gn)([(0,i.C)()],P.prototype,"code",void 0),(0,t.gn)([(0,i.C)()],P.prototype,"huntFareConditions",void 0),(0,t.gn)([(0,i.C)()],P.prototype,"advanceSetting",void 0),(0,t.gn)([(0,i.C)()],P.prototype,"ticketInfo",void 0),(0,t.gn)([(0,S.D)(()=>z.v_),(0,i.C)()],P.prototype,"availableSlotInfo",void 0);var H=l(50494),y=l(94650);const E={headers:new Z.WM({"Content-Type":"application/json"})};let W=(()=>{class o{constructor(e,a){this.http=e,this.appConfig=a}getLstAirlineFareoptions(){return this.http.post(this.appConfig.apiUrlTPS+"ticket-low-fare/get-list-airline-fare-class",JSON.stringify({airline:"vn,qh,vj"}),E)}registerHuntBooking(e){return this.http.post(this.appConfig.apiUrlTPS+"hunt_for_ticket/register-order",JSON.stringify(e),E)}getPnrOrderDetail(e){return this.http.get(this.appConfig.apiUrlTPS+"hunt_for_ticket/pnr-order_detail/"+e,E).pipe((0,B.U)(a=>(0,H.yE)(A,a,{excludeExtraneousValues:!0})))}getCurrentConfigOrder(e){return this.http.post(this.appConfig.apiUrlTPS+"hunt_for_ticket/current-config-order",JSON.stringify({orderId:e}),E).pipe((0,B.U)(a=>(0,H.yE)(O,a,{excludeExtraneousValues:!0})))}updateConfigOrder(e){return this.http.post(this.appConfig.apiUrlTPS+"hunt_for_ticket/update_order_config",JSON.stringify(e),E).pipe((0,B.U)(a=>(0,H.yE)(A,a,{excludeExtraneousValues:!0})))}}return o.\u0275fac=function(e){return new(e||o)(y.LFG(Z.eN),y.LFG(oe.qB))},o.\u0275prov=y.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"}),o})();var s=l(24006),G=l(57085),se=l(77579),K=l(35650),V=l(43201),v=l(15439);const X=o=>{const h=o.get("targetVNPrice"),e=o.get("targetVJPrice"),a=o.get("targetQHPrice"),u=o.get("fareOptions"),d=o.get("enableTimeStart"),p=o.get("enableFareOption"),T=o.get("enablePriceOption"),c=o.get("startTimeRange");let g={};return null!=d&&d.value&&(null!=c&&c.value&&(null==c?void 0:c.value.length)>0||(g.invalidTimeRanges=!0)),null!=p&&p.value&&(null!=u&&u.value&&(null==u?void 0:u.value.length)>0||(g.invalidFares=!0)),null!=T&&T.value&&(null!=h&&h.value||null!=e&&e.value||null!=a&&a.value?((null==h?void 0:h.value)<0||(null==e?void 0:e.value)<0||(null==a?void 0:a.value)<0)&&(g.negativePrice=!0):g.invalidPrice=!0),!d&&!T&&(g.invalidPriceFareOption=!0),Object.values(g),Object.values(g).length>0?g:null};var _=l(82761),le=l(40899);let ue=(()=>{class o{constructor(e,a,u,d,p){this.route=e,this._route=a,this.fb=u,this._permissionService=d,this._bookingHunterService=p,this.optionsAdultPassenger=[],this.numberOfPassenger={adult:1,child:0,infant:0},this.showPriceOption=!1,this.showTimeStartOption=!1,this.showFareOption=!0,this.numberOfPassengerChange$=new se.x,this.isBooker=!this._permissionService.isVNAccount(),this.optionDepartureTime=[{name:"S\xe1ng s\u1edbm",code:"early_morning",start:"00:00",end:"05:59",isActive:!1,disable:!1,startTime:0,endTime:360,totalAvailable:0},{name:"Bu\u1ed5i s\xe1ng",code:"morning",start:"06:00",end:"11:59",isActive:!1,disable:!1,startTime:360,endTime:720,totalAvailable:0},{name:"Bu\u1ed5i chi\u1ec1u",code:"afternoon",start:"12:00",end:"17:59",isActive:!1,disable:!1,startTime:720,endTime:1080,totalAvailable:0},{name:"Bu\u1ed5i t\u1ed1i",code:"evening",start:"18:00",end:"23:59",isActive:!1,disable:!1,startTime:1080,endTime:1439,totalAvailable:0},{name:"T\xf9y ch\u1ecdn",code:"custom",start:"00:00",end:"23:59",isActive:!1,disable:!1,startTime:0,endTime:1439,totalAvailable:0}],this.customRangeItem={rangeValues:[0,1439],startTimeStr:"00:00",endTimeStr:"23:59"},this.departureTime=v().toDate().getTime(),this.earliestDoBChild=(0,V.Z)(this.departureTime,-2),this.earliestDoBChild=(0,K.Z)(this.earliestDoBChild,-1),this.earliestDoBInfant=v().toDate(),this.lastestDoBChild=(0,V.Z)(this.departureTime,-11),this.lastestDoBInfant=(0,V.Z)(this.departureTime,-2),this.lastestDoBInfant=(0,K.Z)(this.lastestDoBInfant,1)}initForm(){this.resetDataService(),this.initJourneyForm(),this.initConfigurationForm(),this.initPassengerForm()}preloadForm(e){var a,u,d,p,T,c,g,U,L,J,q,j,M,$,w,Q;const I=e.ticketInfo.journeys[0],R="PRICE"===e.huntFareConditions.type;this.showPriceOption=R,this.showFareOption=!R;const pe=(null===(u=null===(a=e.huntFareConditions.specifyPriceList)||void 0===a?void 0:a.find(r=>"VN"===r.airline.toUpperCase()))||void 0===u?void 0:u.targetPrice)||0,ge=(null===(p=null===(d=e.huntFareConditions.specifyPriceList)||void 0===d?void 0:d.find(r=>"QH"===r.airline.toUpperCase()))||void 0===p?void 0:p.targetPrice)||0,ve=(null===(c=null===(T=e.huntFareConditions.specifyPriceList)||void 0===T?void 0:T.find(r=>"VJ"===r.airline.toUpperCase()))||void 0===c?void 0:c.targetPrice)||0;let ee=!0;if(I.rangeTime.forEach(r=>{this.optionDepartureTime.forEach(n=>{n.start===r.fromDate&&n.end===r.toDate&&(n.isActive=!0,ee=!1)})}),ee&&I.rangeTime[0]){const r=I.rangeTime[0],n=this.convertTimeRangeStrToMin(r.fromDate),re=this.convertTimeRangeStrToMin(r.toDate);this.customRangeItem={rangeValues:[n,re],startTimeStr:r.fromDate,endTimeStr:r.toDate},this.optionDepartureTime[4].isActive=!0,this.optionDepartureTime[4].start=r.fromDate,this.optionDepartureTime[4].end=r.toDate,this.optionDepartureTime[4].startTime=n,this.optionDepartureTime[4].endTime=re}const Y=this.optionDepartureTime.filter(r=>r.isActive),te=Y&&Y.length>0;this.showTimeStartOption=te;const ce=(null!==(g=v(I.departTime))&&void 0!==g&&g.isBefore(v())?null:v(I.departTime).toDate())||null;this.journeyFormGroup=this.fb.group({startPoint:[I.startPoint,[s.kI.required]],endPoint:[I.endPoint,[s.kI.required]],departDate:[ce,[s.kI.required]],startTimeRange:[Y],enablePriceOption:[R],targetVNPrice:[pe],targetVJPrice:[ge],targetQHPrice:[ve],enableFareOption:[!R],enableTimeStart:[te],fareOptions:[e.huntFareConditions.specifyFareClassList]},{validators:X});const ie=v(e.advanceSetting.timeExecute).isAfter(v().toDate()),b=ie?v(e.advanceSetting.timeExecute).toDate():null,me=ie&&b?`${null==b?void 0:b.getHours().toString().padStart(2,"0")}:${null==b?void 0:b.getMinutes().toString().padStart(2,"0")}`:null;this.configurationFormGroup=this.fb.group({dateExpires:[b,[s.kI.required]],timeExpires:[me,[s.kI.required]],sendNotify:[e.advanceSetting.notifBeforExpire,[s.kI.required]],agentDisplayName:[null],agentAvatar:[null],agentName:[null],agentPhone:[null],agentEmail:[null],agentId:[null,[s.kI.required]]}),this.numberOfPassenger={adult:(null===(L=null===(U=e.ticketInfo.passengers)||void 0===U?void 0:U.filter(r=>{var n;return"ADT"===(null===(n=r.type)||void 0===n?void 0:n.toUpperCase())}))||void 0===L?void 0:L.length)||0,child:(null===(q=null===(J=e.ticketInfo.passengers)||void 0===J?void 0:J.filter(r=>{var n;return"CHD"===(null===(n=r.type)||void 0===n?void 0:n.toUpperCase())}))||void 0===q?void 0:q.length)||0,infant:(null===(M=null===(j=e.ticketInfo.passengers)||void 0===j?void 0:j.filter(r=>{var n;return"INF"===(null===(n=r.type)||void 0===n?void 0:n.toUpperCase())}))||void 0===M?void 0:M.length)||0},this.passengerFormGroup=this.fb.group({adultPassenger:this.fb.array([]),childPassenger:this.fb.array([]),infantPassenger:this.fb.array([])},{validator:(0,G.aV)()});const he=(null===($=e.ticketInfo.passengers)||void 0===$?void 0:$.filter(r=>{var n;return"ADT"===(null===(n=r.type)||void 0===n?void 0:n.toUpperCase())}).map(r=>{var n;return{firstName:r.firstName,lastName:r.lastName,gender:(null===(n=r.gender)||void 0===n?void 0:n.toLowerCase())||"male"}}))||[],fe=(null===(w=e.ticketInfo.passengers)||void 0===w?void 0:w.filter(r=>{var n;return"CHD"===(null===(n=r.type)||void 0===n?void 0:n.toUpperCase())}).map(r=>{var n;return{firstName:r.firstName,lastName:r.lastName,gender:(null===(n=r.gender)||void 0===n?void 0:n.toLowerCase())||"male",birthday:v(r.birthday).toDate()}}))||[],Ce=(null===(Q=e.ticketInfo.passengers)||void 0===Q?void 0:Q.filter(r=>{var n;return"INF"===(null===(n=r.type)||void 0===n?void 0:n.toUpperCase())}).map(r=>{var n;return{firstName:r.firstName,lastName:r.lastName,gender:(null===(n=r.gender)||void 0===n?void 0:n.toLowerCase())||"male",birthday:v(r.birthday).toDate(),parentIndex:r.parentIndex+""}}))||[];this.initPassengerForm(),this.initAdultFormGroup(),this.initChildFormGroup(),this.initInfantFormGroup(),this.passengerFormGroup.patchValue({adultPassenger:he,childPassenger:fe,infantPassenger:Ce}),this.preInitialFormOrderId=void 0}reloadPassengerForm(){const e=this.passengerFormGroup.value;console.log(e),this.initPassengerForm(),this.initAdultFormGroup(),this.initChildFormGroup(),this.initInfantFormGroup(),this.passengerFormGroup.patchValue(Object.assign({},e))}initJourneyForm(){this.journeyFormGroup=this.fb.group({startPoint:["",[s.kI.required]],endPoint:["",[s.kI.required]],departDate:[null,[s.kI.required]],startTimeRange:[null],enablePriceOption:[!1],targetVNPrice:[0],targetVJPrice:[0],targetQHPrice:[0],enableFareOption:[!0],enableTimeStart:[!1],fareOptions:[null]},{validators:X})}initConfigurationForm(){this.configurationFormGroup=this.fb.group({dateExpires:[null,[s.kI.required]],timeExpires:[null,[s.kI.required]],sendNotify:[!1,[s.kI.required]],agentDisplayName:[null],agentAvatar:[null],agentName:[null],agentPhone:[null],agentEmail:[null],agentId:[null,[s.kI.required]]})}initPassengerForm(){this.passengerFormGroup=this.fb.group({secretRemark:[null],publicRemark:[null],adultPassenger:this.fb.array([]),childPassenger:this.fb.array([]),infantPassenger:this.fb.array([])},{validator:(0,G.aV)()})}initAdultFormGroup(){for(let e=0;e<this.numberOfPassenger.adult;e++){const a=this.fb.group({firstName:[null,[s.kI.required]],lastName:[null,[s.kI.required]],gender:["male",[s.kI.required]],membershipQH:[null],membershipVN:[null]});this.getFormArray("adultPassenger").push(a)}}initChildFormGroup(){for(let e=0;e<this.numberOfPassenger.child;e++){const a=this.fb.group({birthday:[null,[s.kI.required]],firstName:[null,[s.kI.required]],lastName:[null,[s.kI.required]],gender:["male",[s.kI.required]],membershipQH:[null],membershipVN:[null]},{validator:(0,G.$K)("birthday",this.departureTime)});this.getFormArray("childPassenger").push(a)}}initInfantFormGroup(){for(let e=0;e<this.numberOfPassenger.infant;e++){const a=this.fb.group({birthday:[null,[s.kI.required]],firstName:[null,[s.kI.required]],lastName:[null,[s.kI.required]],gender:["male",[s.kI.required]],parentIndex:[e+"",[s.kI.required]],membershipQH:[null],membershipVN:[null]},{validator:(0,G.DW)("birthday",this.departureTime)});this.getFormArray("infantPassenger").push(a)}}getNumberOfPassenger(){this.initAdultPassengerOptions()}getFormArray(e){return this.passengerFormGroup.controls[e]}getFormControlInArray(e,a){return e.controls[a]}initAdultPassengerOptions(){for(let e=0;e<this.numberOfPassenger.adult;e++)this.optionsAdultPassenger.push({code:e+"",name:`Ng\u01b0\u1eddi l\u1edbn ${e+1}`})}changeNumberOfPassenger(e){this.numberOfPassenger=e,this.numberOfPassengerChange$.next(e)}numOfPax(){return this.numberOfPassenger}formJourneyData(){return this.journeyFormGroup.value}formPassengerData(){return this.passengerFormGroup.value}formConfigurationData(){return this.configurationFormGroup.value}resetDataService(){this.customRangeItem={rangeValues:[0,1439],startTimeStr:"00:00",endTimeStr:"23:59"},this.showPriceOption=!1,this.showTimeStartOption=!1,this.showFareOption=!0,this.selectedFaresTree=[],this.optionDepartureTime=[{name:"S\xe1ng s\u1edbm",code:"early_morning",start:"00:00",end:"05:59",isActive:!1,disable:!1,startTime:0,endTime:360,totalAvailable:0},{name:"Bu\u1ed5i s\xe1ng",code:"morning",start:"06:00",end:"11:59",isActive:!1,disable:!1,startTime:360,endTime:720,totalAvailable:0},{name:"Bu\u1ed5i chi\u1ec1u",code:"afternoon",start:"12:00",end:"17:59",isActive:!1,disable:!1,startTime:720,endTime:1080,totalAvailable:0},{name:"Bu\u1ed5i t\u1ed1i",code:"evening",start:"18:00",end:"23:59",isActive:!1,disable:!1,startTime:1080,endTime:1439,totalAvailable:0},{name:"T\xf9y ch\u1ecdn",code:"custom",start:"00:00",end:"23:59",isActive:!1,disable:!1,startTime:0,endTime:1439,totalAvailable:0}]}isAgent2Show(){const e=this._permissionService.getCurrentAuthor();return"AGENT2"===(null==e?void 0:e.titleCode.toUpperCase())}getSourceEvent(){switch(this.sourceEvent){case"SEARCH_INPUT":return 0;case"SEARCH_RESULT":return 1;case"HEADER_MANAGE":return 2;case"EMPTY_STATE":return 3;case"REGENERATE":return 4;default:return-1}}convertTimeRangeStrToMin(e){return v.duration(e).asMinutes()}minuteToString(e){const a=Math.floor(e/60),u=e%60;let d=`${a}`,p=`${u}`;return a<10&&(d=`0${a}`),u<10&&(p=`0${u}`),`${d}:${p}`}}return o.\u0275fac=function(e){return new(e||o)(y.LFG(_.gz),y.LFG(_.F0),y.LFG(s.qu),y.LFG(le.$A),y.LFG(W))},o.\u0275prov=y.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"}),o})();var N=l(53820);const de={[N.b.CREATE]:{name:"\u0110ang s\u0103n v\xe9",description:"S\u0103n v\xe9 t\u1ef1 \u0111\u1ed9ng \u0111ang ho\u1ea1t \u0111\u1ed9ng",icon:"search",backgroundColor:"bg-[#FFEAB9]",textColor:"text-secondary-7-5"},[N.b.IN_PROCESS]:{name:"\u0110ang canh v\xe9",description:"Canh v\xe9 r\u1ebb t\u1ef1 \u0111\u1ed9ng \u0111ang ho\u1ea1t \u0111\u1ed9ng",icon:"search",backgroundColor:"bg-[#FFEAB9]",textColor:"text-secondary-7-5"},[N.b.COMPLETED]:{name:"\u0110\xe3 s\u0103n th\xe0nh c\xf4ng",description:"\u0110\xe3 s\u0103n \u0111\u01b0\u1ee3c v\xe9",icon:"check",backgroundColor:"bg-[#07A35D]",textColor:"text-neutral-white"},[N.b.IN_PROCESS_PRICE_UP]:{name:"\u0110ang s\u0103n gi\xe1 t\u0103ng",description:"Gi\xe1 v\xe9 \u0111\xe3 t\u0103ng, vui l\xf2ng c\xe2n nh\u1eafc xu\u1ea5t v\xe9",icon:"arrow_right_up",backgroundColor:"bg-[#ffd1bc]",textColor:"text-primary-1-4"},[N.b.CANCEL]:{name:"\u0110\xe3 h\u1ee7y",description:"\u0110\xe3 h\u1ee7y y\xeau c\u1ea7u s\u0103n v\xe9",icon:"coupon_slash",backgroundColor:"bg-[#999999]",textColor:"text-neutral-white"},[N.b.EXPIRED]:{name:"\u0110\xe3 h\u1ebft s\u0103n",description:"H\u1ebft h\u1ea1n s\u0103n v\xe9",icon:"clock",backgroundColor:"bg-[#CCCCCC]",textColor:"text-neutral-gray-6"}}}}]);