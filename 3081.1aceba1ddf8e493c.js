"use strict";(self.webpackChunkcheapflightclient=self.webpackChunkcheapflightclient||[]).push([[3081],{83081:(M,u,r)=>{r.r(u),r.d(u,{BtcSearchComponent:()=>x});var y=r(36895),d=r(83700),b=r(27898),o=r(72506),p=r(50518),C=r(64070);const m=c=>Object.entries(c).map(([n,e])=>((n,e)=>null==e||"string"==typeof e&&""===e?null:Array.isArray(e)?`${n}=${e.map(a=>encodeURIComponent(String(a))).join(",")}`:"object"==typeof e?m(e):`${n}=${encodeURIComponent(String(e))}`)(n,e)).filter(n=>null!==n).join("&");var v=r(54646),_=r(99137),T=r(53620),S=r(37453),F=r(78998),A=r(82692),L=r(53819),g=r(15439),t=r(94650),j=r(31380),O=r(24006),I=r(28490),J=r(98184);const B=["containerEl"],Z=["searchInputCpn"];let x=(()=>{class c{constructor(n,e,a,i,s){this.cfIconRegister=n,this._helperSvc=e,this._fb=a,this._locationDataService=i,this.overlayContainer=s,this.dataSearch=p.Av,this.airlineFilters=p._q,this.cabinList=p.St,this.paxTypeList=p.S,this.isAirLineInternational=!1,this.typeSearch=C.VB,this.initIcon(),this.initForm()}ngOnDestroy(){this.onOverlayStateChange().disconnect()}ngAfterViewInit(){window.addEventListener("message",n=>{"onOutside"===n.data&&(this.searchInputCpn.dateRange.close(),this.outsideClick())}),this.onOverlayStateChange()}isOverlayOpen(){return this.overlayContainer.getContainerElement().children.length>0}onOverlayStateChange(){const n=this.overlayContainer.getContainerElement(),e=new MutationObserver(()=>{window.parent.postMessage({isOverlayOpen:this.isOverlayOpen()},"*")});return e.observe(n,{childList:!0}),e}outsideClick(){this.containerEl.nativeElement.click()}ngOnInit(){window.onload=()=>{const e=document.documentElement.scrollHeight;window.parent.postMessage({height:e},"*")},new MutationObserver(()=>{const e=document.documentElement.scrollHeight;window.parent.postMessage({height:e},"*")}).observe(document.body,{attributes:!0,childList:!0,subtree:!0})}initForm(){this.journeyFormArr=this._fb.array([]),this._helperSvc.addJourney({startPoint:null,endPoint:null,departDate:null},this.journeyFormArr)}initIcon(){this.cfIconRegister.registerIcons([o.bHT,o.D5L,o.TM4,o.gll,o.TOh,o.KYu,o.tLH,o.IIV,o._hx,o.YwC,o.esH])}flightTypeChange(n){var e;switch(n){case this.typeSearch.OneWay:this._helperSvc.updateJourneyByType(this.journeyFormArr,"ONE_WAY");break;case this.typeSearch.RoundTrip:this._helperSvc.updateJourneyByType(this.journeyFormArr,"ROUND_TRIP");break;case this.typeSearch.MultiWay:this._helperSvc.updateJourneyByType(this.journeyFormArr,"MULTI_WAY")}const{cabin:a,paxType:i,airline:s}=null===(e=this.dataSearch)||void 0===e?void 0:e.journey[0];this.dataSearch=Object.assign(Object.assign({},this.dataSearch),{type:n,journey:this._helperSvc.progressJourneyFormArr(this.journeyFormArr.value,n,{cabin:a,paxType:i,airline:s})})}progressInternationalFlight(n){let e=!1;return(n.startPoint||n.endPoint)&&(e=!!n.startPoint&&this._locationDataService.checkAirportInternational(n.startPoint)||!!n.endPoint&&this._locationDataService.checkAirportInternational(n.endPoint),this.cabinList=[...this._helperSvc.resetCabinList(this.cabinList)],this.paxTypeList=[...this._helperSvc.resetPaxTypeList(this.paxTypeList)]),this.airlineFilters=[...this._helperSvc.progressAirlineFileByInternational(this.airlineFilters,e)],e}numberOfPassengerChange({adult:n,child:e,infant:a}){this.dataSearch=Object.assign(Object.assign({},this.dataSearch),{adultCount:n,childCount:e,infantCount:a})}airlineFilterChange(n){this.airlineFilters.forEach(e=>e.actived=!1),this.airlineFilters.filter(e=>n.includes(e.value)).forEach(e=>e.actived=!0)}cabinChange(n){this.cabinList=[...this.cabinList.map(e=>Object.assign(Object.assign({},e),{actived:n.value===e.value}))]}paxTypeChange({value:n}){this.paxTypeList=[...this.paxTypeList.map(e=>Object.assign(Object.assign({},e),{actived:!!n&&e.value===n}))]}removeRoute(n){console.log("remove route",n)}searchInputChange(){this.isAirLineInternational=this.progressInternationalFlight(this.journeyFormArr.controls[0].value)}generateRangeDateSearchMinFare(n){const e=g(new Date),a=g(n);let i=[];i.push(e.format("YYYY-MM-DD"));let s=e.clone().add(1,"month").startOf("month");for(;s.isBefore(a)||s.isSame(a,"month");)i.push(s.format("YYYY-MM-DD")),s.add(1,"month");return i}onDateTypeChange(n){console.log("date type change",n)}onCheckDirectFlight(n){this.dataSearch.isDirectFlight=n}searchFlight(){var n,e;if(this.journeyFormArr.markAllAsTouched(),this.journeyFormArr.invalid)return;const{adultCount:a,childCount:i,infantCount:s,isDirectFlight:D,type:f,promotionGroupFilters:N}=this.dataSearch,w=null===(n=this.cabinList.find(h=>h.actived))||void 0===n?void 0:n.value,E=null===(e=this.paxTypeList.find(h=>h.actived))||void 0===e?void 0:e.value,P=this.airlineFilters.filter(h=>h.actived).map(h=>h.value).join(","),Y=this._helperSvc.progressJourneyFormArr(this.journeyFormArr.value,f,{cabin:w,paxType:E,airline:P}),R=m(this._helperSvc.compactInputData({adult:a,child:i,infant:s,isDirectFlight:D,promotion:[],promotionGroupFilters:N,type:f+"",journey:Y,agentPromotion:null}));window.open(window.location.href.replace("search","result-search")+"?"+R)}}return c.\u0275fac=function(n){return new(n||c)(t.Y36(o.KNP),t.Y36(j.J),t.Y36(O.qu),t.Y36(I._),t.Y36(J.Xj))},c.\u0275cmp=t.Xpm({type:c,selectors:[["btc-search"]],viewQuery:function(n,e){if(1&n&&(t.Gf(B,5),t.Gf(Z,5)),2&n){let a;t.iGM(a=t.CRH())&&(e.containerEl=a.first),t.iGM(a=t.CRH())&&(e.searchInputCpn=a.first)}},standalone:!0,features:[t.jDz],decls:31,vars:23,consts:[[1,"w-full","bg-transparent"],["containerEl",""],[1,"bg-neutral-white","p-6","rounded-lg","w-full","shadow-cf-md","md:p-4","max-w-[1440px]","mx-auto","pointer-events-auto"],[1,"flex","items-center","justify-between","mb-5"],[1,"md:w-full"],[3,"flightType","typeSearchChange"],[1,"flex","items-center","justify-end","gap-x-4","md:hidden"],[3,"adultNumber","childNumber","infantNumber","numberOfPassengerChange"],[3,"airlineList","airlineFilterChange"],[3,"isShowTooltipFirstTime","promotionGroupList"],[3,"cabinList","actived","cabinChange"],[3,"paxTypeList","actived","paxTypeChange"],[1,"mb-[20px]","md:mb-4"],[3,"formArray","type","removeRoute","dataChange","dateTypeChange"],["searchInputCpn",""],[1,"gap-2","hidden","md:flex","overflow-x-auto","md:flex-wrap","items-center"],[1,"h-0","border-b","border-b-neutral-gray-2","my-4","hidden","md:block"],[1,"flex","justify-between","items-center","md:flex-col","md:items-start","md:gap-y-4"],[1,"flex","justify-start","gap-x-[34px]"],[1,"flex","items-center","gap-3","whitespace-nowrap"],["size","medium",3,"checkChange"],[1,"flex","justify-end","gap-x-2","w-full"],["cf-button","","size","medium","color","primary-1","type","solid",1,"md:justify-center",3,"click"],["icon","search","size","small",1,"mr-2.5"]],template:function(n,e){1&n&&(t.TgZ(0,"div",0,1)(2,"div",2)(3,"div",3)(4,"div",4)(5,"btc-type-search",5),t.NdJ("typeSearchChange",function(i){return e.flightTypeChange(i)}),t.qZA()(),t.TgZ(6,"div",6)(7,"btc-num-of-pas",7),t.NdJ("numberOfPassengerChange",function(i){return e.numberOfPassengerChange(i)}),t.qZA(),t.TgZ(8,"btc-airline-filter",8),t.NdJ("airlineFilterChange",function(i){return e.airlineFilterChange(i)}),t.qZA(),t._UZ(9,"btc-voucher-selector",9),t.TgZ(10,"btc-cabin-selector",10),t.NdJ("cabinChange",function(i){return e.cabinChange(i)}),t.qZA(),t.TgZ(11,"btc-pax-type-selector",11),t.NdJ("paxTypeChange",function(i){return e.paxTypeChange(i)}),t.qZA()()(),t.TgZ(12,"div",12)(13,"btc-search-input",13,14),t.NdJ("removeRoute",function(i){return e.removeRoute(i)})("dataChange",function(){return e.searchInputChange()})("dateTypeChange",function(i){return e.onDateTypeChange(i)}),t.qZA()(),t.TgZ(15,"div",15)(16,"btc-num-of-pas",7),t.NdJ("numberOfPassengerChange",function(i){return e.numberOfPassengerChange(i)}),t.qZA(),t.TgZ(17,"btc-airline-filter",8),t.NdJ("airlineFilterChange",function(i){return e.airlineFilterChange(i)}),t.qZA(),t._UZ(18,"btc-voucher-selector",9),t.TgZ(19,"btc-cabin-selector",10),t.NdJ("cabinChange",function(i){return e.cabinChange(i)}),t.qZA(),t.TgZ(20,"btc-pax-type-selector",11),t.NdJ("paxTypeChange",function(i){return e.paxTypeChange(i)}),t.qZA()(),t._UZ(21,"div",16),t.TgZ(22,"div",17)(23,"div",18)(24,"div",19)(25,"cf-checkbox",20),t.NdJ("checkChange",function(i){return e.onCheckDirectFlight(i)}),t._uU(26," Ch\u1ec9 c\xe1c chuy\u1ebfn bay th\u1eb3ng "),t.qZA()()(),t.TgZ(27,"div",21)(28,"button",22),t.NdJ("click",function(){return e.searchFlight()}),t._UZ(29,"cf-icon",23),t._uU(30," T\xecm chuy\u1ebfn bay "),t.qZA()()()()()),2&n&&(t.xp6(5),t.Q6J("flightType",e.dataSearch.type),t.xp6(2),t.Q6J("adultNumber",e.dataSearch.adultCount)("childNumber",e.dataSearch.childCount)("infantNumber",e.dataSearch.infantCount),t.xp6(1),t.Q6J("airlineList",e.airlineFilters),t.xp6(1),t.Q6J("isShowTooltipFirstTime",!0)("promotionGroupList",e.dataSearch.promotionGroupFilters),t.xp6(1),t.Q6J("cabinList",e.cabinList)("actived",e.isAirLineInternational),t.xp6(1),t.Q6J("paxTypeList",e.paxTypeList)("actived",e.isAirLineInternational),t.xp6(2),t.Q6J("formArray",e.journeyFormArr)("type",e.dataSearch.type||0),t.xp6(3),t.Q6J("adultNumber",e.dataSearch.adultCount)("childNumber",e.dataSearch.childCount)("infantNumber",e.dataSearch.infantCount),t.xp6(1),t.Q6J("airlineList",e.airlineFilters),t.xp6(1),t.Q6J("isShowTooltipFirstTime",!1)("promotionGroupList",e.dataSearch.promotionGroupFilters),t.xp6(1),t.Q6J("cabinList",e.cabinList)("actived",e.isAirLineInternational),t.xp6(1),t.Q6J("paxTypeList",e.paxTypeList)("actived",e.isAirLineInternational))},dependencies:[y.ez,v.x,_.w,T.l,S.d,F._,A.T,L.W,b.u,d.N8,d.Xq,o.AxE,o.Sm8],styles:[":host{display:block}\n"],encapsulation:2,changeDetection:0}),c})()}}]);